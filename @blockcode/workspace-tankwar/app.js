var d8=Object.defineProperty;var P8=(f,m)=>{for(var y in m)d8(f,y,{get:m[y],enumerable:!0,configurable:!0,set:(E)=>m[y]=()=>E})};var z6=((f)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(f,{get:(m,y)=>(typeof require!=="undefined"?require:m)[y]}):f)(function(f){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+f+'" is not supported')});import{Text as r5} from"@blockcode/ui";import{Text as B4} from"@blockcode/ui";import{Keys as C6,useLayout as L8,useEditor as k8} from"@blockcode/core";import{Text as A6,MenuSection as u5,MenuItem as Q6} from"@blockcode/ui";import{ScratchBlocks as c8} from"@blockcode/blocks-editor";import{jsx as n6,Fragment as E8} from"preact/jsx-runtime";var N8=function({itemClassName:f,onNew:m,onSave:y,children:E}){const{createPrompt:V,setStoreLibrary:T}=L8(),{modified:F,saveNow:L}=k8();return n6(E8,{children:[n6(u5,{children:[n6(Q6,{className:f,label:n6(A6,{id:"blocks.menu.file.newProject",defaultMessage:"New"}),hotkey:[L4?C6.COMMAND:C6.CONTROL,C6.N],onClick:()=>{if(F)V({title:n6(A6,{id:"gui.projects.notSaved",defaultMessage:"Not saved"}),label:n6(A6,{id:"gui.projects.replaceProject",defaultMessage:"Replace contents of the current project?"}),onSubmit:m});else m()}}),n6(Q6,{className:f,label:n6(A6,{id:"blocks.menu.file.openProject",defaultMessage:"Open"}),hotkey:[L4?C6.COMMAND:C6.CONTROL,C6.O],onClick:()=>T(!0)}),n6(Q6,{className:f,label:n6(A6,{id:"blocks.menu.file.saveProject",defaultMessage:"Save"}),hotkey:[L4?C6.COMMAND:C6.CONTROL,C6.S],onClick:async()=>{let Y,H;const w0=c8.getMainWorkspace();if(w0)Y=await B8.svgAsDataUri(w0.getCanvas(),{}),H=Array.from(new Set(Object.values(w0.blockDB_).filter((y0)=>["nes","translate","color-sensor","servo","time","pen","brain","request","text","broadcast"].find(($)=>$===y0.category_)).map((y0)=>y0.category_)));const g0=await L((y0)=>{const $={thumb:Y,...y0,...y?y():{},editor:{...y0.editor,extensions:H}};return $.fileList=$.fileList.map((r0)=>({...r0,script:void 0,content:void 0})),$})}})]}),n6(u5,{children:[n6(Q6,{disabled:!0,className:f,label:n6(A6,{id:"blocks.menu.file.uploadProject",defaultMessage:"Load from your computer"})}),n6(Q6,{disabled:!0,className:f,label:n6(A6,{id:"blocks.menu.file.downloadProject",defaultMessage:"save to your computer"})})]}),E]})};import{useEffect as V8,useState as k4} from"preact/hooks";import{Keys as c6} from"@blockcode/core";import{Text as h5,MenuSection as M8,MenuItem as v5} from"@blockcode/ui";import{ScratchBlocks as O8} from"@blockcode/blocks-editor";import{jsx as W6,Fragment as R8} from"preact/jsx-runtime";var a8=function({itemClassName:f,children:m}){const[y,E]=k4(!0),[V,T]=k4(!0),[F,L]=k4(null),Y=O8.getMainWorkspace();if(Y){if(F?.id!==Y.id)L(Y)}return V8(()=>{if(F)F.addChangeListener(()=>{E(F.undoStack_.length===0),T(F.redoStack_.length===0)}),E(F.undoStack_.length===0),T(F.redoStack_.length===0)},[F]),W6(R8,{children:[W6(M8,{children:[W6(v5,{disabled:y,className:f,label:W6(h5,{id:"blocks.menu.edit.undo",defaultMessage:"Undo"}),hotkey:[f5?c6.COMMAND:c6.CONTROL,c6.Z],onClick:async(H)=>{if(H instanceof MouseEvent&&F)F.undo(!1)}}),W6(v5,{disabled:V,className:f,label:W6(h5,{id:"blocks.menu.edit.redo",defaultMessage:"Redo"}),hotkey:f5?[c6.SHIFT,c6.COMMAND,c6.Z]:[c6.CONTROL,c6.Y],onClick:async(H)=>{if(H instanceof MouseEvent&&F)F.undo(!0)}})]}),m]})};import{useState as z8} from"preact/hooks";import{useLocale as A8,useLayout as q8,useEditor as F8} from"@blockcode/core";import{Text as q6,Spinner as e8,MenuSection as X8,MenuItem as n5} from"@blockcode/ui";import{Serial as r8,sleep as o4} from"@blockcode/core";var S8=function(f,m){const y=`data:${f};base64,${m}`;return fetch(y).then((E)=>E.arrayBuffer())},Y4=function(f){return f.replaceAll("\r\n","\n")},U4=function(f){return f.slice(2,-3)},b8="\x01",Z4="\x02",C4="\x03",I4="\x04",D4=128;class J4{constructor(){this.serial=null,this._connected=!1,this._encoder=new TextEncoder,this._decoder=new TextDecoder}requestPort(f=[]){return navigator.serial.requestPort({filters:f}).then((m)=>{if(m._serial){this.serial=m._serial,this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1);return}this.serial=new r8(m),this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1)})}connect(f={}){return new Promise((m,y)=>{if(this.serial)this.serial.open({baudRate:115200,...f}).then(()=>m()).catch((E)=>{if(E.name==="InvalidStateError")this._connected=!0,m();y(E)});else y(new Error("No device specified"))})}get connected(){return this._connected}disconnect(){return this.serial.close()}get deviceInfo(){return this.serial.getInfo()}readUntil(f,m){return new Promise((y)=>{let E="";const V=async(T)=>{if(T){if(E+=this._decoder.decode(T),m)m(T)}if(E.indexOf(f)!==-1)this.serial.off("data",V),y(E)};this.serial.on("data",V)})}writeAndReadUntil(f,m,y){return new Promise(async(E)=>{if(m)this.readUntil(m,y).then(E);for(let V=0;V<f.length;V+=D4)await this.serial.write(f.slice(V,V+D4)),await o4(10);if(!m)E()})}async getPrompt(){return await o4(150),await this.stop(),await o4(150),await this.writeAndReadUntil(`\r${C4}${Z4}`,"\r\n>>>")}async enterRawRepl(){return await this.writeAndReadUntil(b8,"raw REPL; CTRL-B to exit")}async exitRawRepl(){return await this.writeAndReadUntil(Z4,"\r\n>>>")}async execRaw(f,m){return await this.writeAndReadUntil(f),await this.writeAndReadUntil(I4,`${I4}>`,m)}async execFile(f,m){if(m=m||function(){},f){await this.enterRawRepl();const y=await this.execRaw(f,m);return await this.exitRawRepl(),y}return Promise.reject()}async run(f,m){return m=m||function(){},new Promise(async(y,E)=>{if(this.rejectRun)this.rejectRun(new Error("re-run")),this.rejectRun=null;this.rejectRun=E;try{await this.enterRawRepl();const V=await this.execRaw(f||"#",m);return await this.exitRawRepl(),y(V)}catch(V){E(V),this.rejectRun=null}})}async eval(f){await this.serial.write(f)}async stop(){if(this.rejectRun)this.rejectRun(new Error("pre stop")),this.rejectRun=null;await this.serial.write(C4)}async reset(){if(this.rejectRun)this.rejectRun(new Error("pre reset")),this.rejectRun=null;await this.serial.write(C4),await this.serial.write(I4)}async exists(f){f=f||"";let m="";m+="try:\n",m+=`  f = open('${f}', 'r')\n`,m+="  print(1)\n",m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const y=await this.execRaw(m);return await this.exitRawRepl(),y[2]=="1"}async listdir(f){f=f||"";let m="";m+="import os\n",m+="try:\n",m+=`  print(os.listdir('${f}'))\n`,m+="except OSError:\n",m+="  print([])\n",await this.enterRawRepl();let y=await this.execRaw(m);return await this.exitRawRepl(),y=U4(y),y=y.replace(/'/g,'"'),JSON.parse(y)}async mkdir(f){if(f){await this.enterRawRepl();const m=await this.execRaw(`import os\nos.mkdir('${f}')`);return await this.exitRawRepl(),m}return Promise.reject(new Error("Path to file was not specified"))}async rmdir(f){if(f){let m="";m+="import os\n",m+="try:\n",m+=`  os.rmdir("${f}")\n`,m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const y=await this.execRaw(m);return await this.exitRawRepl(),y}return Promise.reject(new Error("Path to file was not specified"))}async remove(f){if(f){let m="";m+="import os\n",m+="try:\n",m+=`  os.remove("${f}")\n`,m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const y=await this.execRaw(m);return this.exitRawRepl(),y}return Promise.reject(new Error("Path to file was not specified"))}async rename(f,m){if(f&&m){await this.enterRawRepl();const y=await this.execRaw(`import os\nos.rename('${f}', '${m}')`);return this.exitRawRepl(),y}return Promise.reject(new Error("Path to file was not specified"))}async cat(f){if(f){await this.enterRawRepl();let m=await this.execRaw(`with open('${f}','r') as f:\n while 1:\n  b=f.read(256)\n  if not b:break\n  print(b,end='')`);return await this.exitRawRepl(),m=U4(m),Y4(m)}return Promise.reject(new Error("Path to file was not specified"))}async checkHash(f,m){if(f){let y="";y+="import os\n",y+="import hashlib\n",y+="import binascii\n",y+="hash = hashlib.sha256()\n",y+=`with open('${f}', 'rb') as f:\n`,y+="  while True:\n",y+=`    c = f.read(${D4})\n`,y+="    if not c: break\n",y+="    hash.update(c)\n",y+="print(binascii.hexlify(hash.digest()).decode())\n",await this.enterRawRepl();let E=await this.execRaw(y);return await this.exitRawRepl(),E=E.slice(2,E.indexOf("\n")-1),m===E}return Promise.reject(new Error("Path to file was not specified"))}async put(f,m,y){if(!m){Promise.reject(new Error("Must specify content and destination path"));return}let E;if(typeof f==="string")E=this._encoder.encode(Y4(f));else if(f instanceof ArrayBuffer)E=new Uint8Array(f);else if(f instanceof Uint8Array)E=f;else Promise.reject(new Error(`${f} must string, Uint8Array or ArrayBuffer`));if(y=y||function(){},await this.exists(m)){const Y=await crypto.subtle.digest("SHA-256",E),H=Array.from(new Uint8Array(Y)).map((w0)=>w0.toString(16).padStart(2,"0")).join("");if(await this.checkHash(m,H)){y(100);return}}const V=Array.from(E).map((Y)=>Y.toString(16).padStart(2,"0"));let T="";T+=await this.enterRawRepl();let F=m.split("/");if(F.pop(),F.length>0){T+=await this.execRaw("import os");const Y=[];F.reduce((H,w0)=>{if(w0===""||H!==""&&H.at(-1)!=="/")H+="/";if(H+=w0,H!=="/")Y.push(H);return H},"");for(let H of Y)T+=await this.execRaw(`os.mkdir('${H}')`)}T+=await this.execRaw(`f=open('${m}','w')\nw=f.write`);const L=48;for(let Y=0;Y<V.length;Y+=L){let H=`w(bytes([${V.slice(Y,Y+L).map((w0)=>`0x${w0}`).join(",")}]))`;T+=await this.execRaw(H),y(parseInt(Y/V.length*100))}return T+=await this.execRaw("f.close()"),T+=await this.exitRawRepl(),y(100),T}}var G4=async(f,m)=>{const y=new J4;await y.requestPort(f),await y.connect(),await y.stop(),m(y);const E=()=>setTimeout(async()=>{if(y.connected)E();else m(null)},1000);return E(),y},Q4=async(f,m)=>{await f.disconnect(),m(null)},$4=async(f,m)=>{await f.stop(),await f.enterRawRepl(),await f.execRaw(`from ${m} import display`),await f.execRaw("display.fill(0x0000)"),await f.execRaw("cx, cy = display.width // 2, display.height // 2"),await f.execRaw("display.ellipse(cx, cy, 60, 60, 0xffff, True)"),await f.execRaw("display.ellipse(cx, cy, 50, 50, 0x0000, True)"),await f.execRaw("display.linex(cx, cy - 30, cx, cy + 30, 10, 0xffff)"),await f.execRaw("display.linex(cx, cy + 30, cx + 15, cy + 15, 10, 0xffff)"),await f.execRaw("display.linex(cx, cy + 30, cx - 15, cy + 15, 10, 0xffff)"),await f.execRaw("display.render()"),await f.exitRawRepl()},i5=async(f,m,y)=>{await f.stop();const E=m.length;let V=0;const T=(F)=>{y(((V+1/E*(F/100))*100).toFixed(1))};for(let F of m){let{id:L,content:Y}=F;if(F.type==="text/x-python")L+=".py";else if(F.type.startsWith("image/")&&!Y)Y=await S8(F.type,F.data);await f.put(Y||"",L,T),V+=1/E}y(100),await f.reset()};import{jsx as w6,Fragment as T8} from"preact/jsx-runtime";var W8=function({itemClassName:f,deviceName:m,deviceFilters:y,downloadScreen:E,onDownload:V,children:T}){const[F,L]=z8(!1),{maybeLocaleText:Y}=A8(),{createAlert:H,removeAlert:w0}=q8(),{fileList:g0,assetList:y0,device:$,setDevice:r0}=F8(),O=()=>L(!1),c0=()=>L(!0),t0=(X0)=>{if(!t0.id)t0.id=`download.${Date.now()}`,c0();if(X0<100)H({id:t0.id,icon:w6(e8,{level:"success"}),message:w6(q6,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:X0})});else H({id:t0.id,icon:null,message:w6(q6,{id:"blocks.alert.downloadCompleted",defaultMessage:"Download completed."})}),setTimeout(()=>{w0(t0.id),O(),delete t0.id},1000)};return w6(T8,{children:[w6(X8,{children:[w6(n5,{className:f,label:$?w6(q6,{id:"blocks.menu.device.disconnect",defaultMessage:"Disconnect this {name}",name:Y(m||w6(q6,{id:"blocks.menu.device.name",defaultMessage:"device"}))}):w6(q6,{id:"blocks.menu.device.connect",defaultMessage:"Connect your {name}",name:Y(m||w6(q6,{id:"blocks.menu.device.name",defaultMessage:"device"}))}),onClick:async()=>{if($){if(await Q4($,r0),t0.id)w0(t0.id),delete t0.id}else try{await G4(y||m5,r0)}catch(X0){}}}),w6(n5,{disabled:F,className:f,label:w6(q6,{id:"blocks.menu.device.download",defaultMessage:"Download program"}),onClick:async()=>{if(t0.id)return;try{const X0=$||await G4(y||m5,r0);if(E)await $4(X0,E);i5(X0,V?await V(g0,y0):[].concat(y0),t0)}catch(X0){}}})]}),T]})};import{jsx as K6} from"preact/jsx-runtime";var b5=function({deviceName:f,deviceFilters:m,createDefaultProject:y,saveCurrentProject:E,downloadProjectToDevice:V,showDownloadScreen:T}){return[{icon:K8,label:K6(B4,{id:"blocks.menu.file",defaultMessage:"File"}),Menu:({itemClassName:F,children:L})=>K6(N8,{itemClassName:F,onNew:y,onSave:E,children:L})},{icon:H8,label:K6(B4,{id:"blocks.menu.edit",defaultMessage:"Edit"}),Menu:({itemClassName:F,children:L})=>K6(a8,{itemClassName:F,children:L})},{icon:Y8,label:K6(B4,{id:"blocks.menu.device",defaultMessage:"Device"}),Menu:({itemClassName:F,children:L})=>K6(W8,{deviceName:f,itemClassName:F,deviceFilters:m,downloadScreen:T,onDownload:V,children:L})}]};import{ScratchBlocks as g6} from"@blockcode/blocks-editor";import{ScratchBlocks as q0} from"@blockcode/blocks-editor";import{ScratchBlocks as S5} from"@blockcode/blocks-editor";import{useEffect as Z8,useState as p4} from"preact/hooks";import{useLocale as J8,useLayout as Q8,useEditor as x5} from"@blockcode/core";import{classNames as $8} from"@blockcode/ui";import{BlocksEditor as i3,ScratchBlocks as m6,makeToolboxXML as t3} from"@blockcode/blocks-editor";import{ScratchBlocks as s5,blockSeparator as u3} from"@blockcode/blocks-editor";var m3=function(f,m,y,E){const{id:V}=f,T=y(f.name);let F=`<category name="${E6(T)}" id="${E6(V)}"`;if(F+=` colour="${E6(f.themeColor||p5)}"`,F+=` secondaryColour="${E6(f.inputColor||g5)}"`,f.connectionConfig)F+=' showStatusButton="true"';if(f.iconURI)F+=` iconURI="${E6(f.iconURI)}"`;return F+=">",f.blocks.forEach((L)=>{if(L==="---"){F+=`${u3}`;return}if(L.button){F+=`<button text="${y(L.text)}" callbackKey="${L.button}"></button>`;const y0=s5.getMainWorkspace();if(y0){const $=y0.getFlyout();if($){const r0=$.getWorkspace();if(r0)r0.registerButtonCallback(L.button,E(L.onClick))}}return}if(m&&L.useStage===!1)return;if(!m&&L.useSprite===!1)return;const Y=`${V}_${L.id.toLowerCase()}`,H={message0:y(L.text),category:V,outputShape:f3,colour:f.themeColor||p5,colourSecondary:f.inputColor||g5,colourTertiary:f.otherColor||n3};let w0=1;if(f.iconURI)H.message0=`%1 %2 ${H.message0}`,H.args0=[{type:"field_image",src:f.iconURI,width:40,height:40},{type:"field_vertical_separator"}],H.extensions=["scratch_extension"],w0+=2;if(L.hat)H.nextStatement=null;else if(L.output){if(L.output==="boolean")H.output="Boolean",H.outputShape=h3;else H.output="String",H.outputShape=v3;H.checkboxInFlyout=L.monitoring!==!1}else H.previousStatement=null,H.nextStatement=null;let g0=`<block type="${E6(Y)}">`;if(L.inputs)H.checkboxInFlyout=!1,H.args0=[].concat(H.args0||[],Object.entries(L.inputs).map(([y0,$])=>{const r0={name:y0,type:"input_value"};if($.menu)r0.type="field_dropdown",r0.options=$.menu.map(([O,c0])=>[y(O),c0]);else if($.type==="boolean")r0.check="Boolean";else{if(g0+=`<value name="${E6(y0)}">`,y5[$.type]){if(g0+=`<shadow type="${y5[$.type]}">`,$.default&&w5[$.type])g0+=`<field name="${w5[$.type]}">${E6(y($.default))}</field>`;g0+="</shadow>"}g0+="</value>"}return H.message0=H.message0.replace(`[${y0}]`,`%${w0++}`),r0}));if(s5.Blocks[Y]={init(){this.jsonInit(H)}},L.python)I[Y]=L.python.bind(I);else I[Y]=()=>"";g0+="</block>",F+=g0}),F+="</category>",F};import{useRef as x3,useEffect as s3,useState as l5} from"preact/hooks";import{classNames as p3,Text as H6,Button as d5,Modal as g3,BufferedInput as y3} from"@blockcode/ui";var _5=function(f){const m=globalThis.document,y=m.createElement("style");y.appendChild(m.createTextNode(f)),m.head.append(y)};import{jsx as U0} from"preact/jsx-runtime";var w3=function({title:f,label:m,defaultValue:y,enableLocalVariable:E,showListMessage:V,showVariableOptions:T,showCloudOption:F,onClose:L,onSubmit:Y}){const H=x3(null),[w0,g0]=l5(y),[y0,$]=l5({scope:"global",isCloud:!1}),r0=()=>{Y(w0,y0)},O=(c0)=>{if(c0.key==="Escape")L();if(c0.key==="Enter")Y(H.current.base.value,y0)};return s3(()=>{if(H.current)H.current.base.focus(),window.addEventListener("keydown",O);return()=>{window.removeEventListener("keydown",O)}},[H]),U0(g3,{title:f,className:_6.promptModal,onClose:L,children:U0("div",{className:_6.promptContent,children:[U0("div",{className:_6.label,children:m}),U0(y3,{autoFocus:!0,forceFocus:!0,ref:H,className:_6.variableNameTextInput,defaultValue:w0,onSubmit:g0}),T&&U0("div",{children:E?U0("div",{className:_6.options,children:[U0("label",{children:[U0("input",{checked:y0.scope==="global",name:"variableScopeOption",type:"radio",value:"global",onChange:()=>$({...y0,scope:"global"})}),U0(H6,{id:"blocks.dataPrompt.forAllTargets",defaultMessage:"For all targets"})]}),U0("label",{children:[U0("input",{checked:y0.scope==="local",name:"variableScopeOption",type:"radio",value:"local",onChange:()=>$({...y0,scope:"local"})}),U0(H6,{id:"blocks.dataPrompt.forThisTarget",defaultMessage:"For this target only"})]})]}):U0("div",{className:_6.infoMessage,children:V?U0(H6,{id:"blocks.dataPrompt.listAvailableToAllTargets",defaultMessage:"This list will be available to all targets."}):U0(H6,{id:"blocks.dataPrompt.availableToAllTargets",defaultMessage:"This variable will be available to all targets."})})}),U0("div",{className:_6.buttonRow,children:[U0(d5,{className:_6.button,onClick:L,children:U0(H6,{id:"blocks.dataPrompt.cancel",defaultMessage:"Cancel"})}),U0(d5,{className:p3(_6.button,_6.okButton),onClick:r0,children:U0(H6,{id:"blocks.dataPrompt.ok",defaultMessage:"OK"})})]})]})})};import{useEffect as l3,useState as P5} from"preact/hooks";import{useLocale as d3,useLayout as P3,useEditor as r3} from"@blockcode/core";import{Library as b3} from"@blockcode/ui";import{jsx as _3} from"preact/jsx-runtime";var o3=function({deviceId:f,onSelect:m,onClose:y,onFilter:E}){const[V,T]=P5([]),[F,L]=P5(!1),{language:Y,getText:H}=d3(),{createAlert:w0,removeAlert:g0}=P3(),{addAsset:y0}=r3(),$=(r0)=>{const O=r0.tags||[];let c0=["blocks",["dupont","data"],["3v3","5v"]];if(E)c0=E(O);if(Array.isArray(c0))return c0.every((t0)=>{if(Array.isArray(t0))return t0.some((X0)=>O.includes(X0));return O.includes(t0)});return c0};return l3(()=>{j3.then((r0)=>{T(r0.filter($).map((O)=>Object.assign({...O,featured:!0,disabled:O.disabled||O.preview,onSelect:async()=>{w0("importing",{id:O.id});let{default:c0}=await import(`@blockcode/extension-${O.id}/blocks`);if(typeof c0==="function")c0=c0(f);if(c0.id=O.id,c0.files)c0.files.forEach(async(t0)=>{const X0=`extensions/${O.id.replace(/[^a-z\d]/gi,"_")}/${t0.name}`,m0=await fetch(t0.uri).then((G6)=>G6.text());y0({...t0,id:X0,content:m0})});m(c0),g0(O.id),y()}},O.translations&&O.translations[Y]?{name:O.translations[Y].name||O.name,description:O.translations[Y].description||O.description,collaborator:O.translations[Y].collaborator||O.collaborator}:{}))),L(!1)})},[]),_3(b3,{filterable:!0,loading:F,items:V,filterPlaceholder:H("gui.library.search","Search"),title:H("blocks.extensions.addExtension","Add Extension"),emptyText:H("blocks.extensions.empty","No extension!"),onClose:y})};import{jsx as N6,Fragment as I3} from"preact/jsx-runtime";var G3=function({toolbox:f,messages:m,enableMultiTargets:y,enableLocalVariable:E,disableGenerator:V,disableExtension:T,deviceId:F,onChange:L,onExtensionsFilter:Y,onLoadExtension:H}){const{addLocaleData:w0,getText:g0,maybeLocaleText:y0}=J8(),{splash:$,createPrompt:r0,createAlert:O,removeAlert:c0,setSplash:t0}=Q8(),{editor:X0,fileList:m0,selectedIndex:G6,openFile:B0,modifyFile:Y0,modifyAsset:r6,setModified:l0}=x5(),[J0,b6]=p4(),[f0,i0]=p4(!1),[u0,Z]=p4(!1),[n0,J]=p4(!1);if($){if($===!0&&n0===!1)j6.clear(),J(setTimeout(()=>{J(D3(F,X0.extensions,w0,r6,H).then(()=>J(!0)))},100));if(n0===!0){let U=!0;if(m0.length>1){for(let o0=0;o0>-m0.length;o0--)if(!m0.at(o0).content){U=!1,setTimeout(()=>{B0((o0+m0.length)%m0.length)},100);break}}if(U)setTimeout(()=>{t0(!1),l0(!1)},100)}}m={EVENT_WHENPROGRAMSTART:g0("blocks.event.programStart","when program start"),CONTROL_STOP_OTHER:g0("blocks.control.stopOther","other scripts"),...m||[]},Z8(()=>{m6.prompt=(U,o0,O0,z0,N0)=>{const V0={callback:O0,message:U,defaultValue:o0};V0.title=z0?z0:m6.Msg.VARIABLE_MODAL_TITLE,V0.varType=typeof N0==="string"?N0:m6.SCALAR_VARIABLE_TYPE,V0.showVariableOptions=y&&N0!==m6.BROADCAST_MESSAGE_VARIABLE_TYPE&&V0.title!==m6.Msg.RENAME_VARIABLE_MODAL_TITLE&&V0.title!==m6.Msg.RENAME_LIST_MODAL_TITLE,V0.showCloudOption=N0===m6.SCALAR_VARIABLE_TYPE&&this.props.canUseCloud,i0(V0)},m6.FlyoutExtensionCategoryHeader.getExtensionState=(U)=>{if(j6.has(U)){const o0=j6.get(U);if(o0.connectionConfig?.items.every((O0)=>localStorage.getItem(`${o0.id}.connection.${O0.id}`)))return m6.StatusButtonState.READY}return m6.StatusButtonState.NOT_READY},m6.statusButtonCallback=(U)=>{if(!j6.has(U))return;const o0=j6.get(U),{connectionConfig:O0}=o0;if(!O0)return;r0({title:o0.name,label:O0.title,inputMode:O0.items.map((z0)=>({name:z0.id,placeholder:z0.text,defaultValue:localStorage.getItem(`${o0.id}.connection.${z0.id}`)})),content:O0.description,onSubmit:(z0)=>{if(Object.entries(z0).forEach(([N0,V0])=>{localStorage.setItem(`${o0.id}.connection.${N0}`,`${V0}`)}),J0)m6.refreshStatusButtons(J0)}})}},[J0]);let I0;if(J0)I0=J0.getAllVariables().filter((U)=>{if(U.isLocal)return!1;if(U.type===m6.BROADCAST_MESSAGE_VARIABLE_TYPE){if(U.name===m6.Msg.DEFAULT_BROADCAST_MESSAGE_NAME)return!1;const o0=U.id_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),O0=new RegExp(`<field name="BROADCAST_OPTION" id="${o0}"[^>]+>[^<]+</field>`,"g");for(let z0 of m0)if(O0.test(z0.xml))return!0;return!1}return!0});let W=f||t3();const e0=G6===0,i6=(U)=>U.bind(null,{context:x5(),createPrompt:r0,createAlert:O,removeAlert:c0});j6.forEach((U)=>{W+=m3(U,e0,y0,i6)});const d0=(U,o0)=>{let O0;if(!V)O0=I.workspaceToCode(o0);if(Y0({xml:U,content:O0}),L)L(U,o0)},T0=(U,o0)=>{f0.callback(U,[],o0),i0(!1)},f6=()=>i0(!1),W0=()=>Z(!0),t6=()=>Z(!1),K0=(U)=>{if(!j6.has(U.id)){if(w0(U.translations),H)H({...U,blocks:U.blocks.filter(j5)});j6.set(U.id,U)}setTimeout(()=>{J0.toolbox_.setSelectedCategoryById(U.id)},100)};return N6(I3,{children:[N6("div",{className:c4.editorWrapper,children:[N6(i3,{toolbox:W,messages:m,globalVariables:I0,onWorkspaceCreated:b6,onChange:G6!==-1?d0:null}),T?null:N6("div",{className:$8("scratchCategoryMenu",c4.extensionButton),children:N6("button",{className:c4.addButton,title:g0("blocks.extensions.addExtension","Add Extension"),onClick:W0,children:N6("img",{src:C3,title:"Add Extension"})})}),f0&&N6(w3,{title:f0.title,label:f0.message,defaultValue:f0.defaultValue,enableLocalVariable:E,showListMessage:f0.varType===m6.LIST_VARIABLE_TYPE,showVariableOptions:f0.showVariableOptions,showCloudOption:f0.showCloudOption,onClose:f6,onSubmit:T0}),u0&&N6(o3,{deviceId:F,onFilter:Y,onSelect:K0,onClose:t6})]}),!1]})};import{jsx as o5} from"preact/jsx-runtime";var _8=Object.create,{defineProperty:t5,getPrototypeOf:j8,getOwnPropertyNames:o8}=Object,C8=Object.prototype.hasOwnProperty,I8=(f,m,y)=>{y=f!=null?_8(j8(f)):{};const E=m||!f||!f.__esModule?t5(y,"default",{value:f,enumerable:!0}):y;for(let V of o8(f))if(!C8.call(E,V))t5(E,V,{get:()=>f[V],enumerable:!0});return E},D8=(f,m)=>()=>(m||f((m={exports:{}}).exports,m),m.exports),G8=D8((f)=>{(function(){var m=typeof f!="undefined"&&f||typeof define!="undefined"&&{}||this||window;if(typeof define!=="undefined")define("save-svg-as-png",[],function(){return m});m.default=m;var y="http://www.w3.org/2000/xmlns/",E="http://www.w3.org/1999/xhtml",V="http://www.w3.org/2000/svg",T='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>',F=/url\(["']?(.+?)["']?\)/,L={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},Y=function f0(i0){return i0 instanceof HTMLElement||i0 instanceof SVGElement},H=function f0(i0){if(!Y(i0))throw new Error("an HTMLElement or SVGElement is required; got "+i0)},w0=function f0(i0){return new Promise(function(u0,Z){if(Y(i0))u0(i0);else Z(new Error("an HTMLElement or SVGElement is required; got "+i0))})},g0=function f0(i0){return i0&&i0.lastIndexOf("http",0)===0&&i0.lastIndexOf(window.location.host)===-1},y0=function f0(i0){var u0=Object.keys(L).filter(function(Z){return i0.indexOf("."+Z)>0}).map(function(Z){return L[Z]});if(u0)return u0[0];return console.error("Unknown font format for "+i0+". Fonts may not be working correctly."),"application/octet-stream"},$=function f0(i0){var u0="",Z=new Uint8Array(i0);for(var n0=0;n0<Z.byteLength;n0++)u0+=String.fromCharCode(Z[n0]);return window.btoa(u0)},r0=function f0(i0,u0,Z){var n0=i0.viewBox&&i0.viewBox.baseVal&&i0.viewBox.baseVal[Z]||u0.getAttribute(Z)!==null&&!u0.getAttribute(Z).match(/%$/)&&parseInt(u0.getAttribute(Z))||i0.getBoundingClientRect()[Z]||parseInt(u0.style[Z])||parseInt(window.getComputedStyle(i0).getPropertyValue(Z));return typeof n0==="undefined"||n0===null||isNaN(parseFloat(n0))?0:n0},O=function f0(i0,u0,Z,n0){if(i0.tagName==="svg")return{width:Z||r0(i0,u0,"width"),height:n0||r0(i0,u0,"height")};else if(i0.getBBox){var J=i0.getBBox(),I0=J.x,W=J.y,e0=J.width,i6=J.height;return{width:I0+e0,height:W+i6}}},c0=function f0(i0){return decodeURIComponent(encodeURIComponent(i0).replace(/%([0-9A-F]{2})/g,function(u0,Z){var n0=String.fromCharCode("0x"+Z);return n0==="%"?"%25":n0}))},t0=function f0(i0){var u0=window.atob(i0.split(",")[1]),Z=i0.split(",")[0].split(":")[1].split(";")[0],n0=new ArrayBuffer(u0.length),J=new Uint8Array(n0);for(var I0=0;I0<u0.length;I0++)J[I0]=u0.charCodeAt(I0);return new Blob([n0],{type:Z})},X0=function f0(i0,u0){if(!u0)return;try{return i0.querySelector(u0)||i0.parentNode&&i0.parentNode.querySelector(u0)}catch(Z){console.warn('Invalid CSS selector "'+u0+'"',Z)}},m0=function f0(i0,u0){var Z=i0.cssText.match(F),n0=Z&&Z[1]||"";if(!n0||n0.match(/^data:/)||n0==="about:blank")return;var J=n0.startsWith("../")?u0+"/../"+n0:n0.startsWith("./")?u0+"/."+n0:n0;return{text:i0.cssText,format:y0(J),url:J}},G6=function f0(i0){return Promise.all(Array.from(i0.querySelectorAll("image")).map(function(u0){var Z=u0.getAttributeNS("http://www.w3.org/1999/xlink","href")||u0.getAttribute("href");if(!Z)return Promise.resolve(null);if(g0(Z))Z+=(Z.indexOf("?")===-1?"?":"&")+"t="+(new Date()).valueOf();return new Promise(function(n0,J){var I0=document.createElement("canvas"),W=new Image;W.crossOrigin="anonymous",W.src=Z,W.onerror=function(){return J(new Error("Could not load "+Z))},W.onload=function(){I0.width=W.width,I0.height=W.height,I0.getContext("2d").drawImage(W,0,0),u0.setAttributeNS("http://www.w3.org/1999/xlink","href",I0.toDataURL("image/png")),n0(!0)}})}))},B0={},Y0=function f0(i0){return Promise.all(i0.map(function(u0){return new Promise(function(Z,n0){if(B0[u0.url])return Z(B0[u0.url]);var J=new XMLHttpRequest;J.addEventListener("load",function(){var I0=$(J.response),W=u0.text.replace(F,'url("data:'+u0.format+";base64,"+I0+'")')+"\n";B0[u0.url]=W,Z(W)}),J.addEventListener("error",function(I0){console.warn("Failed to load font from: "+u0.url,I0),B0[u0.url]=null,Z(null)}),J.addEventListener("abort",function(I0){console.warn("Aborted loading font from: "+u0.url,I0),Z(null)}),J.open("GET",u0.url),J.responseType="arraybuffer",J.send()})})).then(function(u0){return u0.filter(function(Z){return Z}).join("")})},r6=null,l0=function f0(){if(r6)return r6;return r6=Array.from(document.styleSheets).map(function(i0){try{return{rules:i0.cssRules,href:i0.href}}catch(u0){return console.warn("Stylesheet could not be loaded: "+i0.href,u0),{}}})},J0=function f0(i0,u0){var Z=u0||{},n0=Z.selectorRemap,J=Z.modifyStyle,I0=Z.modifyCss,W=Z.fonts,e0=Z.excludeUnusedCss,i6=I0||function(W0,t6){var K0=n0?n0(W0):W0,U=J?J(t6):t6;return K0+"{"+U+"}\n"},d0=[],T0=typeof W==="undefined",f6=W||[];return l0().forEach(function(W0){var{rules:t6,href:K0}=W0;if(!t6)return;Array.from(t6).forEach(function(U){if(typeof U.style!="undefined"){if(X0(i0,U.selectorText))d0.push(i6(U.selectorText,U.style.cssText));else if(T0&&U.cssText.match(/^@font-face/)){var o0=m0(U,K0);if(o0)f6.push(o0)}else if(!e0)d0.push(U.cssText)}})}),Y0(f6).then(function(W0){return d0.join("\n")+W0})},b6=function f0(){if(!navigator.msSaveOrOpenBlob&&!("download"in document.createElement("a")))return{popup:window.open()}};m.prepareSvg=function(f0,i0,u0){H(f0);var Z=i0||{},n0=Z.left,J=n0===void 0?0:n0,I0=Z.top,W=I0===void 0?0:I0,e0=Z.width,i6=Z.height,d0=Z.scale,T0=d0===void 0?1:d0,f6=Z.responsive,W0=f6===void 0?!1:f6,t6=Z.excludeCss,K0=t6===void 0?!1:t6;return G6(f0).then(function(){var U=f0.cloneNode(!0);U.style.backgroundColor=(i0||{}).backgroundColor||f0.style.backgroundColor;var o0=O(f0,U,e0,i6),O0=o0.width,z0=o0.height;if(f0.tagName!=="svg")if(f0.getBBox){if(U.getAttribute("transform")!=null)U.setAttribute("transform",U.getAttribute("transform").replace(/translate\(.*?\)/,""));var N0=document.createElementNS("http://www.w3.org/2000/svg","svg");N0.appendChild(U),U=N0}else{console.error("Attempted to render non-SVG element",f0);return}if(U.setAttribute("version","1.1"),U.setAttribute("viewBox",[J,W,O0,z0].join(" ")),!U.getAttribute("xmlns"))U.setAttributeNS(y,"xmlns",V);if(!U.getAttribute("xmlns:xlink"))U.setAttributeNS(y,"xmlns:xlink","http://www.w3.org/1999/xlink");if(W0)U.removeAttribute("width"),U.removeAttribute("height"),U.setAttribute("preserveAspectRatio","xMinYMin meet");else U.setAttribute("width",O0*T0),U.setAttribute("height",z0*T0);if(Array.from(U.querySelectorAll("foreignObject > *")).forEach(function(T6){T6.setAttributeNS(y,"xmlns",T6.tagName==="svg"?V:E)}),K0){var V0=document.createElement("div");V0.appendChild(U);var A0=V0.innerHTML;if(typeof u0==="function")u0(A0,O0,z0);else return{src:A0,width:O0,height:z0}}else return J0(f0,i0).then(function(T6){var B6=document.createElement("style");B6.setAttribute("type","text/css"),B6.innerHTML="<![CDATA[\n"+T6+"\n]]>";var m4=document.createElement("defs");m4.appendChild(B6),U.insertBefore(m4,U.firstChild);var Z6=document.createElement("div");Z6.appendChild(U);var x4=Z6.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if(typeof u0==="function")u0(x4,O0,z0);else return{src:x4,width:O0,height:z0}})})},m.svgAsDataUri=function(f0,i0,u0){return H(f0),m.prepareSvg(f0,i0).then(function(Z){var{src:n0,width:J,height:I0}=Z,W="data:image/svg+xml;base64,"+window.btoa(c0(T+n0));if(typeof u0==="function")u0(W,J,I0);return W})},m.svgAsPngUri=function(f0,i0,u0){H(f0);var Z=i0||{},n0=Z.encoderType,J=n0===void 0?"image/png":n0,I0=Z.encoderOptions,W=I0===void 0?0.8:I0,e0=Z.canvg,i6=function d0(T0){var{src:f6,width:W0,height:t6}=T0,K0=document.createElement("canvas"),U=K0.getContext("2d"),o0=window.devicePixelRatio||1;if(K0.width=W0*o0,K0.height=t6*o0,K0.style.width=K0.width+"px",K0.style.height=K0.height+"px",U.setTransform(o0,0,0,o0,0,0),e0)e0(K0,f6);else U.drawImage(f6,0,0);var O0=void 0;try{O0=K0.toDataURL(J,W)}catch(z0){if(typeof SecurityError!=="undefined"&&z0 instanceof SecurityError||z0.name==="SecurityError"){console.error("Rendered SVG images cannot be downloaded in this browser.");return}else throw z0}if(typeof u0==="function")u0(O0,K0.width,K0.height);return Promise.resolve(O0)};if(e0)return m.prepareSvg(f0,i0).then(i6);else return m.svgAsDataUri(f0,i0).then(function(d0){return new Promise(function(T0,f6){var W0=new Image;W0.onload=function(){return T0(i6({src:W0,width:W0.width,height:W0.height}))},W0.onerror=function(){f6("There was an error loading the data URI as an image on the following SVG\n"+window.atob(d0.slice(26))+"Open the following link to see browser\'s diagnosis\n"+d0)},W0.src=d0})})},m.download=function(f0,i0,u0){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t0(i0),f0);else{var Z=document.createElement("a");if("download"in Z){Z.download=f0,Z.style.display="none",document.body.appendChild(Z);try{var n0=t0(i0),J=URL.createObjectURL(n0);Z.href=J,Z.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(J)})}}catch(I0){console.error(I0),console.warn("Error while getting object URL. Falling back to string URL."),Z.href=i0}Z.click(),document.body.removeChild(Z)}else if(u0&&u0.popup)u0.popup.document.title=f0,u0.popup.location.replace(i0)}},m.saveSvg=function(f0,i0,u0){var Z=b6();return w0(f0).then(function(n0){return m.svgAsDataUri(n0,u0||{})}).then(function(n0){return m.download(i0,n0,Z)})},m.saveSvgAsPng=function(f0,i0,u0){var Z=b6();return w0(f0).then(function(n0){return m.svgAsPngUri(n0,u0||{})}).then(function(n0){return m.download(i0,n0,Z)})}})()}),B8=I8(G8(),1),L4=/Mac/i.test(navigator.platform||navigator.userAgent),f5=/Mac/i.test(navigator.platform||navigator.userAgent),m5=[{usbVendorId:12346},{usbVendorId:11914}],K8="./assets/icon-file-1def53419f4ad0ae.svg",H8="./assets/icon-edit-2b1e47b495524ed2.svg",Y8="./assets/icon-device-c2fafab2eaccf043.svg";var I=new g6.Generator("Python");I.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip");I.ORDER_ATOMIC=0;I.ORDER_COLLECTION=1;I.ORDER_STRING_CONVERSION=1;I.ORDER_MEMBER=2.1;I.ORDER_FUNCTION_CALL=2.2;I.ORDER_EXPONENTIATION=3;I.ORDER_UNARY_SIGN=4;I.ORDER_BITWISE_NOT=4;I.ORDER_MULTIPLICATIVE=5;I.ORDER_ADDITIVE=6;I.ORDER_BITWISE_SHIFT=7;I.ORDER_BITWISE_AND=8;I.ORDER_BITWISE_XOR=9;I.ORDER_BITWISE_OR=10;I.ORDER_RELATIONAL=11;I.ORDER_LOGICAL_NOT=12;I.ORDER_LOGICAL_AND=13;I.ORDER_LOGICAL_OR=14;I.ORDER_CONDITIONAL=15;I.ORDER_LAMBDA=16;I.ORDER_NONE=99;I.ORDER_OVERRIDES=[[I.ORDER_FUNCTION_CALL,I.ORDER_MEMBER],[I.ORDER_FUNCTION_CALL,I.ORDER_FUNCTION_CALL],[I.ORDER_MEMBER,I.ORDER_MEMBER],[I.ORDER_MEMBER,I.ORDER_FUNCTION_CALL],[I.ORDER_LOGICAL_NOT,I.ORDER_LOGICAL_NOT],[I.ORDER_LOGICAL_AND,I.ORDER_LOGICAL_AND],[I.ORDER_LOGICAL_OR,I.ORDER_LOGICAL_OR]];I.init=(f)=>{if(I.PASS=I.INDENT+"pass\n",I.definitions_=Object.create(null),I.functionNames_=Object.create(null),!I.variableDB_)I.variableDB_=new g6.Names(I.RESERVED_WORDS_);else I.variableDB_.reset();I.variableDB_.setVariableMap(f.getVariableMap());const m=[],y=f.getAllVariables();for(let V=0;V<y.length;V++){if(y[V].type===g6.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;let T=I.variableDB_.getName(y[V].getId(),g6.Variables.NAME_TYPE),F="";if(y[V].type===g6.LIST_VARIABLE_TYPE)T=`${T}_${g6.LIST_VARIABLE_TYPE}`,F="[]";m.push(`${T} = ${F}`)}const E=g6.Variables.allDeveloperVariables(f);for(let V=0;V<E.length;V++){let T=I.variableDB_.getName(E[V],g6.Names.DEVELOPER_VARIABLE_TYPE),F="";if(y[V].type===g6.LIST_VARIABLE_TYPE)T=`${T}_${g6.LIST_VARIABLE_TYPE}`,F="[]";m.push(`${T} = ${F}`)}if(m.length)I.definitions_.variables=m.join("\n");I.definitions_.import_blocks="from blocks import *"};I.finish=(f)=>{const m=[],y=[];for(let E in I.definitions_){const V=I.definitions_[E];if(V.match(/^(from\s+\S+\s+)?import\s+\S+/))m.push(V);else y.push(V)}return delete I.definitions_,delete I.functionNames_,I.variableDB_.reset(),(m.join("\n")+"\n\n"+y.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+f};I.scrubNakedValue=(f)=>{return f+"\n"};I.quote_=(f)=>{f=f.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\%/g,"\\%");let m='"';if(f.indexOf('"')!==-1)if(f.indexOf("'")===-1)m="'";else f=f.replace(/"/g,'\\"');return m+f+m};I.scrub_=(f,m)=>{let y="";if(!f.outputConnection?.targetConnection){let E=f.getCommentText();if(E=g6.utils.wrap(E,I.COMMENT_WRAP-3),E)if(f.getProcedureDef)y+='"""'+E+'\n"""\n';else y+=I.prefixLines(E+"\n","# ");for(let V=0;V<f.inputList.length;V++)if(f.inputList[V].type==g6.INPUT_VALUE){const T=f.inputList[V].connection.targetBlock();if(T){const F=I.allNestedComments(T);if(F)y+=I.prefixLines(F,"# ")}}}if(f.startHat_){const E=f.nextConnection&&f.nextConnection.targetBlock();let V=I.blockToCode(E);if(V)V=I.prefixLines(V,I.INDENT),m=m.replace(`\n${I.PASS}`,`\n${V}`);return y+m}if(f.parentBlock_){const E=f.nextConnection&&f.nextConnection.targetBlock(),V=I.blockToCode(E);return y+m+V}};I.getAdjustedInt=(f,m,y,E)=>{let V=y||0;if(f.workspace.options.oneBasedIndex)V--;const T=f.workspace.options.oneBasedIndex?"1":"0",F=V?I.ORDER_ADDITIVE:I.ORDER_NONE;let L=I.valueToCode(f,m,F)||T;if(g6.isNumber(L)){if(L=parseInt(L,10)+V,E)L=-L}else{if(V>0)L="int("+L+" + "+V+")";else if(V<0)L="int("+L+" - "+-V+")";else L="int("+L+")";if(E)L="-"+L}return L};I.hatToCode=(f="",...m)=>{if(!I.functionNames_[f])I.functionNames_[f]=0;I.functionNames_[f]+=1;const y=`${f}_${I.functionNames_[f]}`;return I.HAT_FUNCTION_PLACEHOLDER=y,`async def ${y}(${m.join(", ")}):\n  this_func = ${y}\n${I.PASS}\n`};var U8=(f)=>{const m=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;f=f.replace(m,(E,V,T,F)=>V+V+T+T+F+F);const y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(f);return y?{r:parseInt(y[1],16),g:parseInt(y[2],16),b:parseInt(y[3],16)}:null};I.colour_picker=(f)=>{const{r:m,g:y,b:E}=U8(f.getFieldValue("COLOUR"));return[`(${m}, ${y}, ${E})`,I.ORDER_ATOMIC]};var $6="  await runtime.next_frame()\n";I.control_wait=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.valueToCode(f,"DURATION",I.ORDER_NONE)||0;return m+=`await runtime.wait_for(num(${y}))\n`,m};I.control_repeat=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);let y=I.statementToCode(f,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,f),I.INDENT)+y;const E=I.valueToCode(f,"TIMES",I.ORDER_NONE)||10;return m+=`for _ in range(num(${E})):\n${y}${$6}`,m};I.control_forever=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);let y=I.statementToCode(f,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,f),I.INDENT)+y;return m+=`while True:\n${y}${$6}`,m};I.control_if=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);let y=I.statementToCode(f,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,f),I.INDENT)+y;const E=I.valueToCode(f,"CONDITION",I.ORDER_NONE)||"False";if(m+=`if ${E}:\n${y}`,f.getInput("SUBSTACK2")){if(y=I.statementToCode(f,"SUBSTACK2")||I.PASS,I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,f),I.INDENT)+y;m+=`else:\n${y}`}return m};I.control_if_else=I.control_if;I.control_wait_until=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.valueToCode(f,"CONDITION",I.ORDER_NONE)||"False";return m+=`while not ${y}:\n${$6}`,m};I.control_repeat_until=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);let y=I.statementToCode(f,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,f),I.INDENT)+y;const E=I.valueToCode(f,"CONDITION",I.ORDER_NONE)||"False";return m+=`while not ${E}:\n${y}${$6}`,m};I.control_while=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);let y=I.statementToCode(f,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,f),I.INDENT)+y;const E=I.valueToCode(f,"CONDITION",I.ORDER_NONE)||"False";return m+=`while ${E}:\n${y}${$6}`,m};I.control_stop=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);switch(f.getFieldValue("STOP_OPTION")){case"all":m+="runtime.stop()\n";break;case"this script":m+="return\n";break;case"other scripts in sprite":m+="runtime.stop_tasks(this_func)\n";break}return m};I.data_variable=(f)=>{return[I.variableDB_.getName(f.getFieldValue("VARIABLE"),q0.Variables.NAME_TYPE),I.ORDER_ATOMIC]};I.data_setvariableto=(f)=>{let m="";if(javascriptGenerator.STATEMENT_PREFIX)m+=javascriptGenerator.injectId(javascriptGenerator.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("VARIABLE"),q0.Variables.NAME_TYPE),E=I.valueToCode(f,"VALUE",I.ORDER_NONE)||'""';return m+=`${y} = ${E}\n`,m};I.data_changevariableby=(f)=>{let m="";if(javascriptGenerator.STATEMENT_PREFIX)m+=javascriptGenerator.injectId(javascriptGenerator.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("VARIABLE"),q0.Variables.NAME_TYPE),E=I.valueToCode(f,"VALUE",I.ORDER_NONE)||0;return m+=`${y} = num(${y}) + num(${E})\n`,m};I.data_listcontents=(f)=>{return[I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,I.ORDER_ATOMIC]};I.data_addtolist=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,E=I.valueToCode(f,"ITEM",I.ORDER_NONE)||'""';return m+=`${y}.append(${E})\n`,m};I.data_deleteoflist=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,E=I.valueToCode(f,"INDEX",I.ORDER_NONE)||1;return m+=`${y}.remove(runtime.index(${E}, len(${y})))\n`,m};I.data_deletealloflist=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE;return m+=`${y} = []\n`,m};I.data_insertatlist=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,E=I.valueToCode(f,"INDEX",I.ORDER_NONE)||1,V=I.valueToCode(f,"ITEM",I.ORDER_NONE)||'""';return m+=`${y}.insert(runtime.index(${E}, len(${y})), ${V})\n`,m};I.data_replaceitemoflist=(f)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,f);const y=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,E=I.valueToCode(f,"INDEX",I.ORDER_NONE)||1,V=I.valueToCode(f,"ITEM",I.ORDER_NONE)||'""';return m+=`${y}[runtime.index(${E}, len(${y}))] = ${V}\n`,m};I.data_itemoflist=(f)=>{const m=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,y=I.valueToCode(f,"INDEX",I.ORDER_NONE)||1;return[`${m}[runtime.index(${y}, len(${m}))]`,I.ORDER_CONDITIONAL]};I.data_itemnumoflist=(f)=>{const m=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,y=I.valueToCode(f,"ITEM",I.ORDER_NONE)||0;return[`(${m}.index(${y}) + 1)`,I.ORDER_NONE]};I.data_lengthoflist=(f)=>{return[`len(${I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE})`,I.ORDER_FUNCTION_CALL]};I.data_listcontainsitem=(f)=>{const m=I.variableDB_.getName(f.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,y=I.valueToCode(f,"ITEM",I.ORDER_NONE)||0;return[`bool(${m}.count(${y}))`,I.ORDER_FUNCTION_CALL]};I.event_whenflagclicked=()=>{return`${I.hatToCode("start")}runtime.when_start(${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_whengreaterthan=(f)=>{const m=f.getFieldValue("WHENGREATERTHANMENU"),y=I.valueToCode(f,"VALUE",I.ORDER_NONE)||0;return`${I.hatToCode("greaterthen")}runtime.when_greaterthen("${m}", num(${y}), ${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_whenbroadcastreceived=(f)=>{const m=I.variableDB_.getName(f.getFieldValue("BROADCAST_OPTION"),S5.Variables.NAME_TYPE);return`${I.hatToCode("broadcastreceived")}runtime.when_broadcastreceived("${m}", ${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_broadcast_menu=(f)=>{return[I.variableDB_.getName(f.getFieldValue("BROADCAST_OPTION"),S5.Variables.NAME_TYPE),I.ORDER_ATOMIC]};I.event_broadcast=(f)=>{return`runtime.broadcast("${I.valueToCode(f,"BROADCAST_INPUT",I.ORDER_NONE)||'"message1"'}")\n`};I.event_broadcastandwait=(f)=>{return`await runtime.broadcast("${I.valueToCode(f,"BROADCAST_INPUT",I.ORDER_NONE)||'"message1"'}")\n`};I.addReservedWords("math,random,Number");I.math_number=(f)=>{let m=parseFloat(f.getFieldValue("NUM")),y;if(m===Infinity)m='float("inf")',y=I.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m='-float("inf")',y=I.ORDER_UNARY_SIGN;else if(Number.isNaN(m))m='float("nan")',y=I.ORDER_UNARY_SIGN;else y=m<0?I.ORDER_UNARY_SIGN:I.ORDER_ATOMIC;return[m,y]};I.math_integer=(f)=>{const m=parseInt(f.getFieldValue("NUM")),y=m<0?I.ORDER_UNARY_SIGN:I.ORDER_ATOMIC;return[m,y]};I.math_whole_number=(f)=>{return[Math.abs(parseInt(f.getFieldValue("NUM"))),I.ORDER_ATOMIC]};I.math_positive_number=(f)=>{let m=parseFloat(f.getFieldValue("NUM")),y;if(m===Infinity)m='float("inf")',y=I.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m='-float("inf")',y=I.ORDER_FUNCTION_CALL;else if(Number.isNaN(m))m='float("nan")',y=I.ORDER_FUNCTION_CALL;else m=m<0?0:m,y=I.ORDER_ATOMIC;return[m,y]};I.math_angle=(f)=>{let m=parseFloat(f.getFieldValue("NUM")),y;if(m==Infinity)m='float("inf")',y=I.ORDER_FUNCTION_CALL;else if(m==(-Infinity))m='-float("inf")',y=I.ORDER_UNARY_SIGN;else m=m%360,m=m<0?m+360:m,y=I.ORDER_ATOMIC;return[m,y]};I.operator_add=(f)=>{const m=I.valueToCode(f,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(f,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) + num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_subtract=(f)=>{const m=I.valueToCode(f,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(f,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) - num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_multiply=(f)=>{const m=I.valueToCode(f,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(f,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) * num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_divide=(f)=>{const m=I.valueToCode(f,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(f,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) / num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_random=(f)=>{const m=I.valueToCode(f,"FROM",I.ORDER_NONE)||0,y=I.valueToCode(f,"TO",I.ORDER_NONE)||0;return[`runtime.random(${m}, ${y})`,I.ORDER_FUNCTION_CALL]};I.operator_gt=(f)=>{const m=I.valueToCode(f,"OPERAND1",I.ORDER_NONE)||0,y=I.valueToCode(f,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) > num(${y}))`,I.ORDER_RELATIONAL]};I.operator_lt=(f)=>{const m=I.valueToCode(f,"OPERAND1",I.ORDER_NONE)||0,y=I.valueToCode(f,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) < num(${y}))`,I.ORDER_RELATIONAL]};I.operator_equals=(f)=>{const m=I.valueToCode(f,"OPERAND1",I.ORDER_NONE)||0,y=I.valueToCode(f,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) == num(${y}) or str(${m}) == str(${y}))`,I.ORDER_RELATIONAL]};I.operator_and=(f)=>{const m=I.valueToCode(f,"OPERAND1",I.ORDER_NONE)||"False",y=I.valueToCode(f,"OPERAND2",I.ORDER_NONE)||"False";return[`(${m} and ${y})`,I.ORDER_LOGICAL_AND]};I.operator_or=(f)=>{const m=I.valueToCode(f,"OPERAND1",I.ORDER_NONE)||"False",y=I.valueToCode(f,"OPERAND2",I.ORDER_NONE)||"False";return[`(${m} or ${y})`,I.ORDER_LOGICAL_OR]};I.operator_not=(f)=>{return[`(not ${I.valueToCode(f,"OPERAND",I.ORDER_NONE)||"False"})`,I.ORDER_LOGICAL_NOT]};I.operator_join=(f)=>{const m=I.valueToCode(f,"STRING1",I.ORDER_NONE)||'""',y=I.valueToCode(f,"STRING2",I.ORDER_NONE)||'""';return[`(str(${m}) + str(${y}))`,I.ORDER_ATOMIC]};I.operator_letter_of=(f)=>{const m=I.valueToCode(f,"LETTER",I.ORDER_NONE)||0;return[`(str(${I.valueToCode(f,"STRING",I.ORDER_NONE)||'""'})[num(${m}) - 1] || "")`,I.ORDER_MEMBER]};I.operator_length=(f)=>{return[`len(str(${I.valueToCode(f,"STRING",I.ORDER_NONE)||'""'}))`,I.ORDER_FUNCTION_CALL]};I.operator_contains=(f)=>{const m=I.valueToCode(f,"STRING1",I.ORDER_NONE)||'""',y=I.valueToCode(f,"STRING2",I.ORDER_NONE)||'""';return[`(str(${m}).count(str(${y})) > 0)`,I.ORDER_FUNCTION_CALL]};I.operator_mod=(f)=>{const m=I.valueToCode(f,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(f,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) % num(${y}))`,I.ORDER_MODULUS]};I.operator_round=(f)=>{return I.definitions_.import_math="import math",[`math.round(num(${I.valueToCode(f,"NUM",I.ORDER_NONE)||0}))`,I.ORDER_FUNCTION_CALL]};I.operator_mathop=(f)=>{I.definitions_.import_math="import math";const m=I.valueToCode(f,"NUM",I.ORDER_NONE)||0,y=f.getFieldValue("OPERATOR");let E="";if(y==="ceiling")E+=`math.ceil(num(${m}))`;else if(y==="sin"||y==="cos"||y==="tan")E+=`math.${y}(math.radians(num(${m})))`;else if(y==="asin"||y==="acos"||y==="atan")E+=`math.degrees(math.${y}(num(${m})))`;else if(y==="ln")E+=`(math.log(num(${m}))`;else if(y==="log")E+=`(math.log10(num(${m}))`;else if(y==="e ^")E+=`math.exp(num(${m}))`;else if(y==="10 ^")E+=`math.pow(10, num(${m}))`;else E+=`math.${y}(num(${m}))`;return[E,I.ORDER_FUNCTION_CALL]};I.procedures_definition=(f)=>{};I.procedures_call=(f)=>{};I.procedures_prototype=(f)=>{};I.procedures_declaration=(f)=>{};I.argument_reporter_boolean=(f)=>{};I.argument_reporter_string_number=(f)=>{};I.argument_editor_boolean=(f)=>{};I.argument_editor_string_number=(f)=>{};I.sensing_timer=()=>{return["runtime.time",I.ORDER_MEMBER]};I.sensing_resettimer=()=>{return"runtime.reset_timer()\n"};I.text=(f)=>{const m=f.getFieldValue("TEXT");return[m.length===0||isNaN(m)?I.quote_(m):+m,I.ORDER_ATOMIC]};var h3=1,v3=2,f3=3,p5="#0FBD8C",g5="#0DA57A",n3="#0B8E69",E6=(f)=>{if(typeof f!=="string")if(Array.isArray(f))f=String(f);else return f;return f.replace(/[<>&'"]/g,(m)=>{switch(m){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})},y5={number:"math_number",angle:"math_angle",text:"text",string:"text",color:"colour_picker",matrix:"matrix",note:"note"},w5={number:"NUM",angle:"NUM",text:"TEXT",string:"TEXT",matrix:"MATRIX",note:"NOTE"};_5("._5SVWFW_prompt-modal{width:360px}._5SVWFW_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}._5SVWFW_prompt-content input[type=checkbox],._5SVWFW_prompt-content input[type=radio]{margin:3px}._5SVWFW_label{margin:0 0 .75rem;font-weight:500}._5SVWFW_variable-name-text-input{border:1px solid var(--ui-black-transparent);color:var(--text-primary-transparent);border-radius:5px;width:100%;height:3rem;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}._5SVWFW_info-message{text-align:center;margin-bottom:1.5rem;font-size:.875rem;font-weight:400}._5SVWFW_options{justify-content:space-between;margin-bottom:1.5rem;font-weight:400;display:flex}._5SVWFW_button-row{text-align:right;font-weight:bolder}._5SVWFW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}._5SVWFW_ok-button{background:var(--motion-primary);border:var(--motion-primary);color:var(--ui-white);margin-left:var(--space)}");var _6={label:"_5SVWFW_label",promptModal:"_5SVWFW_prompt-modal",options:"_5SVWFW_options",okButton:"_5SVWFW_ok-button",button:"_5SVWFW_button",buttonRow:"_5SVWFW_button-row",variableNameTextInput:"_5SVWFW_variable-name-text-input",infoMessage:"_5SVWFW_info-message",promptContent:"_5SVWFW_prompt-content"},S3=["nes","translate","color-sensor","servo","time","pen","brain","request","text","broadcast"].map(async(f)=>{const{default:m}=await import(`@blockcode/extension-${f}`);return m.id=f,m}),j3=Promise.all(S3);_5(".cujmXa_editor-wrapper{border-radius:inherit;width:100%;height:100%;position:relative}.cujmXa_extension-button{z-index:var(--z-index-extension-button);background:var(--motion-primary);border:1px solid var(--motion-primary);box-sizing:content-box;border-bottom-left-radius:inherit;border-top:0;height:3.25rem;position:absolute;bottom:-1px;left:-1px}.cujmXa_extension-button:before{--fade-out-distance:15px;content:\"\";top:calc(calc(-1*var(--fade-out-distance)));height:var(--fade-out-distance);background:linear-gradient(#0000,#00000026);position:absolute;left:0;right:0}.cujmXa_add-button{cursor:pointer;background:0 0;border:none;outline:none;width:100%;height:100%}.cujmXa_add-button img{width:1.75rem;height:1.75rem}.cujmXa_debug-box{z-index:var(--z-index-monitor);border:1px solid var(--ui-tertiary);border-radius:var(--space)var(--space)0 0;opacity:.8;font-size:var(--standard-font-size);background:#fff;border-bottom:0;width:600px;height:300px;position:absolute;bottom:0;left:50vw;overflow:auto;transform:translate(-50%)}.cujmXa_debug-box pre{margin:calc(var(--space)/2)}");var c4={debugBox:"cujmXa_debug-box",addButton:"cujmXa_add-button",editorWrapper:"cujmXa_editor-wrapper",extensionButton:"cujmXa_extension-button"},C3="./assets/icon-extension-5ec2ee35b87b4126.svg",j6=new Map,j5=(f)=>typeof f!=="string"&&!f.button,D3=async(f,m,y,E,V)=>{if(m){for(let T of m)if(!j6.has(T)){let{default:F}=await import(`@blockcode/extension-${T}/blocks`);if(typeof F==="function")F=F(f);if(F.id=T,F.files)F.files.forEach(async(L)=>{const Y=`extensions/${T}/${L.name}`,H=await fetch(L.uri).then((w0)=>w0.text());E({...L,id:Y,content:H})});if(y(F.translations),V)V({...F,blocks:F.blocks.filter(j5)});j6.set(T,F)}}},B3="./assets/icon-blocks-d7e4a3a3eb74d0fb.svg",L3={"blocks.menu.file":"File","blocks.menu.file.newProject":"New","blocks.menu.file.openProject":"Open","blocks.menu.file.saveProject":"Save","blocks.menu.file.uploadProject":"Load from your computer","blocks.menu.file.downloadProject":"Save to your computer","blocks.menu.edit":"Edit","blocks.menu.edit.undo":"Undo","blocks.menu.edit.redo":"Redo","blocks.menu.device":"Device","blocks.menu.device.name":"device","blocks.menu.device.connect":"Connect to your {name}","blocks.menu.device.disconnect":"Disconnect this {name}","blocks.menu.device.download":"Download program","blocks.menu.device.turnOnAutoDownload":"Turn on Auto Download","blocks.menu.device.turnOffAutoDownload":"Turn off Auto Download","blocks.alert.downloading":"Downloading...{progress}%","blocks.alert.downloadCompleted":"Download completed.","blocks.codeTab":"Code","blocks.monitorPane.title":"Monitor","blocks.downloadToDevice":"Download","blocks.extensions.addExtension":"Add Extension","blocks.extensions.empty":"No extension!","blocks.dataPrompt.forAllTargets":"For all targets","blocks.dataPrompt.forThisTarget":"For this target only","blocks.dataPrompt.availableToAllTargets":"This variable will be available to all targets.","blocks.dataPrompt.listAvailableToAllTargets":"This list will be available to all targets.","blocks.dataPrompt.cancel":"Cancel","blocks.dataPrompt.ok":"OK","blocks.event.programStart":"when program start","blocks.control.stopOther":"other scripts"},k3={"blocks.menu.file":"\u6587\u4EF6","blocks.menu.file.newProject":"\u65B0\u4F5C\u54C1","blocks.menu.file.openProject":"\u6253\u5F00","blocks.menu.file.saveProject":"\u4FDD\u5B58","blocks.menu.file.uploadProject":"\u4ECE\u7535\u8111\u4E2D\u6253\u5F00","blocks.menu.file.downloadProject":"\u4FDD\u5B58\u5230\u7535\u8111","blocks.menu.edit":"\u7F16\u8F91","blocks.menu.edit.undo":"\u64A4\u9500","blocks.menu.edit.redo":"\u6062\u590D","blocks.menu.device":"\u8BBE\u5907","blocks.menu.device.name":"\u8BBE\u5907","blocks.menu.device.connect":"\u8FDE\u63A5{name}","blocks.menu.device.disconnect":"\u65AD\u5F00{name}\u8FDE\u63A5","blocks.menu.device.download":"\u4E0B\u8F7D\u7A0B\u5E8F","blocks.menu.device.turnOnAutoDownload":"\u6253\u5F00\u81EA\u52A8\u4E0B\u8F7D","blocks.menu.device.turnOffAutoDownload":"\u5173\u95ED\u81EA\u52A8\u4E0B\u8F7D","blocks.alert.downloading":"\u6B63\u5728\u4E0B\u8F7D\u2026{progress}%","blocks.alert.downloadCompleted":"\u4E0B\u8F7D\u5B8C\u6210\u3002","blocks.codeTab":"\u4EE3\u7801","blocks.monitorPane.title":"\u76D1\u89C6\u5668","blocks.downloadToDevice":"\u4E0B\u8F7D","blocks.extensions.addExtension":"\u6DFB\u52A0\u6269\u5C55","blocks.extensions.empty":"\u6CA1\u6709\u6269\u5C55\uFF01","blocks.dataPrompt.forAllTargets":"\u9002\u7528\u4E8E\u5168\u5C40","blocks.dataPrompt.forThisTarget":"\u4EC5\u9002\u7528\u4E8E\u5F53\u524D","blocks.dataPrompt.availableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u53D8\u91CF\u3002","blocks.dataPrompt.listAvailableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u5217\u8868\u3002","blocks.dataPrompt.cancel":"\u53D6\u6D88","blocks.dataPrompt.ok":"\u786E\u5B9A","blocks.event.programStart":"\u5F53\u7A0B\u5E8F\u5F00\u59CB\u8FD0\u884C","blocks.control.stopOther":"\u5176\u4ED6\u811A\u672C"},C5={en:L3,"zh-Hans":k3},g4={icon:B3,label:o5(r5,{id:"blocks.codeTab",defaultMessage:"Code"}),Content:G3},_i={label:o5(r5,{id:"blocks.monitorPane.title",defaultMessage:"Monitor"}),Content:null};import{useLocale as Z3} from"@blockcode/core";import{ScratchBlocks as Fi,makeToolboxXML as K3,blockSeparator as o6,categorySeparator as O4} from"@blockcode/blocks-editor";import{ScratchBlocks as y4} from"@blockcode/blocks-editor";y4.Blocks.event_whenflagclicked={init(){this.jsonInit({message0:y4.Msg.EVENT_WHENFLAGCLICKED,args0:[{type:"field_image",src:y4.mainWorkspace.options.pathToMedia+"green-flag.svg",width:24,height:24,alt:"flag"}],category:y4.Categories.event,extensions:["colours_event","shape_hat"]})}};import{ScratchBlocks as x6} from"@blockcode/blocks-editor";x6.Blocks.motion_attack={init(){this.jsonInit({message0:x6.Msg.MOTION_ATTACK,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"DISTANCE"}],category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_move={init(){this.jsonInit({message0:x6.Msg.MOTION_MOVE,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"SPEED"}],category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_setspeed={init(){this.jsonInit({message0:x6.Msg.MOTION_SETSPEED,args0:[{type:"input_value",name:"SPEED"}],category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_stop={init(){this.jsonInit({message0:x6.Msg.MOTION_STOP,category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_speed={init(){this.jsonInit({message0:x6.Msg.MOTION_SPEED,category:x6.Categories.motion,checkboxInFlyout:!0,extensions:["colours_motion","output_number"]})}};import{ScratchBlocks as l6} from"@blockcode/blocks-editor";l6.Blocks.sensing_scanwidth={init(){this.jsonInit({message0:l6.Msg.SENSING_SCANWIDTH,args0:[{type:"input_value",name:"WIDTH"}],category:l6.Categories.sensing,extensions:["colours_sensing","shape_statement"]})}};l6.Blocks.sensing_scan={init(){this.jsonInit({message0:l6.Msg.SENSING_SCAN,args0:[{type:"input_value",name:"DIRECTION"}],category:l6.Categories.sensing,extensions:["colours_sensing","output_boolean"]})}};l6.Blocks.sensing_scandistance={init(){this.jsonInit({message0:l6.Msg.SENSING_DISTANCE,args0:[{type:"input_value",name:"DIRECTION"}],category:l6.Categories.sensing,extensions:["colours_sensing","output_number"]})}};l6.Blocks.sensing_health={init(){this.jsonInit({message0:l6.Msg.SENSING_HEALTH,category:l6.Categories.sensing,checkboxInFlyout:!0,extensions:["colours_sensing","output_number"]})}};import{useRef as R3,useEffect as a3} from"preact/hooks";import{useEditor as z3} from"@blockcode/core";import{ScratchBlocks as p6} from"@blockcode/blocks-editor";import{ScratchBlocks as y6} from"@blockcode/blocks-editor";import{ScratchBlocks as F0} from"@blockcode/blocks-editor";import{ScratchBlocks as L5} from"@blockcode/blocks-editor";var k5=function({width:f,height:m,onSetup:y,...E}){const V=R3(null),{fileList:T,selectedIndex:F,modifyFile:L}=z3(),Y=T[F];if(V.script=Y.script,V.xml=Y.xml,V.current){const H=p6.getMainWorkspace();if(H&&H!==V.workspace)V.workspace=H,H.addChangeListener((w0)=>{if(H.isDragging())return;if(!F3.has(w0.type))return;const g0=p6.Xml.workspaceToDom(H),y0=p6.Xml.domToText(g0).replace(/<variable type="broadcast_msg"[^>]+>[^<]+<\/variable>/gi,"");if(!V.script||V.xml!==y0){const $=r.workspaceToCode(H);if(V.script!==$)L({script:$})}})}return a3(()=>{if(V.current){if(E4.default.setup(V.current),y)y(V.current)}return()=>{E4.default.project.clear(),E4.default.project.remove()}},[V]),q3("canvas",{id:"blockcode-blocks-player",ref:V,style:{width:f,height:m},...E})};import{jsx as q3} from"preact/jsx-runtime";var c3=Object.create,{defineProperty:I5,getPrototypeOf:E3,getOwnPropertyNames:N3}=Object,V3=Object.prototype.hasOwnProperty,N4=(f,m,y)=>{y=f!=null?c3(E3(f)):{};const E=m||!f||!f.__esModule?I5(y,"default",{value:f,enumerable:!0}):y;for(let V of N3(f))if(!V3.call(E,V))I5(E,V,{get:()=>f[V],enumerable:!0});return E},M3=(f,m)=>()=>(m||f((m={exports:{}}).exports,m),m.exports),Di=((f)=>typeof z6!=="undefined"?z6:typeof Proxy!=="undefined"?new Proxy(f,{get:(m,y)=>(typeof z6!=="undefined"?z6:m)[y]}):f)(function(f){if(typeof z6!=="undefined")return z6.apply(this,arguments);throw Error('Dynamic require of "'+f+'" is not supported')}),V4=M3((f,m)=>{/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var y=function(E,V){E=E||(()=>({}));var{window:T,document:F}=E,L=new function(){var i=/^(statics|enumerable|beans|preserve)$/,t=[],u=t.slice,h=Object.create,v=Object.getOwnPropertyDescriptor,n=Object.defineProperty,s=t.forEach||function(P,l){for(var _=0,D=this.length;_<D;_++)P.call(l,this[_],_,this)},x=function(P,l){for(var _ in this)if(this.hasOwnProperty(_))P.call(l,this[_],_,this)},p=Object.assign||function(P){for(var l=1,_=arguments.length;l<_;l++){var D=arguments[l];for(var B in D)if(D.hasOwnProperty(B))P[B]=D[B]}return P},g=function(P,l,_){if(P){var D=v(P,"length");(D&&typeof D.value==="number"?s:x).call(P,l,_=_||P)}return _};function d(P,l,_,D,B){var j={};function o(k,c){if(c=c||(c=v(l,k))&&(c.get?c:c.value),typeof c==="string"&&c[0]==="#")c=P[c.substring(1)]||c;var N=typeof c==="function",M=c,R=B||N&&!c.base?c&&c.get?k in P:P[k]:null,q;if(!B||!R){if(N&&R)c.base=R;if(N&&D!==!1&&(q=k.match(/^([gs]et|is)(([A-Z])(.*))$/)))j[q[3].toLowerCase()+q[4]]=q[2];if(!M||N||!M.get||typeof M.get!=="function"||!b.isPlainObject(M))M={value:M,writable:!0};if((v(P,k)||{configurable:!0}).configurable)M.configurable=!0,M.enumerable=_!=null?_:!q;n(P,k,M)}}if(l){for(var w in l)if(l.hasOwnProperty(w)&&!i.test(w))o(w);for(var w in j){var S=j[w],C=P["set"+S],G=P["get"+S]||C&&P["is"+S];if(G&&(D===!0||G.length===0))o(w,{get:G,set:C})}}return P}function b(){for(var P=0,l=arguments.length;P<l;P++){var _=arguments[P];if(_)p(this,_)}return this}return d(b,{inject:function(P){if(P){var l=P.statics===!0?P:P.statics,_=P.beans,D=P.preserve;if(l!==P)d(this.prototype,P,P.enumerable,_,D);d(this,l,null,_,D)}for(var B=1,j=arguments.length;B<j;B++)this.inject(arguments[B]);return this},extend:function(){var P=this,l,_;for(var D=0,B,j=arguments.length;D<j&&!(l&&_);D++)B=arguments[D],l=l||B.initialize,_=_||B.prototype;if(l=l||function(){P.apply(this,arguments)},_=l.prototype=_||h(this.prototype),n(_,"constructor",{value:l,writable:!0,configurable:!0}),d(l,this),arguments.length)this.inject.apply(l,arguments);return l.base=P,l}}).inject({enumerable:!1,initialize:b,set:b,inject:function(){for(var P=0,l=arguments.length;P<l;P++){var _=arguments[P];if(_)d(this,_,_.enumerable,_.beans,_.preserve)}return this},extend:function(){var P=h(this);return P.inject.apply(P,arguments)},each:function(P,l){return g(this,P,l)},clone:function(){return new this.constructor(this)},statics:{set:p,each:g,create:h,define:n,describe:v,clone:function(P){return p(new P.constructor,P)},isPlainObject:function(P){var l=P!=null&&P.constructor;return l&&(l===Object||l===b||l.name==="Object")},pick:function(P,l){return P!==V?P:l},slice:function(P,l,_){return u.call(P,l,_)}}})};if(typeof m!=="undefined")m.exports=L;L.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+L.each(this,function(i,t){if(!/^_/.test(t)){var u=typeof i;this.push(t+": "+(u==="number"?y0.instance.number(i):u==="string"?"'"+i+"'":i))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(i){return L.importJSON(i,this)},exportJSON:function(i){return L.exportJSON(this,i)},toJSON:function(){return L.serialize(this)},set:function(i,t){if(i)L.filter(this,i,t,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function i(){var t=i.base.apply(this,arguments),u=t.prototype._class;if(u&&!L.exports[u])L.exports[u]=t;return t},equals:function(i,t){if(i===t)return!0;if(i&&i.equals)return i.equals(t);if(t&&t.equals)return t.equals(i);if(i&&t&&typeof i==="object"&&typeof t==="object"){if(Array.isArray(i)&&Array.isArray(t)){var u=i.length;if(u!==t.length)return!1;while(u--)if(!L.equals(i[u],t[u]))return!1}else{var h=Object.keys(i),u=h.length;if(u!==Object.keys(t).length)return!1;while(u--){var v=h[u];if(!(t.hasOwnProperty(v)&&L.equals(i[v],t[v])))return!1}}return!0}return!1},read:function(i,t,u,h){if(this===L){var v=this.peek(i,t);return i.__index++,v}var n=this.prototype,s=n._readIndex,x=t||s&&i.__index||0,p=i.length,g=i[x];if(h=h||p-x,g instanceof this||u&&u.readNull&&g==null&&h<=1){if(s)i.__index=x+1;return g&&u&&u.clone?g.clone():g}if(g=L.create(n),s)g.__read=!0;if(g=g.initialize.apply(g,x>0||x+h<p?L.slice(i,x,x+h):i)||g,s){i.__index=x+g.__read;var d=g.__filtered;if(d)i.__filtered=d,g.__filtered=V;g.__read=V}return g},peek:function(i,t){return i[i.__index=t||i.__index||0]},remain:function(i){return i.length-(i.__index||0)},readList:function(i,t,u,h){var v=[],n,s=t||0,x=h?s+h:i.length;for(var p=s;p<x;p++)v.push(Array.isArray(n=i[p])?this.read(n,0,u):this.read(i,p,u,1));return v},readNamed:function(i,t,u,h,v){var n=this.getNamed(i,t),s=n!==V;if(s){var x=i.__filtered;if(!x){var p=this.getSource(i);x=i.__filtered=L.create(p),x.__unfiltered=p}x[t]=V}return this.read(s?[n]:i,u,h,v)},readSupported:function(i,t){var u=this.getSource(i),h=this,v=!1;if(u)Object.keys(u).forEach(function(n){if(n in t){var s=h.readNamed(i,n);if(s!==V)t[n]=s;v=!0}});return v},getSource:function(i){var t=i.__source;if(t===V){var u=i.length===1&&i[0];t=i.__source=u&&L.isPlainObject(u)?u:null}return t},getNamed:function(i,t){var u=this.getSource(i);if(u)return t?u[t]:i.__filtered||u},hasNamed:function(i,t){return!!this.getNamed(i,t)},filter:function(i,t,u,h){var v;function n(d){if(!(u&&(d in u))&&!(v&&(d in v))){var b=t[d];if(b!==V)i[d]=b}}if(h){var s={};for(var x=0,p,g=h.length;x<g;x++)if((p=h[x])in t)n(p),s[p]=!0;v=s}return Object.keys(t.__unfiltered||t).forEach(n),i},isPlainValue:function(i,t){return L.isPlainObject(i)||Array.isArray(i)||t&&typeof i==="string"},serialize:function(i,t,u,h){t=t||{};var v=!h,n;if(v)t.formatter=new y0(t.precision),h={length:0,definitions:{},references:{},add:function(b,P){var l="#"+b._id,_=this.references[l];if(!_){this.length++;var D=P.call(b),B=b._class;if(B&&D[0]!==B)D.unshift(B);this.definitions[l]=D,_=this.references[l]=[l]}return _}};if(i&&i._serialize){n=i._serialize(t,h);var s=i._class;if(s&&!i._compactSerialize&&(v||!u)&&n[0]!==s)n.unshift(s)}else if(Array.isArray(i)){n=[];for(var x=0,p=i.length;x<p;x++)n[x]=L.serialize(i[x],t,u,h)}else if(L.isPlainObject(i)){n={};var g=Object.keys(i);for(var x=0,p=g.length;x<p;x++){var d=g[x];n[d]=L.serialize(i[d],t,u,h)}}else if(typeof i==="number")n=t.formatter.number(i,t.precision);else n=i;return v&&h.length>0?[["dictionary",h.definitions],n]:n},deserialize:function(i,t,u,h,v){var n=i,s=!u,x=s&&i&&i.length&&i[0][0]==="dictionary";if(u=u||{},Array.isArray(i)){var p=i[0],g=p==="dictionary";if(i.length==1&&/^#/.test(p))return u.dictionary[p];p=L.exports[p],n=[];for(var d=p?1:0,b=i.length;d<b;d++)n.push(L.deserialize(i[d],t,u,g,x));if(p){var P=n;if(t)n=t(p,P,s||v);else n=new p(P)}}else if(L.isPlainObject(i)){if(n={},h)u.dictionary=n;for(var l in i)n[l]=L.deserialize(i[l],t,u)}return x?n[1]:n},exportJSON:function(i,t){var u=L.serialize(i,t);return t&&t.asString==!1?u:JSON.stringify(u)},importJSON:function(i,t){return L.deserialize(typeof i==="string"?JSON.parse(i):i,function(u,h,v){var n=v&&t&&t.constructor===u,s=n?t:L.create(u.prototype);if(h.length===1&&s instanceof l0&&(n||!(s instanceof b6))){var x=h[0];if(L.isPlainObject(x)){if(x.insert=!1,n)h=h.concat([l0.INSERT])}}if((n?s.set:u).apply(s,h),n)t=null;return s})},push:function(i,t){var u=t.length;if(u<4096)i.push.apply(i,t);else{var h=i.length;i.length+=u;for(var v=0;v<u;v++)i[h+v]=t[v]}return i},splice:function(i,t,u,h){var v=t&&t.length,n=u===V;if(u=n?i.length:u,u>i.length)u=i.length;for(var s=0;s<v;s++)t[s]._index=u+s;if(n)return L.push(i,t),[];else{var x=[u,h];if(t)L.push(x,t);var p=i.splice.apply(i,x);for(var s=0,g=p.length;s<g;s++)p[s]._index=V;for(var s=u+v,g=i.length;s<g;s++)i[s]._index=s;return p}},capitalize:function(i){return i.replace(/\b[a-z]/g,function(t){return t.toUpperCase()})},camelize:function(i){return i.replace(/-(.)/g,function(t,u){return u.toUpperCase()})},hyphenate:function(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Y={on:function(i,t){if(typeof i!=="string")L.each(i,function(n,s){this.on(s,n)},this);else{var u=this._eventTypes,h=u&&u[i],v=this._callbacks=this._callbacks||{};if(v=v[i]=v[i]||[],v.indexOf(t)===-1){if(v.push(t),h&&h.install&&v.length===1)h.install.call(this,i)}}return this},off:function(i,t){if(typeof i!=="string"){L.each(i,function(s,x){this.off(x,s)},this);return}var u=this._eventTypes,h=u&&u[i],v=this._callbacks&&this._callbacks[i],n;if(v){if(!t||(n=v.indexOf(t))!==-1&&v.length===1){if(h&&h.uninstall)h.uninstall.call(this,i);delete this._callbacks[i]}else if(n!==-1)v.splice(n,1)}return this},once:function(i,t){return this.on(i,function u(){t.apply(this,arguments),this.off(i,u)})},emit:function(i,t){var u=this._callbacks&&this._callbacks[i];if(!u)return!1;var h=L.slice(arguments,1),v=t&&t.target&&!t.currentTarget;if(u=u.slice(),v)t.currentTarget=this;for(var n=0,s=u.length;n<s;n++)if(u[n].apply(this,h)==!1){if(t&&t.stop)t.stop();break}if(v)delete t.currentTarget;return!0},responds:function(i){return!!(this._callbacks&&this._callbacks[i])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(i){var t=this._eventTypes,u=this._callbacks,h=i?"install":"uninstall";if(t){for(var v in u)if(u[v].length>0){var n=t[v],s=n&&n[h];if(s)s.call(this,v)}}},statics:{inject:function i(t){var u=t._events;if(u){var h={};L.each(u,function(v,n){var s=typeof v==="string",x=s?v:n,p=L.capitalize(x),g=x.substring(2).toLowerCase();h[g]=s?{}:v,x="_"+x,t["get"+p]=function(){return this[x]},t["set"+p]=function(d){var b=this[x];if(b)this.off(g,b);if(d)this.on(g,d);this[x]=d}}),t._eventTypes=h}return i.base.apply(this,arguments)}}},H=L.extend({_class:"PaperScope",initialize:function i(){G0=this,this.settings=new L({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=i._id++,i._scopes[this._id]=this;var t=i.prototype;if(!this.support){var u=Z0.getContext(1,1)||{};t.support={nativeDash:"setLineDash"in u||"mozDash"in u,nativeBlendModes:j4.nativeModes},Z0.release(u)}if(!this.agent){var h=E.navigator.userAgent.toLowerCase(),v=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(h)||[])[0],n=v==="darwin"?"mac":v,s=t.agent=t.browser={platform:n};if(n)s[n]=!0;if(h.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(x,p,g,d,b){if(!s.chrome){var P=p==="opera"?d:/^(node|trident)$/.test(p)?b:g;s.version=P,s.versionNumber=parseFloat(P),p={trident:"msie",jsdom:"node"}[p]||p,s.name=p,s[p]=!0}}),s.chrome)delete s.webkit;if(s.atom)delete s.chrome}},version:"0.12.17",getView:function(){var i=this.project;return i&&i._view},getPaper:function(){return this},execute:function(i,t){},install:function(i){var t=this;L.each(["project","view","tool"],function(h){L.define(i,h,{configurable:!0,get:function(){return t[h]}})});for(var u in this)if(!/^_/.test(u)&&this[u])i[u]=this[u]},setup:function(i){return G0=this,this.project=new r6(i),this},createCanvas:function(i,t){return Z0.getCanvas(i,t)},activate:function(){G0=this},clear:function(){var i=this.projects,t=this.tools;for(var u=i.length-1;u>=0;u--)i[u].remove();for(var u=t.length-1;u>=0;u--)t[u].remove()},remove:function(){this.clear(),delete H._scopes[this._id]},statics:new function(){function i(t){return t+="Attribute",function(u,h){return u[t](h)||u[t]("data-paper-"+h)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:i("get"),hasAttribute:i("has")}}}),w0=L.extend(Y,{initialize:function(i){if(this._scope=G0,this._index=this._scope[this._list].push(this)-1,i||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return!1;var i=this._scope[this._reference];if(i&&i!==this)i.emit("deactivate");return this._scope[this._reference]=this,this.emit("activate",i),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return!1;if(L.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this)this._scope[this._reference]=null;return this._scope=null,!0},getView:function(){return this._scope.getView()}}),g0={findItemBoundsCollisions:function(i,t,u){function h(s){var x=new Array(s.length);for(var p=0;p<s.length;p++){var g=s[p].getBounds();x[p]=[g.left,g.top,g.right,g.bottom]}return x}var v=h(i),n=!t||t===i?v:h(t);return this.findBoundsCollisions(v,n,u||0)},findCurveBoundsCollisions:function(i,t,u,h){function v(P){var{min:l,max:_}=Math,D=new Array(P.length);for(var B=0;B<P.length;B++){var j=P[B];D[B]=[l(j[0],j[2],j[4],j[6]),l(j[1],j[3],j[5],j[7]),_(j[0],j[2],j[4],j[6]),_(j[1],j[3],j[5],j[7])]}return D}var n=v(i),s=!t||t===i?n:v(t);if(h){var x=this.findBoundsCollisions(n,s,u||0,!1,!0),p=this.findBoundsCollisions(n,s,u||0,!0,!0),g=[];for(var d=0,b=x.length;d<b;d++)g[d]={hor:x[d],ver:p[d]};return g}return this.findBoundsCollisions(n,s,u||0)},findBoundsCollisions:function(i,t,u,h,v){var n=!t||i===t,s=n?i:i.concat(t),x=i.length,p=s.length;function g(Q,h0,p0){var x0=0,b0=Q.length;while(x0<b0){var v0=b0+x0>>>1;if(s[Q[v0]][h0]<p0)x0=v0+1;else b0=v0}return x0-1}var d=h?1:0,b=d+2,P=h?0:1,l=P+2,_=new Array(p);for(var D=0;D<p;D++)_[D]=D;_.sort(function(Q,h0){return s[Q][d]-s[h0][d]});var B=[],j=new Array(x);for(var D=0;D<p;D++){var o=_[D],w=s[o],S=n?o:o-x,C=o<x,G=n||!C,k=C?[]:null;if(B.length){var c=g(B,b,w[d]-u)+1;if(B.splice(0,c),n&&v){k=k.concat(B);for(var N=0;N<B.length;N++){var M=B[N];j[M].push(S)}}else{var R=w[l],q=w[P];for(var N=0;N<B.length;N++){var M=B[N],z=s[M],a=M<x,A=n||M>=x;if(v||(C&&A||G&&a)&&(R>=z[P]-u&&q<=z[l]+u)){if(C&&A)k.push(n?M:M-x);if(G&&a)j[M].push(S)}}}}if(C){if(i===t)k.push(o);j[o]=k}if(B.length){var e=w[b],X=g(B,b,e);B.splice(X+1,0,o)}else B.push(o)}for(var D=0;D<j.length;D++){var K=j[D];if(K)K.sort(function(h0,p0){return h0-p0})}return j}},y0=L.extend({initialize:function(i){this.precision=L.pick(i,5),this.multiplier=Math.pow(10,this.precision)},number:function(i){return this.precision<16?Math.round(i*this.multiplier)/this.multiplier:i},pair:function(i,t,u){return this.number(i)+(u||",")+this.number(t)},point:function(i,t){return this.number(i.x)+(t||",")+this.number(i.y)},size:function(i,t){return this.number(i.width)+(t||",")+this.number(i.height)},rectangle:function(i,t){return this.point(i,t)+(t||",")+this.size(i,t)}});y0.instance=new y0;var $=new function(){var i=[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],t=[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]],u=Math.abs,h=Math.sqrt,v=Math.pow,n=Math.log2||function(b){return Math.log(b)*Math.LOG2E},s=0.000000000001,x=0.000000000000000112;function p(b,P,l){return b<P?P:b>l?l:b}function g(b,P,l){function _(c){var N=c*134217729,M=c-N,R=M+N,q=c-R;return[R,q]}var D=P*P-b*l,B=P*P+b*l;if(u(D)*3<B){var j=_(b),o=_(P),w=_(l),S=P*P,C=o[0]*o[0]-S+2*o[0]*o[1]+o[1]*o[1],G=b*l,k=j[0]*w[0]-G+j[0]*w[1]+j[1]*w[0]+j[1]*w[1];D=S-G+(C-k)}return D}function d(){var b=Math.max.apply(Math,arguments);return b&&(b<0.00000001||b>1e8)?v(2,-Math.round(n(b))):0}return{EPSILON:s,MACHINE_EPSILON:x,CURVETIME_EPSILON:0.00000001,GEOMETRIC_EPSILON:0.0000001,TRIGONOMETRIC_EPSILON:0.00000001,ANGULAR_EPSILON:0.00001,KAPPA:4*(h(2)-1)/3,isZero:function(b){return b>=-s&&b<=s},isMachineZero:function(b){return b>=-x&&b<=x},clamp:p,integrate:function(b,P,l,_){var D=i[_-2],B=t[_-2],j=(l-P)*0.5,o=j+P,w=0,S=_+1>>1,C=_&1?B[w++]*b(o):0;while(w<S){var G=j*D[w];C+=B[w++]*(b(o+G)+b(o-G))}return j*C},findRoot:function(b,P,l,_,D,B,j){for(var o=0;o<B;o++){var w=b(l),S=w/P(l),C=l-S;if(u(S)<j){l=C;break}if(w>0)D=l,l=C<=_?(_+D)*0.5:C;else _=l,l=C>=D?(_+D)*0.5:C}return p(l,_,D)},solveQuadratic:function(b,P,l,_,D,B){var j,o=Infinity;if(u(b)<s){if(u(P)<s)return u(l)<s?-1:0;j=-l/P}else{P*=-0.5;var w=g(b,P,l);if(w&&u(w)<x){var S=d(u(b),u(P),u(l));if(S)b*=S,P*=S,l*=S,w=g(b,P,l)}if(w>=-x){var C=w<0?0:h(w),G=P+(P<0?-C:C);if(G===0)j=l/b,o=-j;else j=G/b,o=l/G}}var k=0,c=D==null,N=D-s,M=B+s;if(isFinite(j)&&(c||j>N&&j<M))_[k++]=c?j:p(j,D,B);if(o!==j&&isFinite(o)&&(c||o>N&&o<M))_[k++]=c?o:p(o,D,B);return k},solveCubic:function(b,P,l,_,D,B,j){var o=d(u(b),u(P),u(l),u(_)),w,S,C,G,k;if(o)b*=o,P*=o,l*=o,_*=o;function c(X){w=X;var K=b*w;S=K+P,C=S*w+l,G=(K+S)*w+C,k=C*w+_}if(u(b)<s)b=P,S=l,C=_,w=Infinity;else if(u(_)<s)S=P,C=l,w=0;else{c(-(P/b)/3);var N=k/b,M=v(u(N),0.3333333333333333),R=N<0?-1:1,q=-G/b,z=q>0?1.324717957244746*Math.max(M,h(q)):M,a=w-R*z;if(a!==w){do c(a),a=G===0?w:w-k/G/(1+x);while(R*a>R*w);if(u(b)*w*w>u(_/w))C=-_/w,S=(C-l)/w}}var A=$.solveQuadratic(b,S,C,D,B,j),e=B==null;if(isFinite(w)&&(A===0||A>0&&w!==D[0]&&w!==D[1])&&(e||w>B-s&&w<j+s))D[A++]=e?w:p(w,B,j);return A}}},r0={_id:1,_pools:{},get:function(i){if(i){var t=this._pools[i];if(!t)t=this._pools[i]={_id:1};return t._id++}else return this._id++}},O=L.extend({_class:"Point",_readIndex:!0,initialize:function i(t,u){var h=typeof t,v=this.__read,n=0;if(h==="number"){var s=typeof u==="number";if(this._set(t,s?u:t),v)n=s?2:1}else if(h==="undefined"||t===null){if(this._set(0,0),v)n=t===null?1:0}else{var x=h==="string"?t.split(/[\s,]+/)||[]:t;if(n=1,Array.isArray(x))this._set(+x[0],+(x.length>1?x[1]:x[0]));else if("x"in x)this._set(x.x||0,x.y||0);else if("width"in x)this._set(x.width||0,x.height||0);else if("angle"in x)this._set(x.length||0,0),this.setAngle(x.angle||0);else this._set(0,0),n=0}if(v)this.__read=n;return this},set:"#initialize",_set:function(i,t){return this.x=i,this.y=t,this},equals:function(i){return this===i||i&&(this.x===i.x&&this.y===i.y||Array.isArray(i)&&this.x===i[0]&&this.y===i[1])||!1},clone:function(){return new O(this.x,this.y)},toString:function(){var i=y0.instance;return"{ x: "+i.number(this.x)+", y: "+i.number(this.y)+" }"},_serialize:function(i){var t=i.formatter;return[t.number(this.x),t.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(i){if(this.isZero()){var t=this._angle||0;this._set(Math.cos(t)*i,Math.sin(t)*i)}else{var u=i/this.getLength();if($.isZero(u))this.getAngle();this._set(this.x*u,this.y*u)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(i){this.setAngleInRadians.call(this,i*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);else{var i=O.read(arguments),t=this.getLength()*i.getLength();if($.isZero(t))return NaN;else{var u=this.dot(i)/t;return Math.acos(u<-1?-1:u>1?1:u)}}},setAngleInRadians:function(i){if(this._angle=i,!this.isZero()){var t=this.getLength();this._set(Math.cos(i)*t,Math.sin(i)*t)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var i=O.read(arguments);return Math.atan2(this.cross(i),this.dot(i))*180/Math.PI},getDistance:function(){var i=arguments,t=O.read(i),u=t.x-this.x,h=t.y-this.y,v=u*u+h*h,n=L.read(i);return n?v:Math.sqrt(v)},normalize:function(i){if(i===V)i=1;var t=this.getLength(),u=t!==0?i/t:0,h=new O(this.x*u,this.y*u);if(u>=0)h._angle=this._angle;return h},rotate:function(i,t){if(i===0)return this.clone();i=i*Math.PI/180;var u=t?this.subtract(t):this,h=Math.sin(i),v=Math.cos(i);return u=new O(u.x*v-u.y*h,u.x*h+u.y*v),t?u.add(t):u},transform:function(i){return i?i._transformPoint(this):this},add:function(){var i=O.read(arguments);return new O(this.x+i.x,this.y+i.y)},subtract:function(){var i=O.read(arguments);return new O(this.x-i.x,this.y-i.y)},multiply:function(){var i=O.read(arguments);return new O(this.x*i.x,this.y*i.y)},divide:function(){var i=O.read(arguments);return new O(this.x/i.x,this.y/i.y)},modulo:function(){var i=O.read(arguments);return new O(this.x%i.x,this.y%i.y)},negate:function(){return new O(-this.x,-this.y)},isInside:function(){return m0.read(arguments).contains(this)},isClose:function(){var i=arguments,t=O.read(i),u=L.read(i);return this.getDistance(t)<=u},isCollinear:function(){var i=O.read(arguments);return O.isCollinear(this.x,this.y,i.x,i.y)},isColinear:"#isCollinear",isOrthogonal:function(){var i=O.read(arguments);return O.isOrthogonal(this.x,this.y,i.x,i.y)},isZero:function(){var i=$.isZero;return i(this.x)&&i(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(i){return this.x*(i>1&&i<4?-1:1)>=0&&this.y*(i>2?-1:1)>=0},dot:function(){var i=O.read(arguments);return this.x*i.x+this.y*i.y},cross:function(){var i=O.read(arguments);return this.x*i.y-this.y*i.x},project:function(){var i=O.read(arguments),t=i.isZero()?0:this.dot(i)/i.dot(i);return new O(i.x*t,i.y*t)},statics:{min:function(){var i=arguments,t=O.read(i),u=O.read(i);return new O(Math.min(t.x,u.x),Math.min(t.y,u.y))},max:function(){var i=arguments,t=O.read(i),u=O.read(i);return new O(Math.max(t.x,u.x),Math.max(t.y,u.y))},random:function(){return new O(Math.random(),Math.random())},isCollinear:function(i,t,u,h){return Math.abs(i*h-t*u)<=Math.sqrt((i*i+t*t)*(u*u+h*h))*0.00000001},isOrthogonal:function(i,t,u,h){return Math.abs(i*u+t*h)<=Math.sqrt((i*i+t*t)*(u*u+h*h))*0.00000001}}},L.each(["round","ceil","floor","abs"],function(i){var t=Math[i];this[i]=function(){return new O(t(this.x),t(this.y))}},{})),c0=O.extend({initialize:function i(t,u,h,v){this._x=t,this._y=u,this._owner=h,this._setter=v},_set:function(i,t,u){if(this._x=i,this._y=t,!u)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function(i){this._x=i,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(i){this._y=i,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(i){this._owner._changeSelection(this._getSelection(),i)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),t0=L.extend({_class:"Size",_readIndex:!0,initialize:function i(t,u){var h=typeof t,v=this.__read,n=0;if(h==="number"){var s=typeof u==="number";if(this._set(t,s?u:t),v)n=s?2:1}else if(h==="undefined"||t===null){if(this._set(0,0),v)n=t===null?1:0}else{var x=h==="string"?t.split(/[\s,]+/)||[]:t;if(n=1,Array.isArray(x))this._set(+x[0],+(x.length>1?x[1]:x[0]));else if("width"in x)this._set(x.width||0,x.height||0);else if("x"in x)this._set(x.x||0,x.y||0);else this._set(0,0),n=0}if(v)this.__read=n;return this},set:"#initialize",_set:function(i,t){return this.width=i,this.height=t,this},equals:function(i){return i===this||i&&(this.width===i.width&&this.height===i.height||Array.isArray(i)&&this.width===i[0]&&this.height===i[1])||!1},clone:function(){return new t0(this.width,this.height)},toString:function(){var i=y0.instance;return"{ width: "+i.number(this.width)+", height: "+i.number(this.height)+" }"},_serialize:function(i){var t=i.formatter;return[t.number(this.width),t.number(this.height)]},add:function(){var i=t0.read(arguments);return new t0(this.width+i.width,this.height+i.height)},subtract:function(){var i=t0.read(arguments);return new t0(this.width-i.width,this.height-i.height)},multiply:function(){var i=t0.read(arguments);return new t0(this.width*i.width,this.height*i.height)},divide:function(){var i=t0.read(arguments);return new t0(this.width/i.width,this.height/i.height)},modulo:function(){var i=t0.read(arguments);return new t0(this.width%i.width,this.height%i.height)},negate:function(){return new t0(-this.width,-this.height)},isZero:function(){var i=$.isZero;return i(this.width)&&i(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(i,t){return new t0(Math.min(i.width,t.width),Math.min(i.height,t.height))},max:function(i,t){return new t0(Math.max(i.width,t.width),Math.max(i.height,t.height))},random:function(){return new t0(Math.random(),Math.random())}}},L.each(["round","ceil","floor","abs"],function(i){var t=Math[i];this[i]=function(){return new t0(t(this.width),t(this.height))}},{})),X0=t0.extend({initialize:function i(t,u,h,v){this._width=t,this._height=u,this._owner=h,this._setter=v},_set:function(i,t,u){if(this._width=i,this._height=t,!u)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function(i){this._width=i,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(i){this._height=i,this._owner[this._setter](this)}}),m0=L.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function i(t,u,h,v){var n=arguments,s=typeof t,x;if(s==="number")this._set(t,u,h,v),x=4;else if(s==="undefined"||t===null)this._set(0,0,0,0),x=t===null?1:0;else if(n.length===1){if(Array.isArray(t))this._set.apply(this,t),x=1;else if(t.x!==V||t.width!==V)this._set(t.x||0,t.y||0,t.width||0,t.height||0),x=1;else if(t.from===V&&t.to===V){if(this._set(0,0,0,0),L.readSupported(n,this))x=1}}if(x===V){var p=O.readNamed(n,"from"),g=L.peek(n),d=p.x,b=p.y,P,l;if(g&&g.x!==V||L.hasNamed(n,"to")){var _=O.readNamed(n,"to");if(P=_.x-d,l=_.y-b,P<0)d=_.x,P=-P;if(l<0)b=_.y,l=-l}else{var D=t0.read(n);P=D.width,l=D.height}this._set(d,b,P,l),x=n.__index}var B=n.__filtered;if(B)this.__filtered=B;if(this.__read)this.__read=x;return this},set:"#initialize",_set:function(i,t,u,h){return this.x=i,this.y=t,this.width=u,this.height=h,this},clone:function(){return new m0(this.x,this.y,this.width,this.height)},equals:function(i){var t=L.isPlainValue(i)?m0.read(arguments):i;return t===this||t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height||!1},toString:function(){var i=y0.instance;return"{ x: "+i.number(this.x)+", y: "+i.number(this.y)+", width: "+i.number(this.width)+", height: "+i.number(this.height)+" }"},_serialize:function(i){var t=i.formatter;return[t.number(this.x),t.number(this.y),t.number(this.width),t.number(this.height)]},getPoint:function(i){var t=i?O:c0;return new t(this.x,this.y,this,"setPoint")},setPoint:function(){var i=O.read(arguments);this.x=i.x,this.y=i.y},getSize:function(i){var t=i?t0:X0;return new t(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var i=t0.read(arguments),t=this._sx,u=this._sy,h=i.width,v=i.height;if(t)this.x+=(this.width-h)*t;if(u)this.y+=(this.height-v)*u;this.width=h,this.height=v,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(i){if(!this._fw){var t=i-this.x;this.width-=this._sx===0.5?t*2:t}this.x=i,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(i){if(!this._fh){var t=i-this.y;this.height-=this._sy===0.5?t*2:t}this.y=i,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(i){if(!this._fw){var t=i-this.x;this.width=this._sx===0.5?t*2:t}this.x=i-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(i){if(!this._fh){var t=i-this.y;this.height=this._sy===0.5?t*2:t}this.y=i-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(i){if(this._fw||this._sx===0.5)this.x=i-this.width/2;else{if(this._sx)this.x+=(i-this.x)*2*this._sx;this.width=(i-this.x)*2}this._sx=0.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(i){if(this._fh||this._sy===0.5)this.y=i-this.height/2;else{if(this._sy)this.y+=(i-this.y)*2*this._sy;this.height=(i-this.y)*2}this._sy=0.5,this._fh=0},getCenter:function(i){var t=i?O:c0;return new t(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var i=O.read(arguments);return this.setCenterX(i.x),this.setCenterY(i.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(i){return i&&i.width!==V||(Array.isArray(i)?i:arguments).length===4?this._containsRectangle(m0.read(arguments)):this._containsPoint(O.read(arguments))},_containsPoint:function(i){var{x:t,y:u}=i;return t>=this.x&&u>=this.y&&t<=this.x+this.width&&u<=this.y+this.height},_containsRectangle:function(i){var{x:t,y:u}=i;return t>=this.x&&u>=this.y&&t+i.width<=this.x+this.width&&u+i.height<=this.y+this.height},intersects:function(){var i=m0.read(arguments),t=L.read(arguments)||0;return i.x+i.width>this.x-t&&i.y+i.height>this.y-t&&i.x<this.x+this.width+t&&i.y<this.y+this.height+t},intersect:function(){var i=m0.read(arguments),t=Math.max(this.x,i.x),u=Math.max(this.y,i.y),h=Math.min(this.x+this.width,i.x+i.width),v=Math.min(this.y+this.height,i.y+i.height);return new m0(t,u,h-t,v-u)},unite:function(){var i=m0.read(arguments),t=Math.min(this.x,i.x),u=Math.min(this.y,i.y),h=Math.max(this.x+this.width,i.x+i.width),v=Math.max(this.y+this.height,i.y+i.height);return new m0(t,u,h-t,v-u)},include:function(){var i=O.read(arguments),t=Math.min(this.x,i.x),u=Math.min(this.y,i.y),h=Math.max(this.x+this.width,i.x),v=Math.max(this.y+this.height,i.y);return new m0(t,u,h-t,v-u)},expand:function(){var i=t0.read(arguments),t=i.width,u=i.height;return new m0(this.x-t/2,this.y-u/2,this.width+t,this.height+u)},scale:function(i,t){return this.expand(this.width*i-this.width,this.height*(t===V?i:t)-this.height)}},L.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(i,t){var u=i.join(""),h=/^[RL]/.test(u);if(t>=4)i[1]+=h?"Y":"X";var v=i[h?0:1],n=i[h?1:0],s="get"+v,x="get"+n,p="set"+v,g="set"+n,d="get"+u,b="set"+u;this[d]=function(P){var l=P?O:c0;return new l(this[s](),this[x](),this,b)},this[b]=function(){var P=O.read(arguments);this[p](P.x),this[g](P.y)}},{beans:!0})),G6=m0.extend({initialize:function i(t,u,h,v,n,s){this._set(t,u,h,v,!0),this._owner=n,this._setter=s},_set:function(i,t,u,h,v){if(this._x=i,this._y=t,this._width=u,this._height=h,!v)this._owner[this._setter](this);return this}},new function(){var i=m0.prototype;return L.each(["x","y","width","height"],function(t){var u=L.capitalize(t),h="_"+t;this["get"+u]=function(){return this[h]},this["set"+u]=function(v){if(this[h]=v,!this._dontNotify)this._owner[this._setter](this)}},L.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(t){var u="set"+t;this[u]=function(){this._dontNotify=!0,i[u].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(t){var u=this._owner;if(u._changeSelection)u._changeSelection(2,t)}}))}),B0=L.extend({_class:"Matrix",initialize:function i(t,u){var h=arguments,v=h.length,n=!0;if(v>=6)this._set.apply(this,h);else if(v===1||v===2)if(t instanceof i)this._set(t._a,t._b,t._c,t._d,t._tx,t._ty,u);else if(Array.isArray(t))this._set.apply(this,u?t.concat([u]):t);else n=!1;else if(!v)this.reset();else n=!1;if(!n)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(i,t,u,h,v,n,s){if(this._a=i,this._b=t,this._c=u,this._d=h,this._tx=v,this._ty=n,!s)this._changed();return this},_serialize:function(i,t){return L.serialize(this.getValues(),i,!0,t)},_changed:function(){var i=this._owner;if(i)if(i._applyMatrix)i.transform(null,!0);else i._changed(25)},clone:function(){return new B0(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(i){return i===this||i&&this._a===i._a&&this._b===i._b&&this._c===i._c&&this._d===i._d&&this._tx===i._tx&&this._ty===i._ty},toString:function(){var i=y0.instance;return"[["+[i.number(this._a),i.number(this._c),i.number(this._tx)].join(", ")+"], ["+[i.number(this._b),i.number(this._d),i.number(this._ty)].join(", ")+"]]"},reset:function(i){if(this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,!i)this._changed();return this},apply:function(i,t){var u=this._owner;if(u)return u.transform(null,L.pick(i,!0),t),this.isIdentity();return!1},translate:function(){var i=O.read(arguments),t=i.x,u=i.y;return this._tx+=t*this._a+u*this._c,this._ty+=t*this._b+u*this._d,this._changed(),this},scale:function(){var i=arguments,t=O.read(i),u=O.read(i,0,{readNull:!0});if(u)this.translate(u);if(this._a*=t.x,this._b*=t.x,this._c*=t.y,this._d*=t.y,u)this.translate(u.negate());return this._changed(),this},rotate:function(i){i*=Math.PI/180;var t=O.read(arguments,1),u=t.x,h=t.y,v=Math.cos(i),n=Math.sin(i),s=u-u*v+h*n,x=h-u*n-h*v,p=this._a,g=this._b,d=this._c,b=this._d;return this._a=v*p+n*d,this._b=v*g+n*b,this._c=-n*p+v*d,this._d=-n*g+v*b,this._tx+=s*p+x*d,this._ty+=s*g+x*b,this._changed(),this},shear:function(){var i=arguments,t=O.read(i),u=O.read(i,0,{readNull:!0});if(u)this.translate(u);var h=this._a,v=this._b;if(this._a+=t.y*this._c,this._b+=t.y*this._d,this._c+=t.x*h,this._d+=t.x*v,u)this.translate(u.negate());return this._changed(),this},skew:function(){var i=arguments,t=O.read(i),u=O.read(i,0,{readNull:!0}),h=Math.PI/180,v=new O(Math.tan(t.x*h),Math.tan(t.y*h));return this.shear(v,u)},append:function(i,t){if(i){var u=this._a,h=this._b,v=this._c,n=this._d,s=i._a,x=i._c,p=i._b,g=i._d,d=i._tx,b=i._ty;if(this._a=s*u+p*v,this._c=x*u+g*v,this._b=s*h+p*n,this._d=x*h+g*n,this._tx+=d*u+b*v,this._ty+=d*h+b*n,!t)this._changed()}return this},prepend:function(i,t){if(i){var u=this._a,h=this._b,v=this._c,n=this._d,s=this._tx,x=this._ty,p=i._a,g=i._c,d=i._b,b=i._d,P=i._tx,l=i._ty;if(this._a=p*u+g*h,this._c=p*v+g*n,this._b=d*u+b*h,this._d=d*v+b*n,this._tx=p*s+g*x+P,this._ty=d*s+b*x+l,!t)this._changed()}return this},appended:function(i){return this.clone().append(i)},prepended:function(i){return this.clone().prepend(i)},invert:function(){var i=this._a,t=this._b,u=this._c,h=this._d,v=this._tx,n=this._ty,s=i*h-t*u,x=null;if(s&&!isNaN(s)&&isFinite(v)&&isFinite(n))this._a=h/s,this._b=-t/s,this._c=-u/s,this._d=i/s,this._tx=(u*n-h*v)/s,this._ty=(t*v-i*n)/s,x=this;return x},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new B0(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var i=this._a*this._d-this._c*this._b;return i&&!isNaN(i)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(i,t,u){return arguments.length<3?this._transformPoint(O.read(arguments)):this._transformCoordinates(i,t,u)},_transformPoint:function(i,t,u){var{x:h,y:v}=i;if(!t)t=new O;return t._set(h*this._a+v*this._c+this._tx,h*this._b+v*this._d+this._ty,u)},_transformCoordinates:function(i,t,u){for(var h=0,v=2*u;h<v;h+=2){var n=i[h],s=i[h+1];t[h]=n*this._a+s*this._c+this._tx,t[h+1]=n*this._b+s*this._d+this._ty}return t},_transformCorners:function(i){var{x:t,y:u}=i,h=t+i.width,v=u+i.height,n=[t,u,h,u,h,v,t,v];return this._transformCoordinates(n,n,4)},_transformBounds:function(i,t,u){var h=this._transformCorners(i),v=h.slice(0,2),n=v.slice();for(var s=2;s<8;s++){var x=h[s],p=s&1;if(x<v[p])v[p]=x;else if(x>n[p])n[p]=x}if(!t)t=new m0;return t._set(v[0],v[1],n[0]-v[0],n[1]-v[1],u)},inverseTransform:function(){return this._inverseTransform(O.read(arguments))},_inverseTransform:function(i,t,u){var h=this._a,v=this._b,n=this._c,s=this._d,x=this._tx,p=this._ty,g=h*s-v*n,d=null;if(g&&!isNaN(g)&&isFinite(x)&&isFinite(p)){var b=i.x-this._tx,P=i.y-this._ty;if(!t)t=new O;d=t._set((b*s-P*n)/g,(P*h-b*v)/g,u)}return d},decompose:function(){var i=this._a,t=this._b,u=this._c,h=this._d,v=i*h-t*u,n=Math.sqrt,s=Math.atan2,x=180/Math.PI,p,g,d;if(i!==0||t!==0){var b=n(i*i+t*t);p=Math.acos(i/b)*(t>0?1:-1),g=[b,v/b],d=[s(i*u+t*h,b*b),0]}else if(u!==0||h!==0){var P=n(u*u+h*h);p=Math.asin(u/P)*(h>0?1:-1),g=[v/P,P],d=[0,s(i*u+t*h,P*P)]}else p=0,d=g=[0,0];return{translation:this.getTranslation(),rotation:p*x,scaling:new O(g),skewing:new O(d[0]*x,d[1]*x)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new O(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(i){if(!this.isIdentity())i.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},L.each(["a","b","c","d","tx","ty"],function(i){var t=L.capitalize(i),u="_"+i;this["get"+t]=function(){return this[u]},this["set"+t]=function(h){this[u]=h,this._changed()}},{})),Y0=L.extend({_class:"Line",initialize:function i(t,u,h,v,n){var s=!1;if(arguments.length>=4)this._px=t,this._py=u,this._vx=h,this._vy=v,s=n;else this._px=t.x,this._py=t.y,this._vx=u.x,this._vy=u.y,s=h;if(!s)this._vx-=this._px,this._vy-=this._py},getPoint:function(){return new O(this._px,this._py)},getVector:function(){return new O(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(i,t){return Y0.intersect(this._px,this._py,this._vx,this._vy,i._px,i._py,i._vx,i._vy,!0,t)},getSide:function(i,t){return Y0.getSide(this._px,this._py,this._vx,this._vy,i.x,i.y,!0,t)},getDistance:function(i){return Math.abs(this.getSignedDistance(i))},getSignedDistance:function(i){return Y0.getSignedDistance(this._px,this._py,this._vx,this._vy,i.x,i.y,!0)},isCollinear:function(i){return O.isCollinear(this._vx,this._vy,i._vx,i._vy)},isOrthogonal:function(i){return O.isOrthogonal(this._vx,this._vy,i._vx,i._vy)},statics:{intersect:function(i,t,u,h,v,n,s,x,p,g){if(!p)u-=i,h-=t,s-=v,x-=n;var d=u*x-h*s;if(!$.isMachineZero(d)){var b=i-v,P=t-n,l=(s*P-x*b)/d,_=(u*P-h*b)/d,D=0.000000000001,B=-D,j=1+D;if(g||B<l&&l<j&&B<_&&_<j){if(!g)l=l<=0?0:l>=1?1:l;return new O(i+l*u,t+l*h)}}},getSide:function(i,t,u,h,v,n,s,x){if(!s)u-=i,h-=t;var p=v-i,g=n-t,d=p*h-g*u;if(!x&&$.isMachineZero(d)){if(d=(p*u+p*u)/(u*u+h*h),d>=0&&d<=1)d=0}return d<0?-1:d>0?1:0},getSignedDistance:function(i,t,u,h,v,n,s){if(!s)u-=i,h-=t;return u===0?h>0?v-i:i-v:h===0?u<0?n-t:t-n:((v-i)*h-(n-t)*u)/(h>u?h*Math.sqrt(1+u*u/(h*h)):u*Math.sqrt(1+h*h/(u*u)))},getDistance:function(i,t,u,h,v,n,s){return Math.abs(Y0.getSignedDistance(i,t,u,h,v,n,s))}}}),r6=w0.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function i(t){w0.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new z0(null,null,this),this._view=A0.create(this,t||Z0.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(i,t){return L.serialize(this._children,i,!0,t)},_changed:function(i,t){if(i&1){var u=this._view;if(u){if(u._needsUpdate=!0,!u._requested&&u._autoUpdate)u.requestUpdate()}}var h=this._changes;if(h&&t){var v=this._changesById,n=t._id,s=v[n];if(s)s.flags|=i;else h.push(v[n]={item:t,flags:i})}},clear:function(){var i=this._children;for(var t=i.length-1;t>=0;t--)i[t].remove()},isEmpty:function(){return!this._children.length},remove:function i(){if(!i.base.call(this))return!1;if(this._view)this._view.remove();return!0},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(i){this._currentStyle.set(i)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new b6({project:this,insert:!0})},getSymbolDefinitions:function(){var i=[],t={};return this.getItems({class:u0,match:function(u){var h=u._definition,v=h._id;if(!t[v])t[v]=!0,i.push(h);return!1}}),i},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var i=this._selectionItems,t=[];for(var u in i){var h=i[u],v=h._selection;if(v&1&&h.isInserted())t.push(h);else if(!v)this._updateSelection(h)}return t},_updateSelection:function(i){var t=i._id,u=this._selectionItems;if(i._selection){if(u[t]!==i)this._selectionCount++,u[t]=i}else if(u[t]===i)this._selectionCount--,delete u[t]},selectAll:function(){var i=this._children;for(var t=0,u=i.length;t<u;t++)i[t].setFullySelected(!0)},deselectAll:function(){var i=this._selectionItems;for(var t in i)i[t].setFullySelected(!1)},addLayer:function(i){return this.insertLayer(V,i)},insertLayer:function(i,t){if(t instanceof b6){t._remove(!1,!0),L.splice(this._children,[t],i,0),t._setProject(this,!0);var u=t._name;if(u)t.setName(u);if(this._changes)t._changed(5);if(!this._activeLayer)this._activeLayer=t}else t=null;return t},_insertItem:function(i,t,u){if(t=this.insertLayer(i,t)||(this._activeLayer||this._insertItem(V,new b6(l0.NO_INSERT),!0)).insertChild(i,t),u&&t.activate)t.activate();return t},getItems:function(i){return l0._getItems(this,i)},getItem:function(i){return l0._getItems(this,i,null,null,!0)[0]||null},importJSON:function(i){this.activate();var t=this._activeLayer;return L.importJSON(i,t&&t.isEmpty()&&t)},removeOn:function(i){var t=this._removeSets;if(t){if(i==="mouseup")t.mousedrag=null;var u=t[i];if(u){for(var h in u){var v=u[h];for(var n in t){var s=t[n];if(s&&s!=u)delete s[v._id]}v.remove()}t[i]=null}}},draw:function(i,t,u){this._updateVersion++,i.save(),t.applyToContext(i);var h=this._children,v=new L({offset:new O(0,0),pixelRatio:u,viewMatrix:t.isIdentity()?null:t,matrices:[new B0],updateMatrix:!0});for(var n=0,s=h.length;n<s;n++)h[n].draw(i,v);if(i.restore(),this._selectionCount>0){i.save(),i.strokeWidth=1;var x=this._selectionItems,p=this._scope.settings.handleSize,g=this._updateVersion;for(var d in x)x[d]._drawSelection(i,t,p,x,g);i.restore()}}}),l0=L.extend(Y,{statics:{extend:function i(t){if(t._serializeFields)t._serializeFields=L.set({},this.prototype._serializeFields,t._serializeFields);return i.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new B0,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var i=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return L.each(i,function(t){this._events[t]={install:function(u){this.getView()._countItemEvent(u,1)},uninstall:function(u){this.getView()._countItemEvent(u,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:i}})},{initialize:function i(){},_initialize:function(i,t){var u=i&&L.isPlainObject(i),h=u&&i.internal===!0,v=this._matrix=new B0,n=u&&i.project||G0.project,s=G0.settings;if(this._id=h?null:r0.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&s.applyMatrix,t)v.translate(t);if(v._owner=this,this._style=new z0(n._currentStyle,this,n),h||u&&i.insert==!1||!s.insertItems&&!(u&&i.insert==!0))this._setProject(n);else(u&&i.parent||n)._insertItem(V,this,!0);if(u&&i!==l0.NO_INSERT&&i!==l0.INSERT)this.set(i,{internal:!0,insert:!0,project:!0,parent:!0});return u},_serialize:function(i,t){var u={},h=this;function v(n){for(var s in n){var x=h[s];if(!L.equals(x,s==="leading"?n.fontSize*1.2:n[s]))u[s]=L.serialize(x,i,s!=="data",t)}}if(v(this._serializeFields),!(this instanceof J0))v(this._style._defaults);return[this._class,u]},_changed:function(i){var t=this._symbol,u=this._parent||t,h=this._project;if(i&8)this._bounds=this._position=this._decomposed=V;if(i&16)this._globalMatrix=V;if(u&&i&72)l0._clearBoundsCache(u);if(i&2)l0._clearBoundsCache(this);if(h)h._changed(i,this);if(t)t._changed(i)},getId:function(){return this._id},getName:function(){return this._name},setName:function(i){if(this._name)this._removeNamed();if(i===+i+"")throw new Error("Names consisting only of numbers are not supported.");var t=this._getOwner();if(i&&t){var{_children:u,_namedChildren:h}=t;if((h[i]=h[i]||[]).push(this),!(i in u))u[i]=this}this._name=i||V,this._changed(256)},getStyle:function(){return this._style},setStyle:function(i){this.getStyle().set(i)}},L.each(["locked","visible","blendMode","opacity","guide"],function(i){var t=L.capitalize(i),u="_"+i,h={locked:256,visible:265};this["get"+t]=function(){return this[u]},this["set"+t]=function(v){if(v!=this[u])this[u]=v,this._changed(h[i]||257)}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(i){if(i!==this._selection){this._selection=i;var t=this._project;if(t)t._updateSelection(this),this._changed(257)}},_changeSelection:function(i,t){var u=this._selection;this.setSelection(t?u|i:u&~i)},isSelected:function(){if(this._selectChildren){var i=this._children;for(var t=0,u=i.length;t<u;t++)if(i[t].isSelected())return!0}return!!(this._selection&1)},setSelected:function(i){if(this._selectChildren){var t=this._children;for(var u=0,h=t.length;u<h;u++)t[u].setSelected(i)}this._changeSelection(1,i)},isFullySelected:function(){var i=this._children,t=!!(this._selection&1);if(i&&t){for(var u=0,h=i.length;u<h;u++)if(!i[u].isFullySelected())return!1;return!0}return t},setFullySelected:function(i){var t=this._children;if(t)for(var u=0,h=t.length;u<h;u++)t[u].setFullySelected(i);this._changeSelection(1,i)},isClipMask:function(){return this._clipMask},setClipMask:function(i){if(this._clipMask!=(i=!!i)){if(this._clipMask=i,i)this.setFillColor(null),this.setStrokeColor(null);if(this._changed(257),this._parent)this._parent._changed(2048)}},getData:function(){if(!this._data)this._data={};return this._data},setData:function(i){this._data=i},getPosition:function(i){var t=i?O:c0,u=this._position||(this._position=this._getPositionFromBounds());return new t(u.x,u.y,this,"setPosition")},setPosition:function(){this.translate(O.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(i){return this._pivot?this._matrix._transformPoint(this._pivot):(i||this.getBounds()).getCenter(!0)},getPivot:function(){var i=this._pivot;return i?new c0(i.x,i.y,this,"setPivot"):null},setPivot:function(){this._pivot=O.read(arguments,0,{clone:!0,readNull:!0}),this._position=V}},L.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(i,t){this[t]=function(u){return this.getBounds(u,i)}},{beans:!0,getBounds:function(i,t){var u=t||i instanceof B0,h=L.set({},u?t:i,this._boundsOptions);if(!h.stroke||this.getStrokeScaling())h.cacheItem=this;var v=this._getCachedBounds(u&&i,h).rect;return!arguments.length?new G6(v.x,v.y,v.width,v.height,this,"setBounds"):v},setBounds:function(){var i=m0.read(arguments),t=this.getBounds(),u=this._matrix,h=new B0,v=i.getCenter();if(h.translate(v),i.width!=t.width||i.height!=t.height){if(!u.isInvertible())u.set(u._backup||new B0().translate(u.getTranslation())),t=this.getBounds();h.scale(t.width!==0?i.width/t.width:0,t.height!==0?i.height/t.height:0)}v=t.getCenter(),h.translate(-v.x,-v.y),this.transform(h)},_getBounds:function(i,t){var u=this._children;if(!u||!u.length)return new m0;return l0._updateBoundsCache(this,t.cacheItem),l0._getBounds(u,i,t)},_getBoundsCacheKey:function(i,t){return[i.stroke?1:0,i.handle?1:0,t?1:0].join("")},_getCachedBounds:function(i,t,u){i=i&&i._orNullIfIdentity();var h=t.internal&&!u,v=t.cacheItem,n=h?null:this._matrix._orNullIfIdentity(),s=v&&(!i||i.equals(n))&&this._getBoundsCacheKey(t,h),x=this._bounds;if(l0._updateBoundsCache(this._parent||this._symbol,v),s&&x&&s in x){var p=x[s];return{rect:p.rect.clone(),nonscaling:p.nonscaling}}var g=this._getBounds(i||n,t),d=g.rect||g,b=this._style,P=g.nonscaling||b.hasStroke()&&!b.getStrokeScaling();if(s){if(!x)this._bounds=x={};var p=x[s]={rect:d.clone(),nonscaling:P,internal:h}}return{rect:d,nonscaling:P}},_getStrokeMatrix:function(i,t){var u=this.getStrokeScaling()?null:t&&t.internal?this:this._parent||this._symbol&&this._symbol._item,h=u?u.getViewMatrix().invert():i;return h&&h._shiftless()},statics:{_updateBoundsCache:function(i,t){if(i&&t){var u=t._id,h=i._boundsCache=i._boundsCache||{ids:{},list:[]};if(!h.ids[u])h.list.push(t),h.ids[u]=t}},_clearBoundsCache:function(i){var t=i._boundsCache;if(t){i._bounds=i._position=i._boundsCache=V;for(var u=0,h=t.list,v=h.length;u<v;u++){var n=h[u];if(n!==i){if(n._bounds=n._position=V,n._boundsCache)l0._clearBoundsCache(n)}}}},_getBounds:function(i,t,u){var h=Infinity,v=-h,n=h,s=v,x=!1;u=u||{};for(var p=0,g=i.length;p<g;p++){var d=i[p];if(d._visible&&!d.isEmpty(!0)){var b=d._getCachedBounds(t&&t.appended(d._matrix),u,!0),P=b.rect;if(h=Math.min(P.x,h),n=Math.min(P.y,n),v=Math.max(P.x+P.width,v),s=Math.max(P.y+P.height,s),b.nonscaling)x=!0}}return{rect:isFinite(h)?new m0(h,n,v-h,s-n):new m0,nonscaling:x}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var i=this._decompose();return i?i.rotation:0},setRotation:function(i){var t=this.getRotation();if(t!=null&&i!=null){var u=this._decomposed;if(this.rotate(i-t),u)u.rotation=i,this._decomposed=u}},getScaling:function(){var i=this._decompose(),t=i&&i.scaling;return new c0(t?t.x:1,t?t.y:1,this,"setScaling")},setScaling:function(){var i=this.getScaling(),t=O.read(arguments,0,{clone:!0,readNull:!0});if(i&&t&&!i.equals(t)){var u=this.getRotation(),h=this._decomposed,v=new B0,n=$.isZero;if(n(i.x)||n(i.y)){if(v.translate(h.translation),u)v.rotate(u);v.scale(t.x,t.y),this._matrix.set(v)}else{var s=this.getPosition(!0);if(v.translate(s),u)v.rotate(u);if(v.scale(t.x/i.x,t.y/i.y),u)v.rotate(-u);v.translate(s.negate()),this.transform(v)}if(h)h.scaling=t,this._decomposed=h}},getMatrix:function(){return this._matrix},setMatrix:function(){var i=this._matrix;i.set.apply(i,arguments)},getGlobalMatrix:function(i){var t=this._globalMatrix;if(t){var u=this._parent,h=[];while(u){if(!u._globalMatrix){t=null;for(var v=0,n=h.length;v<n;v++)h[v]._globalMatrix=null;break}h.push(u),u=u._parent}}if(!t){t=this._globalMatrix=this._matrix.clone();var u=this._parent;if(u)t.prepend(u.getGlobalMatrix(!0))}return i?t:t.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(i){if(this._applyMatrix=this._canApplyMatrix&&!!i)this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(i,t){if(this._project!==i){if(this._project)this._installEvents(!1);this._project=i;var u=this._children;for(var h=0,v=u&&u.length;h<v;h++)u[h]._setProject(i);t=!0}if(t)this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function i(t){i.base.call(this,t);var u=this._children;for(var h=0,v=u&&u.length;h<v;h++)u[h]._installEvents(t)},getLayer:function(){var i=this;while(i=i._parent)if(i instanceof b6)return i;return null},getParent:function(){return this._parent},setParent:function(i){return i.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(i){this.removeChildren(),this.addChildren(i)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var i=this._getOwner();return i&&i._children[this._index+1]||null},getPreviousSibling:function(){var i=this._getOwner();return i&&i._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(i){return i===this||i&&this._class===i._class&&this._style.equals(i._style)&&this._matrix.equals(i._matrix)&&this._locked===i._locked&&this._visible===i._visible&&this._blendMode===i._blendMode&&this._opacity===i._opacity&&this._clipMask===i._clipMask&&this._guide===i._guide&&this._equals(i)||!1},_equals:function(i){return L.equals(this._children,i._children)},clone:function(i){var t=new this.constructor(l0.NO_INSERT),u=this._children,h=L.pick(i?i.insert:V,i===V||i===!0),v=L.pick(i?i.deep:V,!0);if(u)t.copyAttributes(this);if(!u||v)t.copyContent(this);if(!u)t.copyAttributes(this);if(h)t.insertAbove(this);var n=this._name,s=this._parent;if(n&&s){var u=s._children,x=n,p=1;while(u[n])n=x+" "+p++;if(n!==x)t.setName(n)}return t},copyContent:function(i){var t=i._children;for(var u=0,h=t&&t.length;u<h;u++)this.addChild(t[u].clone(!1),!0)},copyAttributes:function(i,t){this.setStyle(i._style);var u=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var h=0,v=u.length;h<v;h++){var n=u[h];if(i.hasOwnProperty(n))this[n]=i[n]}if(!t)this._matrix.set(i._matrix,!0);this.setApplyMatrix(i._applyMatrix),this.setPivot(i._pivot),this.setSelection(i._selection);var{_data:s,_name:x}=i;if(this._data=s?L.clone(s):null,x)this.setName(x)},rasterize:function(i,t){var u,h,v;if(L.isPlainObject(i))u=i.resolution,h=i.insert,v=i.raster;else u=i,h=t;if(!v)v=new i0(l0.NO_INSERT);var n=this.getStrokeBounds(),s=(u||this.getView().getResolution())/72,x=n.getTopLeft().floor(),p=n.getBottomRight().ceil(),g=new t0(p.subtract(x)),d=g.multiply(s);if(v.setSize(d,!0),!d.isZero()){var b=v.getContext(!0),P=new B0().scale(s).translate(x.negate());b.save(),P.applyToContext(b),this.draw(b,new L({matrices:[P]})),b.restore()}if(v._matrix.set(new B0().translate(x.add(g.divide(2))).scale(1/s)),h===V||h)v.insertAbove(this);return v},contains:function(){var i=this._matrix;return i.isInvertible()&&!!this._contains(i._inverseTransform(O.read(arguments)))},_contains:function(i){var t=this._children;if(t){for(var u=t.length-1;u>=0;u--)if(t[u].contains(i))return!0;return!1}return i.isInside(this.getInternalBounds())},isInside:function(){return m0.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new d0.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(i,t){if(!(i instanceof l0))return!1;return this._asPathItem().getIntersections(i._asPathItem(),null,t,!0).length>0}},new function(){function i(){var h=arguments;return this._hitTest(O.read(h),n0.getOptions(h))}function t(){var h=arguments,v=O.read(h),n=n0.getOptions(h),s=[];return this._hitTest(v,new L({all:s},n)),s}function u(h,v,n,s){var x=this._children;if(x)for(var p=x.length-1;p>=0;p--){var g=x[p],d=g!==s&&g._hitTest(h,v,n);if(d&&!v.all)return d}return null}return r6.inject({hitTest:i,hitTestAll:t,_hitTest:u}),{hitTest:i,hitTestAll:t,_hitTestChildren:u}},{_hitTest:function(i,t,u){if(this._locked||!this._visible||this._guide&&!t.guides||this.isEmpty())return null;var h=this._matrix,v=u?u.appended(h):this.getGlobalMatrix().prepend(this.getView()._matrix),n=Math.max(t.tolerance,0.000000000001),s=t._tolerancePadding=new t0(d0._getStrokePadding(n,h._shiftless().invert()));if(i=h._inverseTransform(i),!i||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(s.multiply(2))._containsPoint(i))return null;var x=!(t.guides&&!this._guide||t.selected&&!this.isSelected()||t.type&&t.type!==L.hyphenate(this._class)||t.class&&!(this instanceof t.class)),p=t.match,g=this,d,b;function P(w){if(w&&p&&!p(w))w=null;if(w&&t.all)t.all.push(w);return w}function l(w,S){var C=S?d["get"+S]():g.getPosition();if(i.subtract(C).divide(s).length<=1)return new n0(w,g,{name:S?L.hyphenate(S):w,point:C})}var{position:_,center:D,bounds:B}=t;if(x&&this._parent&&(_||D||B)){if(D||B)d=this.getInternalBounds();if(b=_&&l("position")||D&&l("center","Center"),!b&&B){var j=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var o=0;o<8&&!b;o++)b=l("bounds",j[o])}b=P(b)}if(!b)b=this._hitTestChildren(i,t,v)||x&&P(this._hitTestSelf(i,t,v,this.getStrokeScaling()?null:v._shiftless().invert()))||null;if(b&&b.point)b.point=h.transform(b.point);return b},_hitTestSelf:function(i,t){if(t.fill&&this.hasFill()&&this._contains(i))return new n0("fill",this)},matches:function(i,t){function u(s,x){for(var p in s)if(s.hasOwnProperty(p)){var g=s[p],d=x[p];if(L.isPlainObject(g)&&L.isPlainObject(d)){if(!u(g,d))return!1}else if(!L.equals(g,d))return!1}return!0}var h=typeof i;if(h==="object"){for(var v in i)if(i.hasOwnProperty(v)&&!this.matches(v,i[v]))return!1;return!0}else if(h==="function")return i(this);else if(i==="match")return t(this);else{var n=/^(empty|editable)$/.test(i)?this["is"+L.capitalize(i)]():i==="type"?L.hyphenate(this._class):this[i];if(i==="class"){if(typeof t==="function")return this instanceof t;n=this._class}if(typeof t==="function")return!!t(n);else if(t){if(t.test)return t.test(n);else if(L.isPlainObject(t))return u(t,n)}return L.equals(n,t)}},getItems:function(i){return l0._getItems(this,i,this._matrix)},getItem:function(i){return l0._getItems(this,i,this._matrix,null,!0)[0]||null},statics:{_getItems:function i(t,u,h,v,n){if(!v){var s=typeof u==="object"&&u,x=s&&s.overlapping,p=s&&s.inside,g=x||p,P=g&&m0.read([g]);if(v={items:[],recursive:s&&s.recursive!==!1,inside:!!p,overlapping:!!x,rect:P,path:x&&new d0.Rectangle({rectangle:P,insert:!1})},s)u=L.filter({},u,{recursive:!0,inside:!0,overlapping:!0})}var d=t._children,b=v.items,P=v.rect;h=P&&(h||new B0);for(var l=0,_=d&&d.length;l<_;l++){var D=d[l],B=h&&h.appended(D._matrix),j=!0;if(P){var g=D.getBounds(B);if(!P.intersects(g))continue;if(!(P.contains(g)||v.overlapping&&(g.contains(P)||v.path.intersects(D,B))))j=!1}if(j&&D.matches(u)){if(b.push(D),n)break}if(v.recursive!==!1)i(D,u,B,v,n);if(n&&b.length>0)break}return b}}},{importJSON:function(i){var t=L.importJSON(i,this);return t!==this?this.addChild(t):t},addChild:function(i){return this.insertChild(V,i)},insertChild:function(i,t){var u=t?this.insertChildren(i,[t]):null;return u&&u[0]},addChildren:function(i){return this.insertChildren(this._children.length,i)},insertChildren:function(i,t){var u=this._children;if(u&&t&&t.length>0){t=L.slice(t);var h={};for(var v=t.length-1;v>=0;v--){var n=t[v],s=n&&n._id;if(!n||h[s])t.splice(v,1);else n._remove(!1,!0),h[s]=!0}L.splice(u,t,i,0);var x=this._project,p=x._changes;for(var v=0,g=t.length;v<g;v++){var n=t[v],d=n._name;if(n._parent=this,n._setProject(x,!0),d)n.setName(d);if(p)n._changed(5)}this._changed(11)}else t=null;return t},_insertItem:"#insertChild",_insertAt:function(i,t){var u=i&&i._getOwner(),h=i!==this&&u?this:null;if(h)h._remove(!1,!0),u._insertItem(i._index+t,h);return h},insertAbove:function(i){return this._insertAt(i,1)},insertBelow:function(i){return this._insertAt(i,0)},sendToBack:function(){var i=this._getOwner();return i?i._insertItem(0,this):null},bringToFront:function(){var i=this._getOwner();return i?i._insertItem(V,this):null},appendTop:"#addChild",appendBottom:function(i){return this.insertChild(0,i)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(i){return i._insertItem(V,this)},copyTo:function(i){return this.clone(!1).addTo(i)},reduce:function(i){var t=this._children;if(t&&t.length===1){var u=t[0].reduce(i);if(this._parent)u.insertAbove(this),this.remove();else u.remove();return u}return this},_removeNamed:function(){var i=this._getOwner();if(i){var{_children:t,_namedChildren:u}=i,h=this._name,v=u[h],n=v?v.indexOf(this):-1;if(n!==-1){if(t[h]==this)delete t[h];if(v.splice(n,1),v.length)t[h]=v[0];else delete u[h]}}},_remove:function(i,t){var u=this._getOwner(),h=this._project,v=this._index;if(this._style)this._style._dispose();if(u){if(this._name)this._removeNamed();if(v!=null){if(h._activeLayer===this)h._activeLayer=this.getNextSibling()||this.getPreviousSibling();L.splice(u._children,null,v,1)}if(this._installEvents(!1),i&&h._changes)this._changed(5);if(t)u._changed(11,this);return this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(i){var t=i&&i.insertBelow(this);if(t)this.remove();return t},removeChildren:function(i,t){if(!this._children)return null;i=i||0,t=L.pick(t,this._children.length);var u=L.splice(this._children,null,i,t-i);for(var h=u.length-1;h>=0;h--)u[h]._remove(!0,!1);if(u.length>0)this._changed(11);return u},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var i=0,t=this._children.length;i<t;i++)this._children[i]._index=i;this._changed(11)}},isEmpty:function(i){var t=this._children,u=t?t.length:0;if(i){for(var h=0;h<u;h++)if(!t[h].isEmpty(i))return!1;return!0}return!u},isEditable:function(){var i=this;while(i){if(!i._visible||i._locked)return!1;i=i._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(i){function t(s){var x=[];do x.unshift(s);while(s=s._parent);return x}var u=t(this),h=t(i);for(var v=0,n=Math.min(u.length,h.length);v<n;v++)if(u[v]!=h[v])return u[v]._index<h[v]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(i){return this._getOrder(i)===-1},isBelow:function(i){return this._getOrder(i)===1},isParent:function(i){return this._parent===i},isChild:function(i){return i&&i._parent===this},isDescendant:function(i){var t=this;while(t=t._parent)if(t===i)return!0;return!1},isAncestor:function(i){return i?i.isDescendant(this):!1},isSibling:function(i){return this._parent===i._parent},isGroupedWith:function(i){var t=this._parent;while(t){if(t._parent&&/^(Group|Layer|CompoundPath)$/.test(t._class)&&i.isDescendant(t))return!0;t=t._parent}return!1}},L.each(["rotate","scale","shear","skew"],function(i){var t=i==="rotate";this[i]=function(){var u=arguments,h=(t?L:O).read(u),v=O.read(u,0,{readNull:!0});return this.transform(new B0()[i](h,v||this.getPosition(!0)))}},{translate:function(){var i=new B0;return this.transform(i.translate.apply(i,arguments))},transform:function(i,t,u){var h=this._matrix,v=i&&!i.isIdentity(),n=u&&this._canApplyMatrix||this._applyMatrix&&(v||!h.isIdentity()||t&&this._children);if(!v&&!n)return this;if(v){if(!i.isInvertible()&&h.isInvertible())h._backup=h.getValues();h.prepend(i,!0);var s=this._style,x=s.getFillColor(!0),p=s.getStrokeColor(!0);if(x)x.transform(i);if(p)p.transform(i)}if(n&&(n=this._transformContent(h,t,u))){var g=this._pivot;if(g)h._transformPoint(g,g,!0);if(h.reset(!0),u&&this._canApplyMatrix)this._applyMatrix=!0}var d=this._bounds,b=this._position;if(v||n)this._changed(25);var P=v&&d&&i.decompose();if(P&&P.skewing.isZero()&&P.rotation%90===0){for(var l in d){var _=d[l];if(_.nonscaling)delete d[l];else if(n||!_.internal){var D=_.rect;i._transformBounds(D,D)}}this._bounds=d;var B=d[this._getBoundsCacheKey(this._boundsOptions||{})];if(B)this._position=this._getPositionFromBounds(B.rect)}else if(v&&b&&this._pivot)this._position=i._transformPoint(b,b);return this},_transformContent:function(i,t,u){var h=this._children;if(h){for(var v=0,n=h.length;v<n;v++)h[v].transform(i,t,u);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(O.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(O.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(O.read(arguments))},localToParent:function(){return this._matrix._transformPoint(O.read(arguments))},fitBounds:function(i,t){i=m0.read(arguments);var u=this.getBounds(),h=u.height/u.width,v=i.height/i.width,n=(t?h>v:h<v)?i.width/u.width:i.height/u.height,s=new m0(new O,new t0(u.width*n,u.height*n));s.setCenter(i.getCenter()),this.setBounds(s)}}),{_setStyles:function(i,t,u){var h=this._style,v=this._matrix;if(h.hasFill())i.fillStyle=h.getFillColor().toCanvasStyle(i,v);if(h.hasStroke()){i.strokeStyle=h.getStrokeColor().toCanvasStyle(i,v),i.lineWidth=h.getStrokeWidth();var n=h.getStrokeJoin(),s=h.getStrokeCap(),x=h.getMiterLimit();if(n)i.lineJoin=n;if(s)i.lineCap=s;if(x)i.miterLimit=x;if(G0.support.nativeDash){var p=h.getDashArray(),g=h.getDashOffset();if(p&&p.length)if("setLineDash"in i)i.setLineDash(p),i.lineDashOffset=g;else i.mozDash=p,i.mozDashOffset=g}}if(h.hasShadow()){var d=t.pixelRatio||1,b=u._shiftless().prepend(new B0().scale(d,d)),P=b.transform(new O(h.getShadowBlur(),0)),l=b.transform(this.getShadowOffset());i.shadowColor=h.getShadowColor().toCanvasStyle(i),i.shadowBlur=P.getLength(),i.shadowOffsetX=l.x,i.shadowOffsetY=l.y}},draw:function(i,t,u){var h=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)return;var{matrices:v,viewMatrix:n}=t,s=this._matrix,x=v[v.length-1].appended(s);if(!x.isInvertible())return;if(n=n?n.appended(x):x,v.push(x),t.updateMatrix)this._globalMatrix=x;var p=this._blendMode,g=$.clamp(this._opacity,0,1),d=p==="normal",b=j4.nativeModes[p],P=d&&g===1||t.dontStart||t.clip||(b||d&&g<1)&&this._canComposite(),l=t.pixelRatio||1,_,D,B;if(!P){var j=this.getStrokeBounds(n);if(!j.width||!j.height){v.pop();return}if(B=t.offset,D=t.offset=j.getTopLeft().floor(),_=i,i=Z0.getContext(j.getSize().ceil().add(1).multiply(l)),l!==1)i.scale(l,l)}i.save();var o=u?u.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&n,w=!P&&t.clipItem,S=!o||w;if(P){if(i.globalAlpha=g,b)i.globalCompositeOperation=p}else if(S)i.translate(-D.x,-D.y);if(S)(P?s:n).applyToContext(i);if(w)t.clipItem.draw(i,t.extend({clip:!0}));if(o){i.setTransform(l,0,0,l,0,0);var C=t.offset;if(C)i.translate(-C.x,-C.y)}if(this._draw(i,t,n,o),i.restore(),v.pop(),t.clip&&!t.dontFinish)i.clip(this.getFillRule());if(!P)j4.process(p,i,_,g,D.subtract(B).multiply(l)),Z0.release(i),t.offset=B},_isUpdated:function(i){var t=this._parent;if(t instanceof T0)return t._isUpdated(i);var u=this._updateVersion===i;if(!u&&t&&t._visible&&t._isUpdated(i))this._updateVersion=i,u=!0;return u},_drawSelection:function(i,t,u,h,v){var n=this._selection,s=n&1,x=n&2||s&&this._selectBounds,p=n&4;if(!this._drawSelected)s=!1;if((s||x||p)&&this._isUpdated(v)){var g,d=this.getSelectedColor(!0)||(g=this.getLayer())&&g.getSelectedColor(!0),b=t.appended(this.getGlobalMatrix(!0)),P=u/2;if(i.strokeStyle=i.fillStyle=d?d.toCanvasStyle(i):"#009dec",s)this._drawSelected(i,b,h);if(p){var l=this.getPosition(!0),_=this._parent,D=_?_.localToGlobal(l):l,B=D.x,j=D.y;i.beginPath(),i.arc(B,j,P,0,Math.PI*2,!0),i.stroke();var o=[[0,-1],[1,0],[0,1],[-1,0]],w=P,S=u+1;for(var C=0;C<4;C++){var G=o[C],k=G[0],c=G[1];i.moveTo(B+k*w,j+c*w),i.lineTo(B+k*S,j+c*S),i.stroke()}}if(x){var N=b._transformCorners(this.getInternalBounds());i.beginPath();for(var C=0;C<8;C++)i[!C?"moveTo":"lineTo"](N[C],N[++C]);i.closePath(),i.stroke();for(var C=0;C<8;C++)i.fillRect(N[C]-P,N[++C]-P,u,u)}}},_canComposite:function(){return!1}},L.each(["down","drag","up","move"],function(i){this["removeOn"+L.capitalize(i)]=function(){var t={};return t[i]=!0,this.removeOn(t)}},{removeOn:function(i){for(var t in i)if(i[t]){var u="mouse"+t,h=this._project,v=h._removeSets=h._removeSets||{};v[u]=v[u]||{},v[u][this._id]=this}return this}}),{tween:function(i,t,u){if(!u){if(u=t,t=i,i=null,!u)u=t,t=null}var h=u&&u.easing,v=u&&u.start,n=u!=null&&(typeof u==="number"?u:u.duration),s=new y8(this,i,t,n,h,v);function x(p){if(s._handleFrame(p.time*1000),!s.running)this.off("frame",x)}if(n)this.on("frame",x);return s},tweenTo:function(i,t){return this.tween(null,i,t)},tweenFrom:function(i,t){return this.tween(i,null,t)}}),J0=l0.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function i(t){if(this._children=[],this._namedChildren={},!this._initialize(t))this.addChildren(Array.isArray(t)?t:arguments)},_changed:function i(t){if(i.base.call(this,t),t&2050)this._clipItem=V},_getClipItem:function(){var i=this._clipItem;if(i===V){i=null;var t=this._children;for(var u=0,h=t.length;u<h;u++)if(t[u]._clipMask){i=t[u];break}this._clipItem=i}return i},isClipped:function(){return!!this._getClipItem()},setClipped:function(i){var t=this.getFirstChild();if(t)t.setClipMask(i)},_getBounds:function i(t,u){var h=this._getClipItem();return h?h._getCachedBounds(h._matrix.prepended(t),L.set({},u,{stroke:!1})):i.base.call(this,t,u)},_hitTestChildren:function i(t,u,h){var v=this._getClipItem();return(!v||v.contains(t))&&i.base.call(this,t,u,h,v)},_draw:function(i,t){var u=t.clip,h=!u&&this._getClipItem();if(t=t.extend({clipItem:h,clip:!1}),u)i.beginPath(),t.dontStart=t.dontFinish=!0;else if(h)h.draw(i,t.extend({clip:!0}));var v=this._children;for(var n=0,s=v.length;n<s;n++){var x=v[n];if(x!==h)x.draw(i,t)}}}),b6=J0.extend({_class:"Layer",initialize:function i(){J0.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function i(){return this._parent?i.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),f0=l0.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function i(t,u){this._initialize(t,u)},_equals:function(i){return this._type===i._type&&this._size.equals(i._size)&&L.equals(this._radius,i._radius)},copyContent:function(i){this.setType(i._type),this.setSize(i._size),this.setRadius(i._radius)},getType:function(){return this._type},setType:function(i){this._type=i},getShape:"#getType",setShape:"#setType",getSize:function(){var i=this._size;return new X0(i.width,i.height,this,"setSize")},setSize:function(){var i=t0.read(arguments);if(!this._size)this._size=i.clone();else if(!this._size.equals(i)){var t=this._type,u=i.width,h=i.height;if(t==="rectangle")this._radius.set(t0.min(this._radius,i.divide(2).abs()));else if(t==="circle")u=h=(u+h)/2,this._radius=u/2;else if(t==="ellipse")this._radius._set(u/2,h/2);this._size._set(u,h),this._changed(9)}},getRadius:function(){var i=this._radius;return this._type==="circle"?i:new X0(i.width,i.height,this,"setRadius")},setRadius:function(i){var t=this._type;if(t==="circle"){if(i===this._radius)return;var u=i*2;this._radius=i,this._size._set(u,u)}else if(i=t0.read(arguments),!this._radius)this._radius=i.clone();else{if(this._radius.equals(i))return;if(this._radius.set(i),t==="rectangle"){var u=t0.max(this._size,i.multiply(2));this._size.set(u)}else if(t==="ellipse")this._size._set(i.width*2,i.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(i){var t=new d0[L.capitalize(this._type)]({center:new O,size:this._size,radius:this._radius,insert:!1});if(t.copyAttributes(this),G0.settings.applyMatrix)t.setApplyMatrix(!0);if(i===V||i)t.insertAbove(this);return t},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(i,t,u,h){var v=this._style,n=v.hasFill(),s=v.hasStroke(),x=t.dontFinish||t.clip,p=!h;if(n||s||x){var g=this._type,d=this._radius,b=g==="circle";if(!t.dontStart)i.beginPath();if(p&&b)i.arc(0,0,d,0,Math.PI*2,!0);else{var P=b?d:d.width,l=b?d:d.height,_=this._size,D=_.width,B=_.height;if(p&&g==="rectangle"&&P===0&&l===0)i.rect(-D/2,-B/2,D,B);else{var j=D/2,o=B/2,w=0.44771525016920644,S=P*w,C=l*w,G=[-j,-o+l,-j,-o+C,-j+S,-o,-j+P,-o,j-P,-o,j-S,-o,j,-o+C,j,-o+l,j,o-l,j,o-C,j-S,o,j-P,o,-j+P,o,-j+S,o,-j,o-C,-j,o-l];if(h)h.transform(G,G,32);if(i.moveTo(G[0],G[1]),i.bezierCurveTo(G[2],G[3],G[4],G[5],G[6],G[7]),j!==P)i.lineTo(G[8],G[9]);if(i.bezierCurveTo(G[10],G[11],G[12],G[13],G[14],G[15]),o!==l)i.lineTo(G[16],G[17]);if(i.bezierCurveTo(G[18],G[19],G[20],G[21],G[22],G[23]),j!==P)i.lineTo(G[24],G[25]);i.bezierCurveTo(G[26],G[27],G[28],G[29],G[30],G[31])}}i.closePath()}if(!x&&(n||s)){if(this._setStyles(i,t,u),n)i.fill(v.getFillRule()),i.shadowColor="rgba(0,0,0,0)";if(s)i.stroke()}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(i,t){var u=new m0(this._size).setCenter(0,0),h=this._style,v=t.stroke&&h.hasStroke()&&h.getStrokeWidth();if(i)u=i._transformBounds(u);return v?u.expand(d0._getStrokePadding(v,this._getStrokeMatrix(i,t))):u}},new function(){function i(u,h,v){var n=u._radius;if(!n.isZero()){var s=u._size.divide(2);for(var x=1;x<=4;x++){var p=new O(x>1&&x<4?-1:1,x>2?-1:1),g=p.multiply(s),d=g.subtract(p.multiply(n)),b=new m0(v?g.add(p.multiply(v)):g,d);if(b.contains(h))return{point:d,quadrant:x}}}}function t(u,h,v,n){var s=u.divide(h);return(!n||s.isInQuadrant(n))&&s.subtract(s.normalize()).multiply(h).divide(v).length<=1}return{_contains:function u(h){if(this._type==="rectangle"){var v=i(this,h);return v?h.subtract(v.point).divide(this._radius).getLength()<=1:u.base.call(this,h)}else return h.divide(this.size).getLength()<=0.5},_hitTestSelf:function u(h,v,n,s){var x=!1,p=this._style,g=v.stroke&&p.hasStroke(),d=v.fill&&p.hasFill();if(g||d){var b=this._type,P=this._radius,l=g?p.getStrokeWidth()/2:0,_=v._tolerancePadding.add(d0._getStrokePadding(l,!p.getStrokeScaling()&&s));if(b==="rectangle"){var D=_.multiply(2),B=i(this,h,D);if(B)x=t(h.subtract(B.point),P,_,B.quadrant);else{var j=new m0(this._size).setCenter(0,0),o=j.expand(D),w=j.expand(D.negate());x=o._containsPoint(h)&&!w._containsPoint(h)}}else x=t(h,P,_)}return x?new n0(g?"stroke":"fill",this):u.base.apply(this,arguments)}}},{statics:new function(){function i(t,u,h,v,n){var s=L.create(f0.prototype);return s._type=t,s._size=h,s._radius=v,s._initialize(L.getNamed(n),u),s}return{Circle:function(){var t=arguments,u=O.readNamed(t,"center"),h=L.readNamed(t,"radius");return i("circle",u,new t0(h*2),h,t)},Rectangle:function(){var t=arguments,u=m0.readNamed(t,"rectangle"),h=t0.min(t0.readNamed(t,"radius"),u.getSize(!0).divide(2));return i("rectangle",u.getCenter(!0),u.getSize(!0),h,t)},Ellipse:function(){var t=arguments,u=f0._readEllipse(t),h=u.radius;return i("ellipse",u.center,h.multiply(2),h,t)},_readEllipse:function(t){var u,h;if(L.hasNamed(t,"radius"))u=O.readNamed(t,"center"),h=t0.readNamed(t,"radius");else{var v=m0.readNamed(t,"rectangle");u=v.getCenter(!0),h=v.getSize(!0).divide(2)}return{center:u,radius:h}}}}}),i0=l0.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function i(t,u){if(!this._initialize(t,u!==V&&O.read(arguments))){var h,v=typeof t,n=v==="string"?F.getElementById(t):v==="object"?t:null;if(n&&n!==l0.NO_INSERT){if(n.getContext||n.naturalHeight!=null)h=n;else if(n){var s=t0.read(arguments);if(!s.isZero())h=Z0.getCanvas(s)}}if(h)this.setImage(h);else this.setSource(t)}if(!this._size)this._size=new t0,this._loaded=!1},_equals:function(i){return this.getSource()===i.getSource()},copyContent:function(i){var{_image:t,_canvas:u}=i;if(t)this._setImage(t);else if(u){var h=Z0.getCanvas(i._size);h.getContext("2d").drawImage(u,0,0),this._setImage(h)}this._crossOrigin=i._crossOrigin},getSize:function(){var i=this._size;return new X0(i?i.width:0,i?i.height:0,this,"setSize")},setSize:function(i,t){var u=t0.read(arguments);if(!u.equals(this._size))if(u.width>0&&u.height>0){var h=!t&&this.getElement();if(this._setImage(Z0.getCanvas(u)),h)this.getContext(!0).drawImage(h,0,0,u.width,u.height)}else{if(this._canvas)Z0.release(this._canvas);this._size=u.clone()}else if(t)this.clear()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(i){this.setSize(i,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(i){this.setSize(this.getWidth(),i)},getLoaded:function(){return this._loaded},isEmpty:function(){var i=this._size;return!i||i.width===0&&i.height===0},getResolution:function(){var i=this._matrix,t=new O(0,0).transform(i),u=new O(1,0).transform(i).subtract(t),h=new O(0,1).transform(i).subtract(t);return new t0(72/u.getLength(),72/h.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(i){var t=this;function u(h){var v=t.getView(),n=h&&h.type||"load";if(v&&t.responds(n))G0=v._scope,t.emit(n,new B6(h))}if(this._setImage(i),this._loaded)setTimeout(u,0);else if(i)V0.add(i,{load:function(h){t._setImage(i),u(h)},error:u})},_setImage:function(i){if(this._canvas)Z0.release(this._canvas);if(i&&i.getContext)this._image=null,this._canvas=i,this._loaded=!0;else this._image=i,this._canvas=null,this._loaded=!!(i&&i.src&&i.complete);this._size=new t0(i?i.naturalWidth||i.width:0,i?i.naturalHeight||i.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var i=Z0.getContext(this._size);try{if(this._image)i.drawImage(this._image,0,0);this._canvas=i.canvas}catch(t){Z0.release(i)}}return this._canvas},setCanvas:"#setImage",getContext:function(i){if(!this._context)this._context=this.getCanvas().getContext("2d");if(i)this._image=null,this._changed(1025);return this._context},setContext:function(i){this._context=i},getSource:function(){var i=this._image;return i&&i.src||this.toDataURL()},setSource:function(i){var t=new E.Image,u=this._crossOrigin;if(u)t.crossOrigin=u;if(i)t.src=i;this.setImage(t)},getCrossOrigin:function(){var i=this._image;return i&&i.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(i){this._crossOrigin=i;var t=this._image;if(t)t.crossOrigin=i},getSmoothing:function(){return this._smoothing},setSmoothing:function(i){this._smoothing=typeof i==="string"?i:i?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var i=m0.read(arguments),t=Z0.getContext(i.getSize());return t.drawImage(this.getCanvas(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),t.canvas},getSubRaster:function(){var i=m0.read(arguments),t=new i0(l0.NO_INSERT);return t._setImage(this.getSubCanvas(i)),t.translate(i.getCenter().subtract(this.getSize().divide(2))),t._matrix.prepend(this._matrix),t.insertAbove(this),t},toDataURL:function(){var i=this._image,t=i&&i.src;if(/^data:/.test(t))return t;var u=this.getCanvas();return u?u.toDataURL.apply(u,arguments):null},drawImage:function(i){var t=O.read(arguments,1);this.getContext(!0).drawImage(i,t.x,t.y)},getAverageColor:function(i){var t,u;if(!i)t=this.getBounds();else if(i instanceof i6)u=i,t=i.getBounds();else if(typeof i==="object"){if("width"in i)t=new m0(i);else if("x"in i)t=new m0(i.x-0.5,i.y-0.5,1,1)}if(!t)return null;var h=32,v=Math.min(t.width,h),n=Math.min(t.height,h),s=i0._sampleContext;if(!s)s=i0._sampleContext=Z0.getContext(new t0(h));else s.clearRect(0,0,h+1,h+1);s.save();var x=new B0().scale(v/t.width,n/t.height).translate(-t.x,-t.y);if(x.applyToContext(s),u)u.draw(s,new L({clip:!0,matrices:[x]}));this._matrix.applyToContext(s);var p=this.getElement(),g=this._size;if(p)s.drawImage(p,-g.width/2,-g.height/2);s.restore();var d=s.getImageData(0.5,0.5,Math.ceil(v),Math.ceil(n)).data,b=[0,0,0],P=0;for(var l=0,_=d.length;l<_;l+=4){var D=d[l+3];P+=D,D/=255,b[0]+=d[l]*D,b[1]+=d[l+1]*D,b[2]+=d[l+2]*D}for(var l=0;l<3;l++)b[l]/=P;return P?U.read(b):null},getPixel:function(){var i=O.read(arguments),t=this.getContext().getImageData(i.x,i.y,1,1).data;return new U("rgb",[t[0]/255,t[1]/255,t[2]/255],t[3]/255)},setPixel:function(){var i=arguments,t=O.read(i),u=U.read(i),h=u._convert("rgb"),v=u._alpha,n=this.getContext(!0),s=n.createImageData(1,1),x=s.data;x[0]=h[0]*255,x[1]=h[1]*255,x[2]=h[2]*255,x[3]=v!=null?v*255:255,n.putImageData(s,t.x,t.y)},clear:function(){var i=this._size;this.getContext(!0).clearRect(0,0,i.width+1,i.height+1)},createImageData:function(){var i=t0.read(arguments);return this.getContext().createImageData(i.width,i.height)},getImageData:function(){var i=m0.read(arguments);if(i.isEmpty())i=new m0(this._size);return this.getContext().getImageData(i.x,i.y,i.width,i.height)},putImageData:function(i){var t=O.read(arguments,1);this.getContext(!0).putImageData(i,t.x,t.y)},setImageData:function(i){this.setSize(i),this.getContext(!0).putImageData(i,0,0)},_getBounds:function(i,t){var u=new m0(this._size).setCenter(0,0);return i?i._transformBounds(u):u},_hitTestSelf:function(i){if(this._contains(i)){var t=this;return new n0("pixel",t,{offset:i.add(t._size.divide(2)).round(),color:{get:function(){return t.getPixel(this.offset)}}})}},_draw:function(i,t,u){var h=this.getElement();if(h&&h.width>0&&h.height>0){i.globalAlpha=$.clamp(this._opacity,0,1),this._setStyles(i,t,u);var v=this._smoothing,n=v==="off";N0.setPrefixed(i,n?"imageSmoothingEnabled":"imageSmoothingQuality",n?!1:v),i.drawImage(h,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),u0=l0.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function i(t,u){if(!this._initialize(t,u!==V&&O.read(arguments,1)))this.setDefinition(t instanceof Z?t:new Z(t))},_equals:function(i){return this._definition===i._definition},copyContent:function(i){this.setDefinition(i._definition)},getDefinition:function(){return this._definition},setDefinition:function(i){this._definition=i,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(i,t){var u=this._definition._item;return u._getCachedBounds(u._matrix.prepended(i),t)},_hitTestSelf:function(i,t,u){var h=t.extend({all:!1}),v=this._definition._item._hitTest(i,h,u);if(v)v.item=this;return v},_draw:function(i,t){this._definition._item.draw(i,t)}}),Z=L.extend({_class:"SymbolDefinition",initialize:function i(t,u){if(this._id=r0.get(),this.project=G0.project,t)this.setItem(t,u)},_serialize:function(i,t){return t.add(this,function(){return L.serialize([this._class,this._item],i,!1,t)})},_changed:function(i){if(i&8)l0._clearBoundsCache(this);if(i&1)this.project._changed(i)},getItem:function(){return this._item},setItem:function(i,t){if(i._symbol)i=i.clone();if(this._item)this._item._symbol=null;if(this._item=i,i.remove(),i.setSelected(!1),!t)i.setPosition(new O);i._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(i){return new u0(this,i)},clone:function(){return new Z(this._item.clone(!1))},equals:function(i){return i===this||i&&this._item.equals(i._item)||!1}}),n0=L.extend({_class:"HitResult",initialize:function i(t,u,h){if(this.type=t,this.item=u,h)this.inject(h)},statics:{getOptions:function(i){var t=i&&L.read(i);return new L({type:null,tolerance:G0.settings.hitTolerance,fill:!t,stroke:!t,segments:!t,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},t)}}}),J=L.extend({_class:"Segment",beans:!0,_selection:0,initialize:function i(t,u,h,v,n,s){var x=arguments.length,p,g,d,b;if(x>0)if(t==null||typeof t==="object")if(x===1&&t&&"point"in t)p=t.point,g=t.handleIn,d=t.handleOut,b=t.selection;else p=t,g=u,d=h,b=v;else p=[t,u],g=h!==V?[h,v]:null,d=n!==V?[n,s]:null;if(new I0(p,this,"_point"),new I0(g,this,"_handleIn"),new I0(d,this,"_handleOut"),b)this.setSelection(b)},_serialize:function(i,t){var u=this._point,h=this._selection,v=h||this.hasHandles()?[u,this._handleIn,this._handleOut]:u;if(h)v.push(h);return L.serialize(v,i,!0,t)},_changed:function(i){var t=this._path;if(!t)return;var u=t._curves,h=this._index,v;if(u){if((!i||i===this._point||i===this._handleIn)&&(v=h>0?u[h-1]:t._closed?u[u.length-1]:null))v._changed();if((!i||i===this._point||i===this._handleOut)&&(v=u[h]))v._changed()}t._changed(41)},getPoint:function(){return this._point},setPoint:function(){this._point.set(O.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(O.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(O.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var i=this._handleIn,t=this._handleOut;return!i.isZero()&&!t.isZero()&&i.isCollinear(t)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(i){var t=this._selection,u=this._path;if(this._selection=i=i||0,u&&i!==t)u._updateSelection(this,t,i),u._changed(257)},_changeSelection:function(i,t){var u=this._selection;this.setSelection(t?u|i:u&~i)},isSelected:function(){return!!(this._selection&7)},setSelected:function(i){this._changeSelection(7,i)},getIndex:function(){return this._index!==V?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var i=this._path,t=this._index;if(i){if(t>0&&!i._closed&&t===i._segments.length-1)t--;return i.getCurves()[t]||null}return null},getLocation:function(){var i=this.getCurve();return i?new e0(i,this===i._segment1?0:1):null},getNext:function(){var i=this._path&&this._path._segments;return i&&(i[this._index+1]||this._path._closed&&i[0])||null},smooth:function(i,t,u){var h=i||{},v=h.type,n=h.factor,s=this.getPrevious(),x=this.getNext(),p=(s||this)._point,g=this._point,d=(x||this)._point,b=p.getDistance(g),P=g.getDistance(d);if(!v||v==="catmull-rom"){var l=n===V?0.5:n,_=Math.pow(b,l),D=_*_,B=Math.pow(P,l),j=B*B;if(!t&&s){var o=2*j+3*B*_+D,w=3*B*(B+_);this.setHandleIn(w!==0?new O((j*p._x+o*g._x-D*d._x)/w-g._x,(j*p._y+o*g._y-D*d._y)/w-g._y):new O)}if(!u&&x){var o=2*D+3*_*B+j,w=3*_*(_+B);this.setHandleOut(w!==0?new O((D*d._x+o*g._x-j*p._x)/w-g._x,(D*d._y+o*g._y-j*p._y)/w-g._y):new O)}}else if(v==="geometric"){if(s&&x){var S=p.subtract(d),C=n===V?0.4:n,G=C*b/(b+P);if(!t)this.setHandleIn(S.multiply(G));if(!u)this.setHandleOut(S.multiply(G-C))}}else throw new Error("Smoothing method \'"+v+"\' not supported.")},getPrevious:function(){var i=this._path&&this._path._segments;return i&&(i[this._index-1]||this._path._closed&&i[i.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var i=this._path;return i&&this._index===i._segments.length-1||!1},reverse:function(){var i=this._handleIn,t=this._handleOut,u=i.clone();i.set(t),t.set(u)},reversed:function(){return new J(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new J(this._point,this._handleIn,this._handleOut)},equals:function(i){return i===this||i&&this._class===i._class&&this._point.equals(i._point)&&this._handleIn.equals(i._handleIn)&&this._handleOut.equals(i._handleOut)||!1},toString:function(){var i=["point: "+this._point];if(!this._handleIn.isZero())i.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())i.push("handleOut: "+this._handleOut);return"{ "+i.join(", ")+" }"},transform:function(i){this._transformCoordinates(i,new Array(6),!0),this._changed()},interpolate:function(i,t,u){var h=1-u,v=u,n=i._point,s=t._point,x=i._handleIn,p=t._handleIn,g=t._handleOut,d=i._handleOut;this._point._set(h*n._x+v*s._x,h*n._y+v*s._y,!0),this._handleIn._set(h*x._x+v*p._x,h*x._y+v*p._y,!0),this._handleOut._set(h*d._x+v*g._x,h*d._y+v*g._y,!0),this._changed()},_transformCoordinates:function(i,t,u){var h=this._point,v=!u||!this._handleIn.isZero()?this._handleIn:null,n=!u||!this._handleOut.isZero()?this._handleOut:null,s=h._x,x=h._y,p=2;if(t[0]=s,t[1]=x,v)t[p++]=v._x+s,t[p++]=v._y+x;if(n)t[p++]=n._x+s,t[p++]=n._y+x;if(i)if(i._transformCoordinates(t,t,p/2),s=t[0],x=t[1],u){if(h._x=s,h._y=x,p=2,v)v._x=t[p++]-s,v._y=t[p++]-x;if(n)n._x=t[p++]-s,n._y=t[p++]-x}else{if(!v)t[p++]=s,t[p++]=x;if(!n)t[p++]=s,t[p++]=x}return t}}),I0=O.extend({initialize:function i(t,u,h){var v,n,s;if(!t)v=n=0;else if((v=t[0])!==V)n=t[1];else{var x=t;if((v=x.x)===V)x=O.read(arguments),v=x.x;n=x.y,s=x.selected}if(this._x=v,this._y=n,this._owner=u,u[h]=this,s)this.setSelected(!0)},_set:function(i,t){return this._x=i,this._y=t,this._owner._changed(this),this},getX:function(){return this._x},setX:function(i){this._x=i,this._owner._changed(this)},getY:function(){return this._y},setY:function(i){this._y=i,this._owner._changed(this)},isZero:function(){var i=$.isZero;return i(this._x)&&i(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(i){this._owner._changeSelection(this._getSelection(),i)},_getSelection:function(){var i=this._owner;return this===i._point?1:this===i._handleIn?2:this===i._handleOut?4:0}}),W=L.extend({_class:"Curve",beans:!0,initialize:function i(t,u,h,v,n,s,x,p){var g=arguments.length,d,b,P,l,_,D;if(g===3)this._path=t,d=u,b=h;else if(!g)d=new J,b=new J;else if(g===1){if("segment1"in t)d=new J(t.segment1),b=new J(t.segment2);else if("point1"in t)P=t.point1,_=t.handle1,D=t.handle2,l=t.point2;else if(Array.isArray(t))P=[t[0],t[1]],l=[t[6],t[7]],_=[t[2]-t[0],t[3]-t[1]],D=[t[4]-t[6],t[5]-t[7]]}else if(g===2)d=new J(t),b=new J(u);else if(g===4)P=t,_=u,D=h,l=v;else if(g===8)P=[t,u],l=[x,p],_=[h-t,v-u],D=[n-x,s-p];this._segment1=d||new J(P,null,_),this._segment2=b||new J(l,D,null)},_serialize:function(i,t){return L.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],i,!0,t)},_changed:function(){this._length=this._bounds=V},clone:function(){return new W(this._segment1,this._segment2)},toString:function(){var i=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())i.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())i.push("handle2: "+this._segment2._handleIn);return i.push("point2: "+this._segment2._point),"{ "+i.join(", ")+" }"},classify:function(){return W.classify(this.getValues())},remove:function(){var i=!1;if(this._path){var t=this._segment2,u=t._handleOut;if(i=t.remove(),i)this._segment1._handleOut.set(u)}return i},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(O.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(O.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(O.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(O.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var i=this._path&&this._path._curves;return i&&(i[this._segment1._index+1]||this._path._closed&&i[0])||null},getPrevious:function(){var i=this._path&&this._path._curves;return i&&(i[this._segment1._index-1]||this._path._closed&&i[i.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var i=this._path;return i&&this._segment1._index===i._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(i){this.getPoint1().setSelected(i),this.getHandle1().setSelected(i),this.getHandle2().setSelected(i),this.getPoint2().setSelected(i)},getValues:function(i){return W.getValues(this._segment1,this._segment2,i)},getPoints:function(){var i=this.getValues(),t=[];for(var u=0;u<8;u+=2)t.push(new O(i[u],i[u+1]));return t}},{getLength:function(){if(this._length==null)this._length=W.getLength(this.getValues(),0,1);return this._length},getArea:function(){return W.getArea(this.getValues())},getLine:function(){return new Y0(this._segment1._point,this._segment2._point)},getPart:function(i,t){return new W(W.getPart(this.getValues(),i,t))},getPartLength:function(i,t){return W.getLength(this.getValues(),i,t)},divideAt:function(i){return this.divideAtTime(i&&i.curve===this?i.time:this.getTimeAt(i))},divideAtTime:function(i,t){var u=0.00000001,h=1-u,v=null;if(i>=u&&i<=h){var n=W.subdivide(this.getValues(),i),s=n[0],x=n[1],p=t||this.hasHandles(),g=this._segment1,d=this._segment2,b=this._path;if(p)g._handleOut._set(s[2]-s[0],s[3]-s[1]),d._handleIn._set(x[4]-x[6],x[5]-x[7]);var P=s[6],l=s[7],_=new J(new O(P,l),p&&new O(s[4]-P,s[5]-l),p&&new O(x[2]-P,x[3]-l));if(b)b.insert(g._index+1,_),v=this.getNext();else this._segment2=_,this._changed(),v=new W(_,d)}return v},splitAt:function(i){var t=this._path;return t?t.splitAt(i):null},splitAtTime:function(i){return this.splitAt(this.getLocationAtTime(i))},divide:function(i,t){return this.divideAtTime(i===V?0.5:t?i:this.getTimeAt(i))},split:function(i,t){return this.splitAtTime(i===V?0.5:t?i:this.getTimeAt(i))},reversed:function(){return new W(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(i,t,u,h){var{_point:v,_handleOut:n}=i,s=t._handleIn,x=t._point,p=v.x,g=v.y,d=x.x,b=x.y,P=h?[p,g,p,g,d,b,d,b]:[p,g,p+n._x,g+n._y,d+s._x,b+s._y,d,b];if(u)u._transformCoordinates(P,P,4);return P},subdivide:function(i,t){var u=i[0],h=i[1],v=i[2],n=i[3],s=i[4],x=i[5],p=i[6],g=i[7];if(t===V)t=0.5;var d=1-t,b=d*u+t*v,P=d*h+t*n,l=d*v+t*s,_=d*n+t*x,D=d*s+t*p,B=d*x+t*g,j=d*b+t*l,o=d*P+t*_,w=d*l+t*D,S=d*_+t*B,C=d*j+t*w,G=d*o+t*S;return[[u,h,b,P,j,o,C,G],[C,G,w,S,D,B,p,g]]},getMonoCurves:function(i,t){var u=[],h=t?0:1,v=i[h+0],n=i[h+2],s=i[h+4],x=i[h+6];if(v>=n===n>=s&&n>=s===s>=x||W.isStraight(i))u.push(i);else{var p=3*(n-s)-v+x,g=2*(v+s)-4*n,d=n-v,b=0.00000001,P=1-b,l=[],_=$.solveQuadratic(p,g,d,l,b,P);if(!_)u.push(i);else{l.sort();var D=l[0],B=W.subdivide(i,D);if(u.push(B[0]),_>1)D=(l[1]-D)/(1-D),B=W.subdivide(B[1],D),u.push(B[0]);u.push(B[1])}}return u},solveCubic:function(i,t,u,h,v,n){var s=i[t],x=i[t+2],p=i[t+4],g=i[t+6],d=0;if(!(s<u&&g<u&&x<u&&p<u||s>u&&g>u&&x>u&&p>u)){var b=3*(x-s),P=3*(p-x)-b,l=g-s-b-P;d=$.solveCubic(l,P,b,s-u,h,v,n)}return d},getTimeOf:function(i,t){var u=new O(i[0],i[1]),h=new O(i[6],i[7]),v=0.000000000001,n=0.0000001,s=t.isClose(u,v)?0:t.isClose(h,v)?1:null;if(s===null){var x=[t.x,t.y],p=[];for(var g=0;g<2;g++){var d=W.solveCubic(i,g,x[g],p,0,1);for(var b=0;b<d;b++){var P=p[b];if(t.isClose(W.getPoint(i,P),n))return P}}}return t.isClose(u,n)?0:t.isClose(h,n)?1:null},getNearestTime:function(i,t){if(W.isStraight(i)){var u=i[0],h=i[1],v=i[6],n=i[7],s=v-u,x=n-h,p=s*s+x*x;if(p===0)return 0;var g=((t.x-u)*s+(t.y-h)*x)/p;return g<0.000000000001?0:g>0.999999999999?1:W.getTimeOf(i,new O(u+g*s,h+g*x))}var d=100,b=Infinity,P=0;function l(B){if(B>=0&&B<=1){var j=t.getDistance(W.getPoint(i,B),!0);if(j<b)return b=j,P=B,!0}}for(var _=0;_<=d;_++)l(_/d);var D=1/(d*2);while(D>0.00000001)if(!l(P-D)&&!l(P+D))D/=2;return P},getPart:function(i,t,u){var h=t>u;if(h){var v=t;t=u,u=v}if(t>0)i=W.subdivide(i,t)[1];if(u<1)i=W.subdivide(i,(u-t)/(1-t))[0];return h?[i[6],i[7],i[4],i[5],i[2],i[3],i[0],i[1]]:i},isFlatEnough:function(i,t){var u=i[0],h=i[1],v=i[2],n=i[3],s=i[4],x=i[5],p=i[6],g=i[7],d=3*v-2*u-p,b=3*n-2*h-g,P=3*s-2*p-u,l=3*x-2*g-h;return Math.max(d*d,P*P)+Math.max(b*b,l*l)<=16*t*t},getArea:function(i){var t=i[0],u=i[1],h=i[2],v=i[3],n=i[4],s=i[5],x=i[6],p=i[7];return 3*((p-u)*(h+n)-(x-t)*(v+s)+v*(t-n)-h*(u-s)+p*(n+t/3)-x*(s+u/3))/20},getBounds:function(i){var t=i.slice(0,2),u=t.slice(),h=[0,0];for(var v=0;v<2;v++)W._addBounds(i[v],i[v+2],i[v+4],i[v+6],v,0,t,u,h);return new m0(t[0],t[1],u[0]-t[0],u[1]-t[1])},_addBounds:function(i,t,u,h,v,n,s,x,p){function g(C,G){var k=C-G,c=C+G;if(k<s[v])s[v]=k;if(c>x[v])x[v]=c}n/=2;var d=s[v]+n,b=x[v]-n;if(i<d||t<d||u<d||h<d||i>b||t>b||u>b||h>b)if(t<i!=t<h&&u<i!=u<h)g(i,0),g(h,0);else{var P=3*(t-u)-i+h,l=2*(i+u)-4*t,_=t-i,D=$.solveQuadratic(P,l,_,p),B=0.00000001,j=1-B;g(h,0);for(var o=0;o<D;o++){var w=p[o],S=1-w;if(B<=w&&w<=j)g(S*S*S*i+3*S*S*w*t+3*S*w*w*u+w*w*w*h,n)}}}}},L.each(["getBounds","getStrokeBounds","getHandleBounds"],function(i){this[i]=function(){if(!this._bounds)this._bounds={};var t=this._bounds[i];if(!t)t=this._bounds[i]=d0[i]([this._segment1,this._segment2],!1,this._path);return t.clone()}},{}),L.each({isStraight:function(i,t,u,h){if(t.isZero()&&u.isZero())return!0;else{var v=h.subtract(i);if(v.isZero())return!1;else if(v.isCollinear(t)&&v.isCollinear(u)){var n=new Y0(i,h),s=0.0000001;if(n.getDistance(i.add(t))<s&&n.getDistance(h.add(u))<s){var x=v.dot(v),p=v.dot(t)/x,g=v.dot(u)/x;return p>=0&&p<=1&&g<=0&&g>=-1}}}return!1},isLinear:function(i,t,u,h){var v=h.subtract(i).divide(3);return t.equals(v)&&u.negate().equals(v)}},function(i,t){this[t]=function(u){var h=this._segment1,v=this._segment2;return i(h._point,h._handleOut,v._handleIn,v._point,u)},this.statics[t]=function(u,h){var v=u[0],n=u[1],s=u[6],x=u[7];return i(new O(v,n),new O(u[2]-v,u[3]-n),new O(u[4]-s,u[5]-x),new O(s,x),h)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(i){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(i||0)},isCollinear:function(i){return i&&this.isStraight()&&i.isStraight()&&this.getLine().isCollinear(i.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<0.00000001},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<0.00000001}}),{beans:!1,getLocationAt:function(i,t){return this.getLocationAtTime(t?i:this.getTimeAt(i))},getLocationAtTime:function(i){return i!=null&&i>=0&&i<=1?new e0(this,i):null},getTimeAt:function(i,t){return W.getTimeAt(this.getValues(),i,t)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var i=O.read(arguments);return i.isZero()?[]:W.getTimesWithTangent(this.getValues(),i)},getOffsetAtTime:function(i){return this.getPartLength(0,i)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(O.read(arguments)))},getOffsetOf:function(){var i=this.getLocationOf.apply(this,arguments);return i?i.getOffset():null},getTimeOf:function(){return W.getTimeOf(this.getValues(),O.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var i=O.read(arguments),t=this.getValues(),u=W.getNearestTime(t,i),h=W.getPoint(t,u);return new e0(this,u,h,null,i.getDistance(h))},getNearestPoint:function(){var i=this.getNearestLocation.apply(this,arguments);return i?i.getPoint():i}},new function(){var i=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return L.each(i,function(t){this[t+"At"]=function(u,h){var v=this.getValues();return W[t](v,h?u:W.getTimeAt(v,u))},this[t+"AtTime"]=function(u){return W[t](this.getValues(),u)}},{statics:{_evaluateMethods:i}})},new function(){function i(h){var v=h[0],n=h[1],s=h[2],x=h[3],p=h[4],g=h[5],d=h[6],b=h[7],P=9*(s-p)+3*(d-v),l=6*(v+p)-12*s,_=3*(s-v),D=9*(x-g)+3*(b-n),B=6*(n+g)-12*x,j=3*(x-n);return function(o){var w=(P*o+l)*o+_,S=(D*o+B)*o+j;return Math.sqrt(w*w+S*S)}}function t(h,v){return Math.max(2,Math.min(16,Math.ceil(Math.abs(v-h)*32)))}function u(h,v,n,s){if(v==null||v<0||v>1)return null;var x=h[0],p=h[1],g=h[2],d=h[3],b=h[4],P=h[5],l=h[6],_=h[7],D=$.isZero;if(D(g-x)&&D(d-p))g=x,d=p;if(D(b-l)&&D(P-_))b=l,P=_;var B=3*(g-x),j=3*(b-g)-B,o=l-x-B-j,w=3*(d-p),S=3*(P-d)-w,C=_-p-w-S,G,k;if(n===0)G=v===0?x:v===1?l:((o*v+j)*v+B)*v+x,k=v===0?p:v===1?_:((C*v+S)*v+w)*v+p;else{var c=0.00000001,N=1-c;if(v<c)G=B,k=w;else if(v>N)G=3*(l-b),k=3*(_-P);else G=(3*o*v+2*j)*v+B,k=(3*C*v+2*S)*v+w;if(s){if(G===0&&k===0&&(v<c||v>N))G=b-g,k=P-d;var M=Math.sqrt(G*G+k*k);if(M)G/=M,k/=M}if(n===3){var b=6*o*v+2*j,P=6*C*v+2*S,R=Math.pow(G*G+k*k,1.5);G=R!==0?(G*P-k*b)/R:0,k=0}}return n===2?new O(k,-G):new O(G,k)}return{statics:{classify:function(h){var v=h[0],n=h[1],s=h[2],x=h[3],p=h[4],g=h[5],d=h[6],b=h[7],P=v*(b-g)+n*(p-d)+d*g-b*p,l=s*(n-b)+x*(d-v)+v*b-n*d,_=p*(x-n)+g*(v-s)+s*n-x*v,D=3*_,B=D-l,j=B-l+P,o=Math.sqrt(j*j+B*B+D*D),w=o!==0?1/o:0,S=$.isZero,C="serpentine";j*=w,B*=w,D*=w;function G(M,R,q){var z=R!==V,a=z&&R>0&&R<1,A=z&&q>0&&q<1;if(z&&(!(a||A)||M==="loop"&&!(a&&A)))M="arch",a=A=!1;return{type:M,roots:a||A?a&&A?R<q?[R,q]:[q,R]:[a?R:q]:null}}if(S(j))return S(B)?G(S(D)?"line":"quadratic"):G(C,D/(3*B));var k=3*B*B-4*j*D;if(S(k))return G("cusp",B/(2*j));var c=k>0?Math.sqrt(k/3):Math.sqrt(-k),N=2*j;return G(k>0?C:"loop",(B+c)/N,(B-c)/N)},getLength:function(h,v,n,s){if(v===V)v=0;if(n===V)n=1;if(W.isStraight(h)){var x=h;if(n<1)x=W.subdivide(x,n)[0],v/=n;if(v>0)x=W.subdivide(x,v)[1];var p=x[6]-x[0],g=x[7]-x[1];return Math.sqrt(p*p+g*g)}return $.integrate(s||i(h),v,n,t(v,n))},getTimeAt:function(h,v,n){if(n===V)n=v<0?1:0;if(v===0)return n;var s=Math.abs,x=0.000000000001,p=v>0,g=p?n:0,d=p?1:n,b=i(h),P=W.getLength(h,g,d,b),l=s(v)-P;if(s(l)<x)return p?d:g;else if(l>x)return null;var _=v/P,D=0;function B(j){return D+=$.integrate(b,n,j,t(n,j)),n=j,D-v}return $.findRoot(B,b,n+_,g,d,32,0.000000000001)},getPoint:function(h,v){return u(h,v,0,!1)},getTangent:function(h,v){return u(h,v,1,!0)},getWeightedTangent:function(h,v){return u(h,v,1,!1)},getNormal:function(h,v){return u(h,v,2,!0)},getWeightedNormal:function(h,v){return u(h,v,2,!1)},getCurvature:function(h,v){return u(h,v,3,!1).x},getPeaks:function(h){var v=h[0],n=h[1],s=h[2],x=h[3],p=h[4],g=h[5],d=h[6],b=h[7],P=-v+3*s-3*p+d,l=3*v-6*s+3*p,_=-3*v+3*s,D=-n+3*x-3*g+b,B=3*n-6*x+3*g,j=-3*n+3*x,o=0.00000001,w=1-o,S=[];return $.solveCubic(9*(P*P+D*D),9*(P*l+B*D),2*(l*l+B*B)+3*(_*P+j*D),_*l+B*j,S,o,w),S.sort()}}}},new function(){function i(l,_,D,B,j,o,w){var S=!w&&D.getPrevious()===j,C=!w&&D!==j&&D.getNext()===j,G=0.00000001,k=1-G;if(B!==null&&B>=(S?G:0)&&B<=(C?k:1)){if(o!==null&&o>=(C?G:0)&&o<=(S?k:1)){var c=new e0(D,B,null,w),N=new e0(j,o,null,w);if(c._intersection=N,N._intersection=c,!_||_(c))e0.insert(l,c,!0)}}}function t(l,_,D,B,j,o,w,S,C,G,k,c,N){if(++C>=4096||++S>=40)return C;var M=0.000000001,R=_[0],q=_[1],z=_[6],a=_[7],A=Y0.getSignedDistance,e=A(R,q,z,a,_[2],_[3]),X=A(R,q,z,a,_[4],_[5]),K=e*X>0?0.75:0.4444444444444444,Q=K*Math.min(0,e,X),h0=K*Math.max(0,e,X),p0=A(R,q,z,a,l[0],l[1]),x0=A(R,q,z,a,l[2],l[3]),b0=A(R,q,z,a,l[4],l[5]),v0=A(R,q,z,a,l[6],l[7]),_0=u(p0,x0,b0,v0),s0=_0[0],E0=_0[1],j0,L0;if(e===0&&X===0&&p0===0&&x0===0&&b0===0&&v0===0||(j0=h(s0,E0,Q,h0))==null||(L0=h(s0.reverse(),E0.reverse(),Q,h0))==null)return C;var k0=G+(k-G)*j0,D0=G+(k-G)*L0;if(Math.max(N-c,D0-k0)<M){var u6=(k0+D0)/2,h6=(c+N)/2;i(j,o,w?B:D,w?h6:u6,w?D:B,w?u6:h6)}else{l=W.getPart(l,j0,L0);var s6=N-c;if(L0-j0>0.8)if(D0-k0>s6){var Q0=W.subdivide(l,0.5),u6=(k0+D0)/2;C=t(_,Q0[0],B,D,j,o,!w,S,C,c,N,k0,u6),C=t(_,Q0[1],B,D,j,o,!w,S,C,c,N,u6,D0)}else{var Q0=W.subdivide(_,0.5),h6=(c+N)/2;C=t(Q0[0],l,B,D,j,o,!w,S,C,c,h6,k0,D0),C=t(Q0[1],l,B,D,j,o,!w,S,C,h6,N,k0,D0)}else if(s6===0||s6>=M)C=t(_,l,B,D,j,o,!w,S,C,c,N,k0,D0);else C=t(l,_,D,B,j,o,w,S,C,k0,D0,c,N)}return C}function u(l,_,D,B){var j=[0,l],o=[0.3333333333333333,_],w=[0.6666666666666666,D],S=[1,B],C=_-(2*l+B)/3,G=D-(l+2*B)/3,k;if(C*G<0)k=[[j,o,S],[j,w,S]];else{var c=C/G;k=[c>=2?[j,o,S]:c<=0.5?[j,w,S]:[j,o,w,S],[j,S]]}return(C||G)<0?k.reverse():k}function h(l,_,D,B){if(l[0][1]<D)return v(l,!0,D);else if(_[0][1]>B)return v(_,!1,B);else return l[0][0]}function v(l,_,D){var B=l[0][0],j=l[0][1];for(var o=1,w=l.length;o<w;o++){var S=l[o][0],C=l[o][1];if(_?C>=D:C<=D)return C===D?S:B+(D-j)*(S-B)/(C-j);B=S,j=C}return null}function n(l,_,D,B,j){var o=$.isZero;if(o(B)&&o(j)){var w=W.getTimeOf(l,new O(_,D));return w===null?[]:[w]}var S=Math.atan2(-j,B),C=Math.sin(S),G=Math.cos(S),k=[],c=[];for(var N=0;N<8;N+=2){var M=l[N]-_,R=l[N+1]-D;k.push(M*G-R*C,M*C+R*G)}return W.solveCubic(k,1,0,c,0,1),c}function s(l,_,D,B,j,o,w){var S=_[0],C=_[1],G=_[6],k=_[7],c=n(l,S,C,G-S,k-C);for(var N=0,M=c.length;N<M;N++){var R=c[N],q=W.getPoint(l,R),z=W.getTimeOf(_,q);if(z!==null)i(j,o,w?B:D,w?z:R,w?D:B,w?R:z)}}function x(l,_,D,B,j,o){var w=Y0.intersect(l[0],l[1],l[6],l[7],_[0],_[1],_[6],_[7]);if(w)i(j,o,D,W.getTimeOf(l,w),B,W.getTimeOf(_,w))}function p(l,_,D,B,j,o){var w=0.000000000001,S=Math.min,C=Math.max;if(C(l[0],l[2],l[4],l[6])+w>S(_[0],_[2],_[4],_[6])&&S(l[0],l[2],l[4],l[6])-w<C(_[0],_[2],_[4],_[6])&&C(l[1],l[3],l[5],l[7])+w>S(_[1],_[3],_[5],_[7])&&S(l[1],l[3],l[5],l[7])-w<C(_[1],_[3],_[5],_[7])){var G=b(l,_);if(G)for(var k=0;k<2;k++){var c=G[k];i(j,o,D,c[0],B,c[1],!0)}else{var N=W.isStraight(l),M=W.isStraight(_),R=N&&M,q=N&&!M,z=j.length;if((R?x:N||M?s:t)(q?_:l,q?l:_,q?B:D,q?D:B,j,o,q,0,0,0,1,0,1),!R||j.length===z)for(var k=0;k<4;k++){var a=k>>1,A=k&1,e=a*6,X=A*6,K=new O(l[e],l[e+1]),Q=new O(_[X],_[X+1]);if(K.isClose(Q,w))i(j,o,D,a,B,A)}}}return j}function g(l,_,D,B){var j=W.classify(l);if(j.type==="loop"){var o=j.roots;i(D,B,_,o[0],_,o[1])}return D}function d(l,_,D,B,j,o){var w=0.0000001,S=!_;if(S)_=l;var C=l.length,G=_.length,k=new Array(C),c=S?k:new Array(G),N=[];for(var M=0;M<C;M++)k[M]=l[M].getValues(B);if(!S)for(var M=0;M<G;M++)c[M]=_[M].getValues(j);var R=g0.findCurveBoundsCollisions(k,c,w);for(var q=0;q<C;q++){var z=l[q],a=k[q];if(S)g(a,z,N,D);var A=R[q];if(A)for(var e=0;e<A.length;e++){if(o&&N.length)return N;var X=A[e];if(!S||X>q){var K=_[X],Q=c[X];p(a,Q,z,K,N,D)}}}return N}function b(l,_){function D(v0){var _0=v0[6]-v0[0],s0=v0[7]-v0[1];return _0*_0+s0*s0}var B=Math.abs,j=Y0.getDistance,o=0.00000001,w=0.0000001,S=W.isStraight(l),C=W.isStraight(_),G=S&&C,k=D(l)<D(_),c=k?_:l,N=k?l:_,M=c[0],R=c[1],q=c[6]-M,z=c[7]-R;if(j(M,R,q,z,N[0],N[1],!0)<w&&j(M,R,q,z,N[6],N[7],!0)<w){if(!G&&j(M,R,q,z,c[2],c[3],!0)<w&&j(M,R,q,z,c[4],c[5],!0)<w&&j(M,R,q,z,N[2],N[3],!0)<w&&j(M,R,q,z,N[4],N[5],!0)<w)S=C=G=!0}else if(G)return null;if(S^C)return null;var a=[l,_],A=[];for(var e=0;e<4&&A.length<2;e++){var X=e&1,K=X^1,Q=e>>1,h0=W.getTimeOf(a[X],new O(a[K][Q?6:0],a[K][Q?7:1]));if(h0!=null){var p0=X?[Q,h0]:[h0,Q];if(!A.length||B(p0[0]-A[0][0])>o&&B(p0[1]-A[0][1])>o)A.push(p0)}if(e>2&&!A.length)break}if(A.length!==2)A=null;else if(!G){var x0=W.getPart(l,A[0][0],A[1][0]),b0=W.getPart(_,A[0][1],A[1][1]);if(B(b0[2]-x0[2])>w||B(b0[3]-x0[3])>w||B(b0[4]-x0[4])>w||B(b0[5]-x0[5])>w)A=null}return A}function P(l,_){var D=l[0],B=l[1],j=l[2],o=l[3],w=l[4],S=l[5],C=l[6],G=l[7],k=_.normalize(),c=k.x,N=k.y,M=3*C-9*w+9*j-3*D,R=3*G-9*S+9*o-3*B,q=6*w-12*j+6*D,z=6*S-12*o+6*B,a=3*j-3*D,A=3*o-3*B,e=2*M*N-2*R*c,X=[];if(Math.abs(e)<$.CURVETIME_EPSILON){var K=M*A-R*a,e=M*z-R*q;if(e!=0){var Q=-K/e;if(Q>=0&&Q<=1)X.push(Q)}}else{var h0=(q*q-4*M*a)*N*N+(-2*q*z+4*R*a+4*M*A)*c*N+(z*z-4*R*A)*c*c,p0=q*N-z*c;if(h0>=0&&e!=0){var x0=Math.sqrt(h0),b0=-(p0+x0)/e,v0=(-p0+x0)/e;if(b0>=0&&b0<=1)X.push(b0);if(v0>=0&&v0<=1)X.push(v0)}}return X}return{getIntersections:function(l){var _=this.getValues(),D=l&&l!==this&&l.getValues();return D?p(_,D,this,l,[]):g(_,this,[])},statics:{getOverlaps:b,getIntersections:d,getCurveLineIntersections:n,getTimesWithTangent:P}}}),e0=L.extend({_class:"CurveLocation",initialize:function i(t,u,h,v,n){if(u>=0.99999999){var s=t.getNext();if(s)u=0,t=s}this._setCurve(t),this._time=u,this._point=h||t.getPointAtTime(u),this._overlap=v,this._distance=n,this._intersection=this._next=this._previous=null},_setPath:function(i){this._path=i,this._version=i?i._version:0},_setCurve:function(i){this._setPath(i._path),this._curve=i,this._segment=null,this._segment1=i._segment1,this._segment2=i._segment2},_setSegment:function(i){var t=i.getCurve();if(t)this._setCurve(t);else this._setPath(i._path),this._segment1=i,this._segment2=null;this._segment=i,this._time=i===this._segment1?0:1,this._point=i._point.clone()},getSegment:function(){var i=this._segment;if(!i){var t=this.getCurve(),u=this.getTime();if(u===0)i=t._segment1;else if(u===1)i=t._segment2;else if(u!=null)i=t.getPartLength(0,u)<t.getPartLength(u,1)?t._segment1:t._segment2;this._segment=i}return i},getCurve:function(){var i=this._path,t=this;if(i&&i._version!==this._version)this._time=this._offset=this._curveOffset=this._curve=null;function u(h){var v=h&&h.getCurve();if(v&&(t._time=v.getTimeOf(t._point))!=null)return t._setCurve(v),v}return this._curve||u(this._segment)||u(this._segment1)||u(this._segment2.getPrevious())},getPath:function(){var i=this.getCurve();return i&&i._path},getIndex:function(){var i=this.getCurve();return i&&i.getIndex()},getTime:function(){var i=this.getCurve(),t=this._time;return i&&t==null?this._time=i.getTimeOf(this._point):t},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var i=this._offset;if(i==null){i=0;var t=this.getPath(),u=this.getIndex();if(t&&u!=null){var h=t.getCurves();for(var v=0;v<u;v++)i+=h[v].getLength()}this._offset=i+=this.getCurveOffset()}return i},getCurveOffset:function(){var i=this._curveOffset;if(i==null){var t=this.getCurve(),u=this.getTime();this._curveOffset=i=u!=null&&t&&t.getPartLength(0,u)}return i},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var i=this.getCurve(),t=i&&i.divideAtTime(this.getTime());if(t)this._setSegment(t._segment1);return t},split:function(){var i=this.getCurve(),t=i._path,u=i&&i.splitAtTime(this.getTime());if(u)this._setSegment(t.getLastSegment());return u},equals:function(i,t){var u=this===i;if(!u&&i instanceof e0){var h=this.getCurve(),v=i.getCurve(),n=h._path,s=v._path;if(n===s){var x=Math.abs,p=0.0000001,g=x(this.getOffset()-i.getOffset()),d=!t&&this._intersection,b=!t&&i._intersection;u=(g<p||n&&x(n.getLength()-g)<p)&&(!d&&!b||d&&b&&d.equals(b,!0))}}return u},toString:function(){var i=[],t=this.getPoint(),u=y0.instance;if(t)i.push("point: "+t);var h=this.getIndex();if(h!=null)i.push("index: "+h);var v=this.getTime();if(v!=null)i.push("time: "+u.number(v));if(this._distance!=null)i.push("distance: "+u.number(this._distance));return"{ "+i.join(", ")+" }"},isTouching:function(){var i=this._intersection;if(i&&this.getTangent().isCollinear(i.getTangent())){var t=this.getCurve(),u=i.getCurve();return!(t.isStraight()&&u.isStraight()&&t.getLine().intersect(u.getLine()))}return!1},isCrossing:function(){var i=this._intersection;if(!i)return!1;var t=this.getTime(),u=i.getTime(),h=0.00000001,v=1-h,n=t>=h&&t<=v,s=u>=h&&u<=v;if(n&&s)return!this.isTouching();var x=this.getCurve(),p=x&&t<h?x.getPrevious():x,g=i.getCurve(),d=g&&u<h?g.getPrevious():g;if(t>v)x=x.getNext();if(u>v)g=g.getNext();if(!p||!x||!d||!g)return!1;var b=[];function P(c,N){var M=c.getValues(),R=W.classify(M).roots||W.getPeaks(M),q=R.length,z=W.getLength(M,N&&q?R[q-1]:0,!N&&q?R[0]:1);b.push(q?z:z/32)}function l(c,N,M){return N<M?c>N&&c<M:c>N||c<M}if(!n)P(p,!0),P(x,!1);if(!s)P(d,!0),P(g,!1);var _=this.getPoint(),D=Math.min.apply(Math,b),B=n?x.getTangentAtTime(t):x.getPointAt(D).subtract(_),j=n?B.negate():p.getPointAt(-D).subtract(_),o=s?g.getTangentAtTime(u):g.getPointAt(D).subtract(_),w=s?o.negate():d.getPointAt(-D).subtract(_),S=j.getAngle(),C=B.getAngle(),G=w.getAngle(),k=o.getAngle();return!!(n?l(S,G,k)^l(C,G,k)&&l(S,k,G)^l(C,k,G):l(G,S,C)^l(k,S,C)&&l(G,C,S)^l(k,C,S))},hasOverlap:function(){return!!this._overlap}},L.each(W._evaluateMethods,function(i){var t=i+"At";this[i]=function(){var u=this.getCurve(),h=this.getTime();return h!=null&&u&&u[t](h,!0)}},{preserve:!0}),new function(){function i(t,u,h){var v=t.length,n=0,s=v-1;function x(_,D){for(var B=_+D;B>=-1&&B<=v;B+=D){var j=t[(B%v+v)%v];if(!u.getPoint().isClose(j.getPoint(),0.0000001))break;if(u.equals(j))return j}return null}while(n<=s){var p=n+s>>>1,g=t[p],d;if(h&&(d=u.equals(g)?g:x(p,-1)||x(p,1))){if(u._overlap)d._overlap=d._intersection._overlap=!0;return d}var b=u.getPath(),P=g.getPath(),l=b!==P?b._id-P._id:u.getIndex()+u.getTime()-(g.getIndex()+g.getTime());if(l<0)s=p-1;else n=p+1}return t.splice(n,0,u),u}return{statics:{insert:i,expand:function(t){var u=t.slice();for(var h=t.length-1;h>=0;h--)i(u,t[h]._intersection,!1);return u}}}}),i6=l0.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function i(){},statics:{create:function(i){var t,u,h;if(L.isPlainObject(i))u=i.segments,t=i.pathData;else if(Array.isArray(i))u=i;else if(typeof i==="string")t=i;if(u){var v=u[0];h=v&&Array.isArray(v[0])}else if(t)h=(t.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(t);var n=h?T0:d0;return new n(i)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(i){if(this.isClockwise()!=(i=!!i))this.reverse()},setPathData:function(i){var t=i&&i.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),u,h=!1,v,n,s=new O,x=new O;function p(w,S){var C=+u[w];if(h)C+=s[S];return C}function g(w){return new O(p(w,"x"),p(w+1,"y"))}this.clear();for(var d=0,b=t&&t.length;d<b;d++){var P=t[d],l=P[0],_=l.toLowerCase();u=P.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var D=u&&u.length;if(h=l===_,v==="z"&&!/[mz]/.test(_))this.moveTo(s);switch(_){case"m":case"l":var B=_==="m";for(var j=0;j<D;j+=2)if(this[B?"moveTo":"lineTo"](s=g(j)),B)x=s,B=!1;n=s;break;case"h":case"v":var o=_==="h"?"x":"y";s=s.clone();for(var j=0;j<D;j++)s[o]=p(j,o),this.lineTo(s);n=s;break;case"c":for(var j=0;j<D;j+=6)this.cubicCurveTo(g(j),n=g(j+2),s=g(j+4));break;case"s":for(var j=0;j<D;j+=4)this.cubicCurveTo(/[cs]/.test(v)?s.multiply(2).subtract(n):s,n=g(j),s=g(j+2)),v=_;break;case"q":for(var j=0;j<D;j+=4)this.quadraticCurveTo(n=g(j),s=g(j+2));break;case"t":for(var j=0;j<D;j+=2)this.quadraticCurveTo(n=/[qt]/.test(v)?s.multiply(2).subtract(n):s,s=g(j)),v=_;break;case"a":for(var j=0;j<D;j+=7)this.arcTo(s=g(j+5),new t0(+u[j],+u[j+1]),+u[j+2],+u[j+4],+u[j+3]);break;case"z":this.closePath(0.000000000001),s=x;break}v=_}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(i){var t=i.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(i):{};return t.onPath||!!(this.getFillRule()==="evenodd"?t.windingL&1||t.windingR&1:t.winding)},getIntersections:function(i,t,u,h){var v=this===i||!i,n=this._matrix._orNullIfIdentity(),s=v?n:(u||i._matrix)._orNullIfIdentity();return v||this.getBounds(n).intersects(i.getBounds(s),0.000000000001)?W.getIntersections(this.getCurves(),!v&&i.getCurves(),t,n,s,h):[]},getCrossings:function(i){return this.getIntersections(i,function(t){return t.isCrossing()})},getNearestLocation:function(){var i=O.read(arguments),t=this.getCurves(),u=Infinity,h=null;for(var v=0,n=t.length;v<n;v++){var s=t[v].getNearestLocation(i);if(s._distance<u)u=s._distance,h=s}return h},getNearestPoint:function(){var i=this.getNearestLocation.apply(this,arguments);return i?i.getPoint():i},interpolate:function(i,t,u){var h=!this._children,v=h?"_segments":"_children",n=i[v],s=t[v],x=this[v];if(!n||!s||n.length!==s.length)throw new Error("Invalid operands in interpolate() call: "+i+", "+t);var p=x.length,g=s.length;if(p<g){var d=h?J:d0;for(var b=p;b<g;b++)this.add(new d)}else if(p>g)this[h?"removeSegments":"removeChildren"](g,p);for(var b=0;b<g;b++)x[b].interpolate(n[b],s[b],u);if(h)this.setClosed(i._closed),this._changed(9)},compare:function(i){var t=!1;if(i){var u=this._children||[this],h=i._children?i._children.slice():[i],v=u.length,n=h.length,s=[],x=0;t=!0;var p=g0.findItemBoundsCollisions(u,h,$.GEOMETRIC_EPSILON);for(var g=v-1;g>=0&&t;g--){var d=u[g];t=!1;var b=p[g];if(b){for(var P=b.length-1;P>=0&&!t;P--)if(d.compare(h[b[P]])){if(!s[b[P]])s[b[P]]=!0,x++;t=!0}}}t=t&&x===n}return t}}),d0=i6.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function i(t){this._closed=!1,this._segments=[],this._version=0;var u=arguments,h=Array.isArray(t)?typeof t[0]==="object"?t:u:t&&(t.size===V&&(t.x!==V||t.point!==V))?u:null;if(h&&h.length>0)this.setSegments(h);else if(this._curves=V,this._segmentSelection=0,!h&&typeof t==="string")this.setPathData(t),t=null;this._initialize(!h&&t)},_equals:function(i){return this._closed===i._closed&&L.equals(this._segments,i._segments)},copyContent:function(i){this.setSegments(i._segments),this._closed=i._closed},_changed:function i(t){if(i.base.call(this,t),t&8){if(this._length=this._area=V,t&32)this._version++;else if(this._curves)for(var u=0,h=this._curves.length;u<h;u++)this._curves[u]._changed()}else if(t&64)this._bounds=V},getStyle:function(){var i=this._parent;return(i instanceof T0?i:this)._style},getSegments:function(){return this._segments},setSegments:function(i){var t=this.isFullySelected(),u=i&&i.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=V,u){var h=i[u-1];if(typeof h==="boolean")this.setClosed(h),u--;this._add(J.readList(i,0,{},u))}if(t)this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var i=this._curves,t=this._segments;if(!i){var u=this._countCurves();i=this._curves=new Array(u);for(var h=0;h<u;h++)i[h]=new W(this,t[h],t[h+1]||t[0])}return i},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var i=this.getCurves();return i[i.length-1]},isClosed:function(){return this._closed},setClosed:function(i){if(this._closed!=(i=!!i)){if(this._closed=i,this._curves){var t=this._curves.length=this._countCurves();if(i)this._curves[t-1]=new W(this,this._segments[t-1],this._segments[0])}this._changed(41)}}},{beans:!0,getPathData:function(i,t){var u=this._segments,h=u.length,v=new y0(t),n=new Array(6),s=!0,x,p,g,d,b,P,l,_,D=[];function B(o,w){if(o._transformCoordinates(i,n),x=n[0],p=n[1],s)D.push("M"+v.pair(x,p)),s=!1;else if(b=n[2],P=n[3],b===x&&P===p&&l===g&&_===d){if(!w){var S=x-g,C=p-d;D.push(S===0?"v"+v.number(C):C===0?"h"+v.number(S):"l"+v.pair(S,C))}}else D.push("c"+v.pair(l-g,_-d)+" "+v.pair(b-g,P-d)+" "+v.pair(x-g,p-d));g=x,d=p,l=n[4],_=n[5]}if(!h)return"";for(var j=0;j<h;j++)B(u[j]);if(this._closed&&h>0)B(u[0],!0),D.push("z");return D.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(i){var t=this._segments,u=new Array(6);for(var h=0,v=t.length;h<v;h++)t[h]._transformCoordinates(i,u,!0);return!0},_add:function(i,s){var u=this._segments,h=this._curves,v=i.length,n=s==null,s=n?u.length:s;for(var x=0;x<v;x++){var p=i[x];if(p._path)p=i[x]=p.clone();if(p._path=this,p._index=s+x,p._selection)this._updateSelection(p,0,p._selection)}if(n)L.push(u,i);else{u.splice.apply(u,[s,0].concat(i));for(var x=s+v,g=u.length;x<g;x++)u[x]._index=x}if(h){var d=this._countCurves(),b=s>0&&s+v-1===d?s-1:s,P=b,l=Math.min(b+v,d);if(i._curves)h.splice.apply(h,[b,0].concat(i._curves)),P+=i._curves.length;for(var x=P;x<l;x++)h.splice(x,0,new W(this,null,null));this._adjustCurves(b,l)}return this._changed(41),i},_adjustCurves:function(i,t){var u=this._segments,h=this._curves,v;for(var n=i;n<t;n++)v=h[n],v._path=this,v._segment1=u[n],v._segment2=u[n+1]||u[0],v._changed();if(v=h[this._closed&&!i?u.length-1:i-1])v._segment2=u[i]||u[0],v._changed();if(v=h[t])v._segment1=u[t],v._changed()},_countCurves:function(){var i=this._segments.length;return!this._closed&&i>0?i-1:i},add:function(i){var t=arguments;return t.length>1&&typeof i!=="number"?this._add(J.readList(t)):this._add([J.read(t)])[0]},insert:function(i,t){var u=arguments;return u.length>2&&typeof t!=="number"?this._add(J.readList(u,1),i):this._add([J.read(u,1)],i)[0]},addSegment:function(){return this._add([J.read(arguments)])[0]},insertSegment:function(i){return this._add([J.read(arguments,1)],i)[0]},addSegments:function(i){return this._add(J.readList(i))},insertSegments:function(i,t){return this._add(J.readList(t),i)},removeSegment:function(i){return this.removeSegments(i,i+1)[0]||null},removeSegments:function(i,t,u){i=i||0,t=L.pick(t,this._segments.length);var h=this._segments,v=this._curves,n=h.length,s=h.splice(i,t-i),x=s.length;if(!x)return s;for(var p=0;p<x;p++){var g=s[p];if(g._selection)this._updateSelection(g,g._selection,0);g._index=g._path=null}for(var p=i,d=h.length;p<d;p++)h[p]._index=p;if(v){var b=i>0&&t===n+(this._closed?1:0)?i-1:i,v=v.splice(b,x);for(var p=v.length-1;p>=0;p--)v[p]._path=null;if(u)s._curves=v.slice(1);this._adjustCurves(b,b)}return this._changed(41),s},clear:"#removeSegments",hasHandles:function(){var i=this._segments;for(var t=0,u=i.length;t<u;t++)if(i[t].hasHandles())return!0;return!1},clearHandles:function(){var i=this._segments;for(var t=0,u=i.length;t<u;t++)i[t].clearHandles()},getLength:function(){if(this._length==null){var i=this.getCurves(),t=0;for(var u=0,h=i.length;u<h;u++)t+=i[u].getLength();this._length=t}return this._length},getArea:function(){var i=this._area;if(i==null){var t=this._segments,u=this._closed;i=0;for(var h=0,v=t.length;h<v;h++){var n=h+1===v;i+=W.getArea(W.getValues(t[h],t[n?0:h+1],null,n&&!u))}this._area=i}return i},isFullySelected:function(){var i=this._segments.length;return this.isSelected()&&i>0&&this._segmentSelection===i*7},setFullySelected:function(i){if(i)this._selectSegments(!0);this.setSelected(i)},setSelection:function i(t){if(!(t&1))this._selectSegments(!1);i.base.call(this,t)},_selectSegments:function(i){var t=this._segments,u=t.length,h=i?7:0;this._segmentSelection=h*u;for(var v=0;v<u;v++)t[v]._selection=h},_updateSelection:function(i,t,u){i._selection=u;var h=this._segmentSelection+=u-t;if(h>0)this.setSelected(!0)},divideAt:function(i){var t=this.getLocationAt(i),u;return t&&(u=t.getCurve().divideAt(t.getCurveOffset()))?u._segment1:null},splitAt:function(i){var t=this.getLocationAt(i),u=t&&t.index,h=t&&t.time,v=0.00000001,n=1-v;if(h>n)u++,h=0;var s=this.getCurves();if(u>=0&&u<s.length){if(h>=v)s[u++].divideAtTime(h);var x=this.removeSegments(u,this._segments.length,!0),p;if(this._closed)this.setClosed(!1),p=this;else p=new d0(l0.NO_INSERT),p.insertAbove(this),p.copyAttributes(this);return p._add(x,0),this.addSegment(x[0]),p}return null},split:function(i,t){var u,h=t===V?i:(u=this.getCurves()[i])&&u.getLocationAtTime(t);return h!=null?this.splitAt(h):null},join:function(i,t){var u=t||0;if(i&&i!==this){var h=i._segments,v=this.getLastSegment(),n=i.getLastSegment();if(!n)return this;if(v&&v._point.isClose(n._point,u))i.reverse();var s=i.getFirstSegment();if(v&&v._point.isClose(s._point,u))v.setHandleOut(s._handleOut),this._add(h.slice(1));else{var x=this.getFirstSegment();if(x&&x._point.isClose(s._point,u))i.reverse();if(n=i.getLastSegment(),x&&x._point.isClose(n._point,u))x.setHandleIn(n._handleIn),this._add(h.slice(0,h.length-1),0);else this._add(h.slice())}if(i._closed)this._add([h[0]]);i.remove()}var p=this.getFirstSegment(),g=this.getLastSegment();if(p!==g&&p._point.isClose(g._point,u))p.setHandleIn(g._handleIn),g.remove(),this.setClosed(!0);return this},reduce:function(i){var t=this.getCurves(),u=i&&i.simplify,h=u?0.0000001:0;for(var v=t.length-1;v>=0;v--){var n=t[v];if(!n.hasHandles()&&(!n.hasLength(h)||u&&n.isCollinear(n.getNext())))n.remove()}return this},reverse:function(){this._segments.reverse();for(var i=0,t=this._segments.length;i<t;i++){var u=this._segments[i],h=u._handleIn;u._handleIn=u._handleOut,u._handleOut=h,u._index=i}this._curves=null,this._changed(9)},flatten:function(i){var t=new f6(this,i||0.25,256,!0),u=t.parts,h=u.length,v=[];for(var n=0;n<h;n++)v.push(new J(u[n].curve.slice(0,2)));if(!this._closed&&h>0)v.push(new J(u[h-1].curve.slice(6)));this.setSegments(v)},simplify:function(i){var t=new W0(this).fit(i||2.5);if(t)this.setSegments(t);return!!t},smooth:function(i){var t=this,u=i||{},h=u.type||"asymmetric",v=this._segments,n=v.length,s=this._closed;function x(s0,E0){var j0=s0&&s0.index;if(j0!=null){var L0=s0.path;if(L0&&L0!==t)throw new Error(s0._class+" "+j0+" of "+L0+" is not part of "+t);if(E0&&s0 instanceof W)j0++}else j0=typeof s0==="number"?s0:E0;return Math.min(j0<0&&s?j0%n:j0<0?j0+n:j0,n-1)}var p=s&&u.from===V&&u.to===V,g=x(u.from,0),d=x(u.to,n-1);if(g>d)if(s)g-=n;else{var b=g;g=d,d=b}if(/^(?:asymmetric|continuous)$/.test(h)){var P=h==="asymmetric",l=Math.min,_=d-g+1,D=_-1,B=p?l(_,4):1,j=B,o=B,w=[];if(!s)j=l(1,g),o=l(1,n-d-1);if(D+=j+o,D<=1)return;for(var S=0,C=g-j;S<=D;S++,C++)w[S]=v[(C<0?C+n:C)%n]._point;var G=w[0]._x+2*w[1]._x,k=w[0]._y+2*w[1]._y,c=2,N=D-1,M=[G],R=[k],q=[c],z=[],a=[];for(var S=1;S<D;S++){var A=S<N,e=A?1:P?1:2,X=A?4:P?2:7,K=A?4:P?3:8,Q=A?2:P?0:1,h0=e/c;c=q[S]=X-h0,G=M[S]=K*w[S]._x+Q*w[S+1]._x-h0*G,k=R[S]=K*w[S]._y+Q*w[S+1]._y-h0*k}z[N]=M[N]/q[N],a[N]=R[N]/q[N];for(var S=D-2;S>=0;S--)z[S]=(M[S]-z[S+1])/q[S],a[S]=(R[S]-a[S+1])/q[S];z[D]=(3*w[D]._x-z[N])/2,a[D]=(3*w[D]._y-a[N])/2;for(var S=j,p0=D-o,C=g;S<=p0;S++,C++){var x0=v[C<0?C+n:C],b0=x0._point,v0=z[S]-b0._x,_0=a[S]-b0._y;if(p||S<p0)x0.setHandleOut(v0,_0);if(p||S>j)x0.setHandleIn(-v0,-_0)}}else for(var S=g;S<=d;S++)v[S<0?S+n:S].smooth(u,!p&&S===g,!p&&S===d)},toShape:function(i){if(!this._closed)return null;var t=this._segments,u,h,v,n;function s(P,l){var _=t[P],D=_.getNext(),B=t[l],j=B.getNext();return _._handleOut.isZero()&&D._handleIn.isZero()&&B._handleOut.isZero()&&j._handleIn.isZero()&&D._point.subtract(_._point).isCollinear(j._point.subtract(B._point))}function x(P){var l=t[P],_=l.getPrevious(),D=l.getNext();return _._handleOut.isZero()&&l._handleIn.isZero()&&l._handleOut.isZero()&&D._handleIn.isZero()&&l._point.subtract(_._point).isOrthogonal(D._point.subtract(l._point))}function p(P){var l=t[P],_=l.getNext(),D=l._handleOut,B=_._handleIn,j=0.5522847498307936;if(D.isOrthogonal(B)){var o=l._point,w=_._point,S=new Y0(o,D,!0).intersect(new Y0(w,B,!0),!0);return S&&$.isZero(D.getLength()/S.subtract(o).getLength()-j)&&$.isZero(B.getLength()/S.subtract(w).getLength()-j)}return!1}function g(P,l){return t[P]._point.getDistance(t[l]._point)}if(!this.hasHandles()&&t.length===4&&s(0,2)&&s(1,3)&&x(1))u=f0.Rectangle,h=new t0(g(0,3),g(0,1)),n=t[1]._point.add(t[2]._point).divide(2);else if(t.length===8&&p(0)&&p(2)&&p(4)&&p(6)&&s(1,5)&&s(3,7))u=f0.Rectangle,h=new t0(g(1,6),g(0,3)),v=h.subtract(new t0(g(0,7),g(1,2))).divide(2),n=t[3]._point.add(t[4]._point).divide(2);else if(t.length===4&&p(0)&&p(1)&&p(2)&&p(3)){if($.isZero(g(0,2)-g(1,3)))u=f0.Circle,v=g(0,2)/2;else u=f0.Ellipse,v=new t0(g(2,0)/2,g(3,1)/2);n=t[1]._point}if(u){var d=this.getPosition(!0),b=new u({center:d,size:h,radius:v,insert:!1});if(b.copyAttributes(this,!0),b._matrix.prepend(this._matrix),b.rotate(n.subtract(d).getAngle()+90),i===V||i)b.insertAbove(this);return b}return null},toPath:"#clone",compare:function i(t){if(!t||t instanceof T0)return i.base.call(this,t);var u=this.getCurves(),h=t.getCurves(),v=u.length,n=h.length;if(!v||!n)return v==n;var s=u[0].getValues(),x=[],p=0,g,d=0,b;for(var P=0;P<n;P++){var B=h[P].getValues();x.push(B);var l=W.getOverlaps(s,B);if(l){g=!P&&l[0][0]>0?n-1:P,b=l[0][1];break}}var _=Math.abs,D=0.00000001,B=x[g],j;while(s&&B){var l=W.getOverlaps(s,B);if(l){var o=l[0][0];if(_(o-d)<D){if(d=l[1][0],d===1)s=++p<v?u[p].getValues():null,d=0;var w=l[0][1];if(_(w-b)<D){if(!j)j=[g,w];if(b=l[1][1],b===1){if(++g>=n)g=0;B=x[g]||h[g].getValues(),b=0}if(!s)return j[0]===g&&j[1]===b;continue}}}break}return!1},_hitTestSelf:function(i,t,u,h){var v=this,n=this.getStyle(),s=this._segments,x=s.length,p=this._closed,g=t._tolerancePadding,d=g,b,P,l,_,D,B,j=t.stroke&&n.hasStroke(),o=t.fill&&n.hasFill(),w=t.curves,S=j?n.getStrokeWidth()/2:o&&t.tolerance>0||w?0:null;if(S!==null)if(S>0)b=n.getStrokeJoin(),P=n.getStrokeCap(),l=n.getMiterLimit(),d=d.add(d0._getStrokePadding(S,h));else b=P="round";function C(z,a){return i.subtract(z).divide(a).length<=1}function G(z,a,A){if(!t.selected||a.isSelected()){var e=z._point;if(a!==e)a=a.add(e);if(C(a,d))return new n0(A,v,{segment:z,point:a})}}function k(z,a){return(a||t.segments)&&G(z,z._point,"segment")||!a&&t.handles&&(G(z,z._handleIn,"handle-in")||G(z,z._handleOut,"handle-out"))}function c(z){_.add(z)}function N(z){var a=p||z._index>0&&z._index<x-1;if((a?b:P)==="round")return C(z._point,d);else{if(_=new d0({internal:!0,closed:!0}),a){if(!z.isSmooth())d0._addBevelJoin(z,b,S,l,null,h,c,!0)}else if(P==="square")d0._addSquareCap(z,P,S,null,h,c,!0);if(!_.isEmpty()){var A;return _.contains(i)||(A=_.getNearestLocation(i))&&C(A.getPoint(),g)}}}if(t.ends&&!t.segments&&!p){if(B=k(s[0],!0)||k(s[x-1],!0))return B}else if(t.segments||t.handles){for(var M=0;M<x;M++)if(B=k(s[M]))return B}if(S!==null){if(D=this.getNearestLocation(i),D){var R=D.getTime();if(R===0||R===1&&x>1){if(!N(D.getSegment()))D=null}else if(!C(D.getPoint(),d))D=null}if(!D&&b==="miter"&&x>1)for(var M=0;M<x;M++){var q=s[M];if(i.getDistance(q._point)<=l*S&&N(q)){D=q.getLocation();break}}}return!D&&o&&this._contains(i)||D&&!j&&!w?new n0("fill",this):D?new n0(j?"stroke":"curve",this,{location:D,point:D.getPoint()}):null}},L.each(W._evaluateMethods,function(i){this[i+"At"]=function(t){var u=this.getLocationAt(t);return u&&u[i]()}},{beans:!1,getLocationOf:function(){var i=O.read(arguments),t=this.getCurves();for(var u=0,h=t.length;u<h;u++){var v=t[u].getLocationOf(i);if(v)return v}return null},getOffsetOf:function(){var i=this.getLocationOf.apply(this,arguments);return i?i.getOffset():null},getLocationAt:function(i){if(typeof i==="number"){var t=this.getCurves(),u=0;for(var h=0,v=t.length;h<v;h++){var n=u,s=t[h];if(u+=s.getLength(),u>i)return s.getLocationAt(i-n)}if(t.length>0&&i<=this.getLength())return new e0(t[t.length-1],1)}else if(i&&i.getPath&&i.getPath()===this)return i;return null},getOffsetsWithTangent:function(){var i=O.read(arguments);if(i.isZero())return[];var t=[],u=0,h=this.getCurves();for(var v=0,n=h.length;v<n;v++){var s=h[v],x=s.getTimesWithTangent(i);for(var p=0,g=x.length;p<g;p++){var d=u+s.getOffsetAtTime(x[p]);if(t.indexOf(d)<0)t.push(d)}u+=s.length}return t}}),new function(){function i(u,h,v,n){if(n<=0)return;var s=n/2,x=n-2,p=s-1,g=new Array(6),d,b;function P(o){var w=g[o],S=g[o+1];if(d!=w||b!=S)u.beginPath(),u.moveTo(d,b),u.lineTo(w,S),u.stroke(),u.beginPath(),u.arc(w,S,s,0,Math.PI*2,!0),u.fill()}for(var l=0,_=h.length;l<_;l++){var D=h[l],B=D._selection;if(D._transformCoordinates(v,g),d=g[0],b=g[1],B&2)P(2);if(B&4)P(4);if(u.fillRect(d-s,b-s,n,n),x>0&&!(B&1)){var j=u.fillStyle;u.fillStyle="#ffffff",u.fillRect(d-p,b-p,x,x),u.fillStyle=j}}}function t(u,h,v){var n=h._segments,s=n.length,x=new Array(6),p=!0,g,d,b,P,l,_,D,B;function j(w){if(v)w._transformCoordinates(v,x),g=x[0],d=x[1];else{var S=w._point;g=S._x,d=S._y}if(p)u.moveTo(g,d),p=!1;else{if(v)l=x[2],_=x[3];else{var C=w._handleIn;l=g+C._x,_=d+C._y}if(l===g&&_===d&&D===b&&B===P)u.lineTo(g,d);else u.bezierCurveTo(D,B,l,_,g,d)}if(b=g,P=d,v)D=x[4],B=x[5];else{var C=w._handleOut;D=b+C._x,B=P+C._y}}for(var o=0;o<s;o++)j(n[o]);if(h._closed&&s>0)j(n[0])}return{_draw:function(u,h,v,n){var s=h.dontStart,x=h.dontFinish||h.clip,p=this.getStyle(),g=p.hasFill(),d=p.hasStroke(),b=p.getDashArray(),P=!G0.support.nativeDash&&d&&b&&b.length;if(!s)u.beginPath();if(g||d&&!P||x){if(t(u,this,n),this._closed)u.closePath()}function l(w){return b[(w%P+P)%P]}if(!x&&(g||d)){if(this._setStyles(u,h,v),g)u.fill(p.getFillRule()),u.shadowColor="rgba(0,0,0,0)";if(d){if(P){if(!s)u.beginPath();var _=new f6(this,0.25,32,!1,n),D=_.length,B=-p.getDashOffset(),j,o=0;while(B>0)B-=l(o--)+l(o--);while(B<D){if(j=B+l(o++),B>0||j>0)_.drawPart(u,Math.max(B,0),Math.max(j,0));B=j+l(o++)}}u.stroke()}}},_drawSelected:function(u,h){u.beginPath(),t(u,this,h),u.stroke(),i(u,this._segments,h,G0.settings.handleSize)}}},new function(){function i(t){var u=t._segments;if(!u.length)throw new Error("Use a moveTo() command first");return u[u.length-1]}return{moveTo:function(){var t=this._segments;if(t.length===1)this.removeSegment(0);if(!t.length)this._add([new J(O.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new J(O.read(arguments))])},cubicCurveTo:function(){var t=arguments,u=O.read(t),h=O.read(t),v=O.read(t),n=i(this);n.setHandleOut(u.subtract(n._point)),this._add([new J(v,h.subtract(v))])},quadraticCurveTo:function(){var t=arguments,u=O.read(t),h=O.read(t),v=i(this)._point;this.cubicCurveTo(u.add(v.subtract(u).multiply(0.3333333333333333)),u.add(h.subtract(u).multiply(0.3333333333333333)),h)},curveTo:function(){var t=arguments,u=O.read(t),h=O.read(t),v=L.pick(L.read(t),0.5),n=1-v,s=i(this)._point,x=u.subtract(s.multiply(n*n)).subtract(h.multiply(v*v)).divide(2*v*n);if(x.isNaN())throw new Error("Cannot put a curve through points with parameter = "+v);this.quadraticCurveTo(x,h)},arcTo:function(){var t=arguments,u=Math.abs,h=Math.sqrt,v=i(this),n=v._point,s=O.read(t),_,x=L.peek(t),p=L.pick(x,!0),g,d,b,P;if(typeof p==="boolean")var l=n.add(s).divide(2),_=l.add(l.subtract(n).rotate(p?-90:90));else if(L.remain(t)<=2)_=s,s=O.read(t);else if(!n.equals(s)){var D=t0.read(t),B=$.isZero;if(B(D.width)||B(D.height))return this.lineTo(s);var j=L.read(t),p=!!L.read(t),o=!!L.read(t),l=n.add(s).divide(2),w=n.subtract(l).rotate(-j),S=w.x,C=w.y,G=u(D.width),k=u(D.height),c=G*G,N=k*k,M=S*S,R=C*C,q=h(M/c+R/N);if(q>1)G*=q,k*=q,c=G*G,N=k*k;if(q=(c*N-c*R-N*M)/(c*R+N*M),u(q)<0.000000000001)q=0;if(q<0)throw new Error("Cannot create an arc with the given arguments");if(g=new O(G*C/k,-k*S/G).multiply((o===p?-1:1)*h(q)).rotate(j).add(l),P=new B0().translate(g).rotate(j).scale(G,k),b=P._inverseTransform(n),d=b.getDirectedAngle(P._inverseTransform(s)),!p&&d>0)d-=360;else if(p&&d<0)d+=360}if(_){var z=new Y0(n.add(_).divide(2),_.subtract(n).rotate(90),!0),a=new Y0(_.add(s).divide(2),s.subtract(_).rotate(90),!0),A=new Y0(n,s),e=A.getSide(_);if(g=z.intersect(a,!0),!g){if(!e)return this.lineTo(s);throw new Error("Cannot create an arc with the given arguments")}b=n.subtract(g),d=b.getDirectedAngle(s.subtract(g));var X=A.getSide(g,!0);if(X===0)d=e*u(d);else if(e===X)d+=d<0?360:-360}if(d){var K=0.00001,Q=u(d),h0=Q>=360?4:Math.ceil((Q-K)/90),p0=d/h0,x0=p0*Math.PI/360,b0=1.3333333333333333*Math.sin(x0)/(1+Math.cos(x0)),v0=[];for(var _0=0;_0<=h0;_0++){var w=s,s0=null;if(_0<h0)if(s0=b.rotate(90).multiply(b0),P)w=P._transformPoint(b),s0=P._transformPoint(b.add(s0)).subtract(w);else w=g.add(b);if(!_0)v.setHandleOut(s0);else{var E0=b.rotate(-90).multiply(b0);if(P)E0=P._transformPoint(b.add(E0)).subtract(w);v0.push(new J(w,E0,s0))}b=b.rotate(p0)}this._add(v0)}},lineBy:function(){var t=O.read(arguments),u=i(this)._point;this.lineTo(u.add(t))},curveBy:function(){var t=arguments,u=O.read(t),h=O.read(t),v=L.read(t),n=i(this)._point;this.curveTo(n.add(u),n.add(h),v)},cubicCurveBy:function(){var t=arguments,u=O.read(t),h=O.read(t),v=O.read(t),n=i(this)._point;this.cubicCurveTo(n.add(u),n.add(h),n.add(v))},quadraticCurveBy:function(){var t=arguments,u=O.read(t),h=O.read(t),v=i(this)._point;this.quadraticCurveTo(v.add(u),v.add(h))},arcBy:function(){var t=arguments,u=i(this)._point,h=u.add(O.read(t)),v=L.pick(L.peek(t),!0);if(typeof v==="boolean")this.arcTo(h,v);else this.arcTo(h,u.add(O.read(t)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(i,t){var u=t.handle?"getHandleBounds":t.stroke?"getStrokeBounds":"getBounds";return d0[u](this._segments,this._closed,this,i,t)},statics:{getBounds:function(i,t,u,h,v,n){var s=i[0];if(!s)return new m0;var x=new Array(6),p=s._transformCoordinates(h,new Array(6)),g=p.slice(0,2),d=g.slice(),b=new Array(2);function P(D){D._transformCoordinates(h,x);for(var B=0;B<2;B++)W._addBounds(p[B],p[B+4],x[B+2],x[B],B,n?n[B]:0,g,d,b);var j=p;p=x,x=j}for(var l=1,_=i.length;l<_;l++)P(i[l]);if(t)P(s);return new m0(g[0],g[1],d[0]-g[0],d[1]-g[1])},getStrokeBounds:function(i,t,u,h,v){var n=u.getStyle(),s=n.hasStroke(),x=n.getStrokeWidth(),p=s&&u._getStrokeMatrix(h,v),g=s&&d0._getStrokePadding(x,p),d=d0.getBounds(i,t,u,h,v,g);if(!s)return d;var b=x/2,P=n.getStrokeJoin(),l=n.getStrokeCap(),_=n.getMiterLimit(),D=new m0(new t0(g));function B(G){d=d.include(G)}function j(G){d=d.unite(D.setCenter(G._point.transform(h)))}function o(G,k){if(k==="round"||G.isSmooth())j(G);else d0._addBevelJoin(G,k,b,_,h,p,B)}function w(G,k){if(k==="round")j(G);else d0._addSquareCap(G,k,b,h,p,B)}var S=i.length-(t?0:1);if(S>0){for(var C=1;C<S;C++)o(i[C],P);if(t)o(i[0],P);else w(i[0],l),w(i[i.length-1],l)}return d},_getStrokePadding:function(i,t){if(!t)return[i,i];var u=new O(i,0).transform(t),h=new O(0,i).transform(t),v=u.getAngleInRadians(),n=u.getLength(),s=h.getLength(),x=Math.sin(v),p=Math.cos(v),g=Math.tan(v),d=Math.atan2(s*g,n),b=Math.atan2(s,g*n);return[Math.abs(n*Math.cos(d)*p+s*Math.sin(d)*x),Math.abs(s*Math.sin(b)*p+n*Math.cos(b)*x)]},_addBevelJoin:function(i,t,u,h,v,n,s,x){var p=i.getCurve(),g=p.getPrevious(),d=p.getPoint1().transform(v),b=g.getNormalAtTime(1).multiply(u).transform(n),P=p.getNormalAtTime(0).multiply(u).transform(n),l=b.getDirectedAngle(P);if(l<0||l>=180)b=b.negate(),P=P.negate();if(x)s(d);if(s(d.add(b)),t==="miter"){var _=new Y0(d.add(b),new O(-b.y,b.x),!0).intersect(new Y0(d.add(P),new O(-P.y,P.x),!0),!0);if(_&&d.getDistance(_)<=h*u)s(_)}s(d.add(P))},_addSquareCap:function(i,t,u,h,v,n,s){var x=i._point.transform(h),p=i.getLocation(),g=p.getNormal().multiply(p.getTime()===0?u:-u).transform(v);if(t==="square"){if(s)n(x.subtract(g)),n(x.add(g));x=x.add(g.rotate(-90))}n(x.add(g)),n(x.subtract(g))},getHandleBounds:function(i,t,u,h,v){var n=u.getStyle(),s=v.stroke&&n.hasStroke(),x,p;if(s){var g=u._getStrokeMatrix(h,v),d=n.getStrokeWidth()/2,b=d;if(n.getStrokeJoin()==="miter")b=d*n.getMiterLimit();if(n.getStrokeCap()==="square")b=Math.max(b,d*Math.SQRT2);x=d0._getStrokePadding(d,g),p=d0._getStrokePadding(b,g)}var P=new Array(6),l=Infinity,_=-l,D=l,B=_;for(var j=0,o=i.length;j<o;j++){var w=i[j];w._transformCoordinates(h,P);for(var S=0;S<6;S+=2){var C=!S?p:x,G=C?C[0]:0,k=C?C[1]:0,c=P[S],N=P[S+1],M=c-G,R=c+G,q=N-k,z=N+k;if(M<l)l=M;if(R>_)_=R;if(q<D)D=q;if(z>B)B=z}}return new m0(l,D,_-l,B-D)}}});d0.inject({statics:new function(){var i=0.5522847498307936,t=[new J([-1,0],[0,i],[0,-i]),new J([0,-1],[-i,0],[i,0]),new J([1,0],[0,-i],[0,i]),new J([0,1],[i,0],[-i,0])];function u(v,n,s){var x=L.getNamed(s),p=new d0(x&&(x.insert==!0?l0.INSERT:x.insert==!1?l0.NO_INSERT:null));return p._add(v),p._closed=n,p.set(x,l0.INSERT)}function h(v,n,s){var x=new Array(4);for(var p=0;p<4;p++){var g=t[p];x[p]=new J(g._point.multiply(n).add(v),g._handleIn.multiply(n),g._handleOut.multiply(n))}return u(x,!0,s)}return{Line:function(){var v=arguments;return u([new J(O.readNamed(v,"from")),new J(O.readNamed(v,"to"))],!1,v)},Circle:function(){var v=arguments,n=O.readNamed(v,"center"),s=L.readNamed(v,"radius");return h(n,new t0(s),v)},Rectangle:function(){var v=arguments,n=m0.readNamed(v,"rectangle"),s=t0.readNamed(v,"radius",0,{readNull:!0}),x=n.getBottomLeft(!0),p=n.getTopLeft(!0),g=n.getTopRight(!0),d=n.getBottomRight(!0),b;if(!s||s.isZero())b=[new J(x),new J(p),new J(g),new J(d)];else{s=t0.min(s,n.getSize(!0).divide(2));var{width:P,height:l}=s,_=P*i,D=l*i;b=[new J(x.add(P,0),null,[-_,0]),new J(x.subtract(0,l),[0,D]),new J(p.add(0,l),null,[0,-D]),new J(p.add(P,0),[-_,0],null),new J(g.subtract(P,0),null,[_,0]),new J(g.add(0,l),[0,-D],null),new J(d.subtract(0,l),null,[0,D]),new J(d.subtract(P,0),[_,0])]}return u(b,!0,v)},RoundRectangle:"#Rectangle",Ellipse:function(){var v=arguments,n=f0._readEllipse(v);return h(n.center,n.radius,v)},Oval:"#Ellipse",Arc:function(){var v=arguments,n=O.readNamed(v,"from"),s=O.readNamed(v,"through"),x=O.readNamed(v,"to"),p=L.getNamed(v),g=new d0(p&&p.insert==!1&&l0.NO_INSERT);return g.moveTo(n),g.arcTo(s,x),g.set(p)},RegularPolygon:function(){var v=arguments,n=O.readNamed(v,"center"),s=L.readNamed(v,"sides"),x=L.readNamed(v,"radius"),p=360/s,g=s%3===0,d=new O(0,g?-x:x),b=g?-1:0.5,P=new Array(s);for(var l=0;l<s;l++)P[l]=new J(n.add(d.rotate((l+b)*p)));return u(P,!0,v)},Star:function(){var v=arguments,n=O.readNamed(v,"center"),s=L.readNamed(v,"points")*2,x=L.readNamed(v,"radius1"),p=L.readNamed(v,"radius2"),g=360/s,d=new O(0,-1),b=new Array(s);for(var P=0;P<s;P++)b[P]=new J(n.add(d.rotate(g*P).multiply(P%2?p:x)));return u(b,!0,v)}}}});var T0=i6.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function i(t){if(this._children=[],this._namedChildren={},!this._initialize(t))if(typeof t==="string")this.setPathData(t);else this.addChildren(Array.isArray(t)?t:arguments)},insertChildren:function i(t,u){var h=u,v=h[0];if(v&&typeof v[0]==="number")h=[h];for(var n=u.length-1;n>=0;n--){var s=h[n];if(h===u&&!(s instanceof d0))h=L.slice(h);if(Array.isArray(s))h[n]=new d0({segments:s,insert:!1});else if(s instanceof T0)h.splice.apply(h,[n,1].concat(s.removeChildren())),s.remove()}return i.base.call(this,t,h)},reduce:function i(t){var u=this._children;for(var h=u.length-1;h>=0;h--){var v=u[h].reduce(t);if(v.isEmpty())v.remove()}if(!u.length){var v=new d0(l0.NO_INSERT);return v.copyAttributes(this),v.insertAbove(this),this.remove(),v}return i.base.call(this)},isClosed:function(){var i=this._children;for(var t=0,u=i.length;t<u;t++)if(!i[t]._closed)return!1;return!0},setClosed:function(i){var t=this._children;for(var u=0,h=t.length;u<h;u++)t[u].setClosed(i)},getFirstSegment:function(){var i=this.getFirstChild();return i&&i.getFirstSegment()},getLastSegment:function(){var i=this.getLastChild();return i&&i.getLastSegment()},getCurves:function(){var i=this._children,t=[];for(var u=0,h=i.length;u<h;u++)L.push(t,i[u].getCurves());return t},getFirstCurve:function(){var i=this.getFirstChild();return i&&i.getFirstCurve()},getLastCurve:function(){var i=this.getLastChild();return i&&i.getLastCurve()},getArea:function(){var i=this._children,t=0;for(var u=0,h=i.length;u<h;u++)t+=i[u].getArea();return t},getLength:function(){var i=this._children,t=0;for(var u=0,h=i.length;u<h;u++)t+=i[u].getLength();return t},getPathData:function(i,t){var u=this._children,h=[];for(var v=0,n=u.length;v<n;v++){var s=u[v],x=s._matrix;h.push(s.getPathData(i&&!x.isIdentity()?i.appended(x):i,t))}return h.join("")},_hitTestChildren:function i(t,u,h){return i.base.call(this,t,u.class===d0||u.type==="path"?u:L.set({},u,{fill:!1}),h)},_draw:function(i,t,u,h){var v=this._children;if(!v.length)return;t=t.extend({dontStart:!0,dontFinish:!0}),i.beginPath();for(var n=0,s=v.length;n<s;n++)v[n].draw(i,t,h);if(!t.clip){this._setStyles(i,t,u);var x=this._style;if(x.hasFill())i.fill(x.getFillRule()),i.shadowColor="rgba(0,0,0,0)";if(x.hasStroke())i.stroke()}},_drawSelected:function(i,t,u){var h=this._children;for(var v=0,n=h.length;v<n;v++){var s=h[v],x=s._matrix;if(!u[s._id])s._drawSelected(i,x.isIdentity()?t:t.appended(x))}}},new function(){function i(t,u){var h=t._children;if(u&&!h.length)throw new Error("Use a moveTo() command first");return h[h.length-1]}return L.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(t){this[t]=function(){var u=i(this,!0);u[t].apply(u,arguments)}},{moveTo:function(){var t=i(this),u=t&&t.isEmpty()?t:new d0(l0.NO_INSERT);if(u!==t)this.addChild(u);u.moveTo.apply(u,arguments)},moveBy:function(){var t=i(this,!0),u=t&&t.getLastSegment(),h=O.read(arguments);this.moveTo(u?h.add(u._point):h)},closePath:function(t){i(this,!0).closePath(t)}})},L.each(["reverse","flatten","simplify","smooth"],function(i){this[i]=function(t){var u=this._children,h;for(var v=0,n=u.length;v<n;v++)h=u[v][i](t)||h;return h}},{}));i6.inject(new function(){var{min:i,max:t,abs:u}=Math,h={unite:{"1":!0,"2":!0},intersect:{"2":!0},subtract:{"1":!0},exclude:{"1":!0,"-1":!0}};function v(j){return j._children||[j]}function n(j,o){var w=j.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(o){var S=v(w);for(var C=0,G=S.length;C<G;C++){var j=S[C];if(!j._closed&&!j.isEmpty())j.closePath(0.000000000001),j.getFirstSegment().setHandleIn(0,0),j.getLastSegment().setHandleOut(0,0)}w=w.resolveCrossings().reorient(w.getFillRule()==="nonzero",!0)}return w}function s(j,o,w,S,C){var G=new T0(l0.NO_INSERT);if(G.addChildren(j,!0),G=G.reduce({simplify:o}),!(C&&C.insert==!1))G.insertAbove(S&&w.isSibling(S)&&w.getIndex()<S.getIndex()?S:w);return G.copyAttributes(w,!0),G}function x(j){return j.hasOverlap()||j.isCrossing()}function p(j,o,w,S){if(S&&(S.trace==!1||S.stroke)&&/^(subtract|intersect)$/.test(w))return g(j,o,w);var C=n(j,!0),G=o&&j!==o&&n(o,!0),k=h[w];if(k[w]=!0,G&&(k.subtract||k.exclude)^(G.isClockwise()^C.isClockwise()))G.reverse();var c=l(e0.expand(C.getIntersections(G,x))),N=v(C),M=G&&v(G),R=[],q=[],z;function a(s0){for(var E0=0,j0=s0.length;E0<j0;E0++){var L0=s0[E0];L.push(R,L0._segments),L.push(q,L0.getCurves()),L0._overlapsOnly=!0}}function A(s0){var E0=[];for(var j0=0,L0=s0&&s0.length;j0<L0;j0++)E0.push(q[s0[j0]]);return E0}if(c.length){if(a(N),M)a(M);var e=new Array(q.length);for(var X=0,K=q.length;X<K;X++)e[X]=q[X].getValues();var Q=g0.findCurveBoundsCollisions(e,e,0,!0),h0={};for(var X=0;X<q.length;X++){var p0=q[X],x0=p0._path._id,b0=h0[x0]=h0[x0]||{};b0[p0.getIndex()]={hor:A(Q[X].hor),ver:A(Q[X].ver)}}for(var X=0,K=c.length;X<K;X++)D(c[X]._segment,C,G,h0,k);for(var X=0,K=R.length;X<K;X++){var v0=R[X],_0=v0._intersection;if(!v0._winding)D(v0,C,G,h0,k);if(!(_0&&_0._overlap))v0._path._overlapsOnly=!1}z=B(R,k)}else z=P(M?N.concat(M):N.slice(),function(s0){return!!k[s0]});return s(z,!0,j,o,S)}function g(j,o,w){var S=n(j),C=n(o),G=S.getIntersections(C,x),k=w==="subtract",c=w==="divide",N={},M=[];function R(a){if(!N[a._id]&&(c||C.contains(a.getPointAt(a.getLength()/2))^k))return M.unshift(a),N[a._id]=!0}for(var q=G.length-1;q>=0;q--){var z=G[q].split();if(z){if(R(z))z.getFirstSegment().setHandleIn(0,0);S.getLastSegment().setHandleOut(0,0)}}return R(S),s(M,!1,j,o)}function d(j,o){var w=j;while(w){if(w===o)return;w=w._previous}while(j._next&&j._next!==o)j=j._next;if(!j._next){while(o._previous)o=o._previous;j._next=o,o._previous=j}}function b(j){for(var o=j.length-1;o>=0;o--)j[o].clearHandles()}function P(j,o,w){var S=j&&j.length;if(S){var C=L.each(j,function(Q,h0){this[Q._id]={container:null,winding:Q.isClockwise()?1:-1,index:h0}},{}),G=j.slice().sort(function(Q,h0){return u(h0.getArea())-u(Q.getArea())}),k=G[0],c=g0.findItemBoundsCollisions(G,null,$.GEOMETRIC_EPSILON);if(w==null)w=k.isClockwise();for(var N=0;N<S;N++){var M=G[N],R=C[M._id],q=0,z=c[N];if(z){var a=null;for(var A=z.length-1;A>=0;A--)if(z[A]<N){a=a||M.getInteriorPoint();var e=G[z[A]];if(e.contains(a)){var X=C[e._id];q=X.winding,R.winding+=q,R.container=X.exclude?X.container:e;break}}}if(o(R.winding)===o(q))R.exclude=!0,j[R.index]=null;else{var K=R.container;M.setClockwise(K?!K.isClockwise():w)}}}return j}function l(j,o,w){var S=o&&[],C=0.00000001,G=1-C,k=!1,c=w||[],N=w&&{},M,R,q;function z(E0){return E0._path._id+"."+E0._segment1._index}for(var a=(w&&w.length)-1;a>=0;a--){var A=w[a];if(A._path)N[z(A)]=!0}for(var a=j.length-1;a>=0;a--){var e=j[a],X=e._time,K=X,Q=o&&!o(e),A=e._curve,h0;if(A){if(A!==R)k=!A.hasHandles()||N&&N[z(A)],M=[],q=null,R=A;else if(q>=C)X/=q}if(Q){if(M)M.push(e);continue}else if(o)S.unshift(e);if(q=K,X<C)h0=A._segment1;else if(X>G)h0=A._segment2;else{var p0=A.divideAtTime(X,!0);if(k)c.push(A,p0);h0=p0._segment1;for(var x0=M.length-1;x0>=0;x0--){var b0=M[x0];b0._time=(b0._time-X)/(1-X)}}e._setSegment(h0);var v0=h0._intersection,_0=e._intersection;if(v0){d(v0,_0);var s0=v0;while(s0)d(s0._intersection,v0),s0=s0._next}else h0._intersection=_0}if(!w)b(c);return S||j}function _(j,o,w,S,C){var G=Array.isArray(o)?o:o[w?"hor":"ver"],k=w?1:0,c=k^1,N=[j.x,j.y],M=N[k],R=N[c],q=0.000000001,z=0.000001,a=M-q,A=M+q,e=0,X=0,K=0,Q=0,h0=!1,p0=!1,x0=1,b0=[],v0,_0;function s0(a0){var $0=a0[c+0],d6=a0[c+6];if(R<i($0,d6)||R>t($0,d6))return;var v6=a0[k+0],L6=a0[k+2],J6=a0[k+4],k6=a0[k+6];if($0===d6){if(v6<A&&k6>a||k6<A&&v6>a)h0=!0;return}var R6=R===$0?0:R===d6?1:a>t(v6,L6,J6,k6)||A<i(v6,L6,J6,k6)?1:W.solveCubic(a0,c,R,b0,0,1)>0?b0[0]:1,P6=R6===0?v6:R6===1?k6:W.getPoint(a0,R6)[w?"y":"x"],S6=$0>d6?1:-1,s4=v0[c]>v0[c+6]?1:-1,a6=v0[k+6];if(R!==$0){if(P6<a)K+=S6;else if(P6>A)Q+=S6;else h0=!0;if(P6>M-z&&P6<M+z)x0/=2}else{if(S6!==s4){if(v6<a)K+=S6;else if(v6>A)Q+=S6}else if(v6!=a6){if(a6<A&&P6>A)Q+=S6,h0=!0;else if(a6>a&&P6<a)K+=S6,h0=!0}x0/=4}return v0=a0,!C&&P6>a&&P6<A&&W.getTangent(a0,R6)[w?"x":"y"]===0&&_(j,o,!w,S,!0)}function E0(a0){var $0=a0[c+0],d6=a0[c+2],v6=a0[c+4],L6=a0[c+6];if(R<=t($0,d6,v6,L6)&&R>=i($0,d6,v6,L6)){var J6=a0[k+0],k6=a0[k+2],R6=a0[k+4],P6=a0[k+6],S6=a>t(J6,k6,R6,P6)||A<i(J6,k6,R6,P6)?[a0]:W.getMonoCurves(a0,w),s4;for(var a6=0,l8=S6.length;a6<l8;a6++)if(s4=s0(S6[a6]))return s4}}for(var j0=0,L0=G.length;j0<L0;j0++){var k0=G[j0],D0=k0._path,u6=k0.getValues(),h6;if(!j0||G[j0-1]._path!==D0){if(v0=null,!D0._closed){if(_0=W.getValues(D0.getLastCurve().getSegment2(),k0.getSegment1(),null,!S),_0[c]!==_0[c+6])v0=_0}if(!v0){v0=u6;var s6=D0.getLastCurve();while(s6&&s6!==k0){var Q0=s6.getValues();if(Q0[c]!==Q0[c+6]){v0=Q0;break}s6=s6.getPrevious()}}}if(h6=E0(u6))return h6;if(j0+1===L0||G[j0+1]._path!==D0){if(_0&&(h6=E0(_0)))return h6;if(h0&&!K&&!Q)K=Q=D0.isClockwise(S)^w?1:-1;if(e+=K,X+=Q,K=Q=0,h0)p0=!0,h0=!1;_0=null}}return e=u(e),X=u(X),{winding:t(e,X),windingL:e,windingR:X,quality:x0,onPath:p0}}function D(j,o,w,S,C){var G=[],k=j,c=0,q;do{var N=j.getCurve();if(N){var M=N.getLength();G.push({segment:j,curve:N,length:M}),c+=M}j=j.getNext()}while(j&&!j._intersection&&j!==k);var R=[0.5,0.25,0.75],q={winding:0,quality:-1},z=0.001,a=1-z;for(var A=0;A<R.length&&q.quality<0.5;A++){var M=c*R[A];for(var e=0,X=G.length;e<X;e++){var K=G[e],Q=K.length;if(M<=Q){var N=K.curve,h0=N._path,p0=h0._parent,x0=p0 instanceof T0?p0:h0,b0=$.clamp(N.getTimeAt(M),z,a),v0=N.getPointAtTime(b0),_0=u(N.getTangentAtTime(b0).y)<Math.SQRT1_2,s0=null;if(C.subtract&&w){var E0=x0===o?w:o,j0=E0._getWinding(v0,_0,!0);if(x0===o&&j0.winding||x0===w&&!j0.winding)if(j0.quality<1)continue;else s0={winding:0,quality:1}}if(s0=s0||_(v0,S[h0._id][N.getIndex()],_0,!0),s0.quality>q.quality)q=s0;break}M-=Q}}for(var e=G.length-1;e>=0;e--)G[e].segment._winding=q}function B(j,o){var w=[],S;function C(L0){var k0;return!!(L0&&!L0._visited&&(!o||o[(k0=L0._winding||{}).winding]&&!(o.unite&&k0.winding===2&&k0.windingL&&k0.windingR)))}function G(L0){if(L0){for(var k0=0,D0=S.length;k0<D0;k0++)if(L0===S[k0])return!0}return!1}function k(L0){var k0=L0._segments;for(var D0=0,u6=k0.length;D0<u6;D0++)k0[D0]._visited=!0}function c(L0,k0){var D0=L0._intersection,u6=D0,h6=[];if(k0)S=[L0];function s6(Q0,a0){while(Q0&&Q0!==a0){var $0=Q0._segment,d6=$0&&$0._path;if(d6){var v6=$0.getNext()||d6.getFirstSegment(),L6=v6._intersection;if($0!==L0&&(G($0)||G(v6)||v6&&(C($0)&&(C(v6)||L6&&C(L6._segment)))))h6.push($0);if(k0)S.push($0)}Q0=Q0._next}}if(D0){s6(D0);while(D0&&D0._previous)D0=D0._previous;s6(D0,u6)}return h6}j.sort(function(L0,k0){var D0=L0._intersection,u6=k0._intersection,h6=!!(D0&&D0._overlap),s6=!!(u6&&u6._overlap),Q0=L0._path,a0=k0._path;return h6^s6?h6?1:-1:!D0^!u6?D0?1:-1:Q0!==a0?Q0._id-a0._id:L0._index-k0._index});for(var N=0,M=j.length;N<M;N++){var R=j[N],q=C(R),z=null,a=!1,A=!0,e=[],X,K,Q;if(q&&R._path._overlapsOnly){var h0=R._path,p0=R._intersection._segment._path;if(h0.compare(p0)){if(h0.getArea())w.push(h0.clone(!1));k(h0),k(p0),q=!1}}while(q){var x0=!z,b0=c(R,x0),v0=b0.shift(),a=!x0&&(G(R)||G(v0)),_0=!a&&v0;if(x0)z=new d0(l0.NO_INSERT),X=null;if(a){if(R.isFirst()||R.isLast())A=R._path._closed;R._visited=!0;break}if(_0&&X)e.push(X),X=null;if(!X){if(_0)b0.push(R);X={start:z._segments.length,crossings:b0,visited:K=[],handleIn:Q}}if(_0)R=v0;if(!C(R)){z.removeSegments(X.start);for(var s0=0,E0=K.length;s0<E0;s0++)K[s0]._visited=!1;K.length=0;do if(R=X&&X.crossings.shift(),!R||!R._path){if(R=null,X=e.pop(),X)K=X.visited,Q=X.handleIn}while(X&&!C(R));if(!R)break}var j0=R.getNext();z.add(new J(R._point,Q,j0&&R._handleOut)),R._visited=!0,K.push(R),R=j0||R._path.getFirstSegment(),Q=j0&&j0._handleIn}if(a){if(A)z.getFirstSegment().setHandleIn(Q),z.setClosed(A);if(z.getArea()!==0)w.push(z)}}return w}return{_getWinding:function(j,o,w){return _(j,this.getCurves(),o,w)},unite:function(j,o){return p(this,j,"unite",o)},intersect:function(j,o){return p(this,j,"intersect",o)},subtract:function(j,o){return p(this,j,"subtract",o)},exclude:function(j,o){return p(this,j,"exclude",o)},divide:function(j,o){return o&&(o.trace==!1||o.stroke)?g(this,j,"divide"):s([this.subtract(j,o),this.intersect(j,o)],!0,this,j,o)},resolveCrossings:function(){var j=this._children,o=j||[this];function w(X,K){var Q=X&&X._intersection;return Q&&Q._overlap&&Q._path===K}var S=!1,C=!1,G=this.getIntersections(null,function(X){return X.hasOverlap()&&(S=!0)||X.isCrossing()&&(C=!0)}),k=S&&C&&[];if(G=e0.expand(G),S){var c=l(G,function(X){return X.hasOverlap()},k);for(var N=c.length-1;N>=0;N--){var M=c[N],R=M._path,q=M._segment,z=q.getPrevious(),a=q.getNext();if(w(z,R)&&w(a,R)){if(q.remove(),z._handleOut._set(0,0),a._handleIn._set(0,0),z!==q&&!z.getCurve().hasLength())a._handleIn.set(z._handleIn),z.remove()}}}if(C){if(l(G,S&&function(X){var K=X.getCurve(),Q=X.getSegment(),h0=X._intersection,p0=h0._curve,x0=h0._segment;if(K&&p0&&K._path&&p0._path)return!0;if(Q)Q._intersection=null;if(x0)x0._intersection=null},k),k)b(k);o=B(L.each(o,function(X){L.push(this,X._segments)},[]))}var A=o.length,e;if(A>1&&j){if(o!==j)this.setChildren(o);e=this}else if(A===1&&!j){if(o[0]!==this)this.setSegments(o[0].removeSegments());e=this}if(!e)e=new T0(l0.NO_INSERT),e.addChildren(o),e=e.reduce(),e.copyAttributes(this),this.replaceWith(e);return e},reorient:function(j,o){var w=this._children;if(w&&w.length)this.setChildren(P(this.removeChildren(),function(S){return!!(j?S:S&1)},o));else if(o!==V)this.setClockwise(o);return this},getInteriorPoint:function(){var j=this.getBounds(),o=j.getCenter(!0);if(!this.contains(o)){var w=this.getCurves(),S=o.y,C=[],G=[];for(var k=0,c=w.length;k<c;k++){var N=w[k].getValues(),M=N[1],R=N[3],q=N[5],z=N[7];if(S>=i(M,R,q,z)&&S<=t(M,R,q,z)){var a=W.getMonoCurves(N);for(var A=0,e=a.length;A<e;A++){var X=a[A],K=X[1],Q=X[7];if(K!==Q&&(S>=K&&S<=Q||S>=Q&&S<=K)){var h0=S===K?X[0]:S===Q?X[6]:W.solveCubic(X,1,S,G,0,1)===1?W.getPoint(X,G[0]).x:(X[0]+X[6])/2;C.push(h0)}}}}if(C.length>1)C.sort(function(p0,x0){return p0-x0}),o.x=(C[0]+C[1])/2}return o}}});var f6=L.extend({_class:"PathFlattener",initialize:function(i,t,u,h,v){var n=[],s=[],x=0,p=1/(u||32),g=i._segments,d=g[0],b;function P(B,j){var o=W.getValues(B,j,v);n.push(o),l(o,B._index,0,1)}function l(B,j,o,w){if(w-o>p&&!(h&&W.isStraight(B))&&!W.isFlatEnough(B,t||0.25)){var S=W.subdivide(B,0.5),C=(o+w)/2;l(S[0],j,o,C),l(S[1],j,C,w)}else{var G=B[6]-B[0],k=B[7]-B[1],c=Math.sqrt(G*G+k*k);if(c>0)x+=c,s.push({offset:x,curve:B,index:j,time:w})}}for(var _=1,D=g.length;_<D;_++)b=g[_],P(d,b),d=b;if(i._closed)P(b||d,g[0]);this.curves=n,this.parts=s,this.length=x,this.index=0},_get:function(i){var t=this.parts,u=t.length,h,v,n=this.index;for(;;)if(v=n,!n||t[--n].offset<i)break;for(;v<u;v++){var s=t[v];if(s.offset>=i){this.index=v;var x=t[v-1],p=x&&x.index===s.index?x.time:0,g=x?x.offset:0;return{index:s.index,time:p+(s.time-p)*(i-g)/(s.offset-g)}}}return{index:t[u-1].index,time:1}},drawPart:function(i,t,u){var h=this._get(t),v=this._get(u);for(var n=h.index,s=v.index;n<=s;n++){var x=W.getPart(this.curves[n],n===h.index?h.time:0,n===v.index?v.time:1);if(n===h.index)i.moveTo(x[0],x[1]);i.bezierCurveTo.apply(i,x.slice(2))}}},L.each(W._evaluateMethods,function(i){this[i+"At"]=function(t){var u=this._get(t);return W[i](this.curves[u.index],u.time)}},{})),W0=L.extend({initialize:function(i){var t=this.points=[],u=i._segments,h=i._closed;for(var v=0,n,s=u.length;v<s;v++){var x=u[v].point;if(!n||!n.equals(x))t.push(n=x.clone())}if(h)t.unshift(t[t.length-1]),t.push(t[1]);this.closed=h},fit:function(i){var t=this.points,u=t.length,h=null;if(u>0){if(h=[new J(t[0])],u>1){if(this.fitCubic(h,i,0,u-1,t[1].subtract(t[0]),t[u-2].subtract(t[u-1])),this.closed)h.shift(),h.pop()}}return h},fitCubic:function(i,t,u,h,v,n){var s=this.points;if(h-u===1){var x=s[u],p=s[h],g=x.getDistance(p)/3;this.addCurve(i,[x,x.add(v.normalize(g)),p.add(n.normalize(g)),p]);return}var d=this.chordLengthParameterize(u,h),b=Math.max(t,t*t),P,l=!0;for(var _=0;_<=4;_++){var D=this.generateBezier(u,h,d,v,n),B=this.findMaxError(u,h,D,d);if(B.error<t&&l){this.addCurve(i,D);return}if(P=B.index,B.error>=b)break;l=this.reparameterize(u,h,d,D),b=B.error}var j=s[P-1].subtract(s[P+1]);this.fitCubic(i,t,u,P,v,j),this.fitCubic(i,t,P,h,j.negate(),n)},addCurve:function(i,t){var u=i[i.length-1];u.setHandleOut(t[1].subtract(t[0])),i.push(new J(t[3],t[2].subtract(t[3])))},generateBezier:function(i,t,u,h,v){var n=0.000000000001,s=Math.abs,x=this.points,p=x[i],g=x[t],d=[[0,0],[0,0]],b=[0,0];for(var P=0,l=t-i+1;P<l;P++){var _=u[P],D=1-_,B=3*_*D,j=D*D*D,o=B*D,w=B*_,S=_*_*_,C=h.normalize(o),G=v.normalize(w),k=x[i+P].subtract(p.multiply(j+o)).subtract(g.multiply(w+S));d[0][0]+=C.dot(C),d[0][1]+=C.dot(G),d[1][0]=d[0][1],d[1][1]+=G.dot(G),b[0]+=C.dot(k),b[1]+=G.dot(k)}var c=d[0][0]*d[1][1]-d[1][0]*d[0][1],N,M;if(s(c)>n){var R=d[0][0]*b[1]-d[1][0]*b[0],q=b[0]*d[1][1]-b[1]*d[0][1];N=q/c,M=R/c}else{var z=d[0][0]+d[0][1],a=d[1][0]+d[1][1];N=M=s(z)>n?b[0]/z:s(a)>n?b[1]/a:0}var A=g.getDistance(p),e=n*A,X,K;if(N<e||M<e)N=M=A/3;else{var Q=g.subtract(p);if(X=h.normalize(N),K=v.normalize(M),X.dot(Q)-K.dot(Q)>A*A)N=M=A/3,X=K=null}return[p,p.add(X||h.normalize(N)),g.add(K||v.normalize(M)),g]},reparameterize:function(i,t,u,h){for(var v=i;v<=t;v++)u[v-i]=this.findRoot(h,this.points[v],u[v-i]);for(var v=1,n=u.length;v<n;v++)if(u[v]<=u[v-1])return!1;return!0},findRoot:function(i,t,u){var h=[],v=[];for(var n=0;n<=2;n++)h[n]=i[n+1].subtract(i[n]).multiply(3);for(var n=0;n<=1;n++)v[n]=h[n+1].subtract(h[n]).multiply(2);var s=this.evaluate(3,i,u),x=this.evaluate(2,h,u),p=this.evaluate(1,v,u),g=s.subtract(t),d=x.dot(x)+g.dot(p);return $.isMachineZero(d)?u:u-g.dot(x)/d},evaluate:function(i,t,u){var h=t.slice();for(var v=1;v<=i;v++)for(var n=0;n<=i-v;n++)h[n]=h[n].multiply(1-u).add(h[n+1].multiply(u));return h[0]},chordLengthParameterize:function(i,t){var u=[0];for(var h=i+1;h<=t;h++)u[h-i]=u[h-i-1]+this.points[h].getDistance(this.points[h-1]);for(var h=1,v=t-i;h<=v;h++)u[h]/=u[v];return u},findMaxError:function(i,t,u,h){var v=Math.floor((t-i+1)/2),n=0;for(var s=i+1;s<t;s++){var x=this.evaluate(3,u,h[s-i]),p=x.subtract(this.points[s]),g=p.x*p.x+p.y*p.y;if(g>=n)n=g,v=s}return{error:n,index:v}}}),t6=l0.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function i(t){this._content="",this._lines=[];var u=t&&L.isPlainObject(t)&&t.x===V&&t.y===V;this._initialize(u&&t,!u&&O.read(arguments))},_equals:function(i){return this._content===i._content},copyContent:function(i){this.setContent(i._content)},getContent:function(){return this._content},setContent:function(i){this._content=""+i,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),K0=t6.extend({_class:"PointText",initialize:function i(){t6.apply(this,arguments)},getPoint:function(){var i=this._matrix.getTranslation();return new c0(i.x,i.y,this,"setPoint")},setPoint:function(){var i=O.read(arguments);this.translate(i.subtract(this._matrix.getTranslation()))},_draw:function(i,t,u){if(!this._content)return;this._setStyles(i,t,u);var h=this._lines,v=this._style,n=v.hasFill(),s=v.hasStroke(),x=v.getLeading(),p=i.shadowColor;i.font=v.getFontStyle(),i.textAlign=v.getJustification();for(var g=0,d=h.length;g<d;g++){i.shadowColor=p;var b=h[g];if(n)i.fillText(b,0,0),i.shadowColor="rgba(0,0,0,0)";if(s)i.strokeText(b,0,0);i.translate(0,x)}},_getBounds:function(i,t){var u=this._style,h=this._lines,v=h.length,n=u.getJustification(),s=u.getLeading(),x=this.getView().getTextWidth(u.getFontStyle(),h),p=0;if(n!=="left")p-=x/(n==="center"?2:1);var g=new m0(p,v?-0.75*s:0,x,v*s);return i?i._transformBounds(g,g):g}}),U=L.extend(new function(){var i={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},t={},u={transparent:[0,0,0,0]},h;function v(x){var p=x.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||x.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),g="rgb",d;if(p){var b=p[4]?4:3;d=new Array(b);for(var P=0;P<b;P++){var l=p[P+1];d[P]=parseInt(l.length==1?l+l:l,16)/255}}else if(p=x.match(/^(rgb|hsl)a?\((.*)\)$/)){g=p[1],d=p[2].trim().split(/[,\s]+/g);var _=g==="hsl";for(var P=0,D=Math.min(d.length,4);P<D;P++){var B=d[P],l=parseFloat(B);if(_){if(P===0){var j=B.match(/([a-z]*)$/)[1];l*={turn:360,rad:180/Math.PI,grad:0.9}[j]||1}else if(P<3)l/=100}else if(P<3)l/=/%$/.test(B)?100:255;d[P]=l}}else{var o=u[x];if(!o)if(T){if(!h)h=Z0.getContext(1,1,{willReadFrequently:!0}),h.globalCompositeOperation="copy";h.fillStyle="rgba(0,0,0,0)",h.fillStyle=x,h.fillRect(0,0,1,1);var w=h.getImageData(0,0,1,1).data;o=u[x]=[w[0]/255,w[1]/255,w[2]/255]}else o=[0,0,0];d=o.slice()}return[g,d]}var n=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],s={"rgb-hsb":function(x,p,g){var d=Math.max(x,p,g),b=Math.min(x,p,g),P=d-b,l=P===0?0:(d==x?(p-g)/P+(p<g?6:0):d==p?(g-x)/P+2:(x-p)/P+4)*60;return[l,d===0?0:P/d,d]},"hsb-rgb":function(x,p,g){x=(x/60%6+6)%6;var b=Math.floor(x),d=x-b,b=n[b],P=[g,g*(1-p),g*(1-p*d),g*(1-p*(1-d))];return[P[b[0]],P[b[1]],P[b[2]]]},"rgb-hsl":function(x,p,g){var d=Math.max(x,p,g),b=Math.min(x,p,g),P=d-b,l=P===0,_=l?0:(d==x?(p-g)/P+(p<g?6:0):d==p?(g-x)/P+2:(x-p)/P+4)*60,D=(d+b)/2,B=l?0:D<0.5?P/(d+b):P/(2-d-b);return[_,B,D]},"hsl-rgb":function(x,p,g){if(x=(x/360%1+1)%1,p===0)return[g,g,g];var d=[x+0.3333333333333333,x,x-0.3333333333333333],b=g<0.5?g*(1+p):g+p-g*p,P=2*g-b,l=[];for(var _=0;_<3;_++){var D=d[_];if(D<0)D+=1;if(D>1)D-=1;l[_]=6*D<1?P+(b-P)*6*D:2*D<1?b:3*D<2?P+(b-P)*(0.6666666666666666-D)*6:P}return l},"rgb-gray":function(x,p,g){return[x*0.2989+p*0.587+g*0.114]},"gray-rgb":function(x){return[x,x,x]},"gray-hsb":function(x){return[0,0,x]},"gray-hsl":function(x){return[0,0,x]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return L.each(i,function(x,p){t[p]=[],L.each(x,function(g,d){var b=L.capitalize(g),P=/^(hue|saturation)$/.test(g),l=t[p][d]=p==="gradient"?g==="gradient"?function(_){var D=this._components[0];if(_=o0.read(Array.isArray(_)?_:arguments,0,{readNull:!0}),D!==_){if(D)D._removeOwner(this);if(_)_._addOwner(this)}return _}:function(){return O.read(arguments,0,{readNull:g==="highlight",clone:!0})}:function(_){return _==null||isNaN(_)?0:+_};this["get"+b]=function(){return this._type===p||P&&/^hs[bl]$/.test(this._type)?this._components[d]:this._convert(p)[d]},this["set"+b]=function(_){if(this._type!==p&&!(P&&/^hs[bl]$/.test(this._type)))this._components=this._convert(p),this._properties=i[p],this._type=p;this._components[d]=l.call(this,_),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function x(p){var g=arguments,d=this.__read,b=0,P,l,_,D;if(Array.isArray(p))g=p,p=g[0];var B=p!=null&&typeof p;if(B==="string"&&p in i)if(P=p,p=g[1],Array.isArray(p))l=p,_=g[2];else{if(d)b=1;g=L.slice(g,1),B=typeof p}if(!l){if(D=B==="number"?g:B==="object"&&p.length!=null?p:null,D){if(!P)P=D.length>=3?"rgb":"gray";var j=i[P].length;if(_=D[j],d)b+=D===arguments?j+(_!=null?1:0):1;if(D.length>j)D=L.slice(D,0,j)}else if(B==="string"){var o=v(p);if(P=o[0],l=o[1],l.length===4)_=l[3],l.length--}else if(B==="object")if(p.constructor===x){if(P=p._type,l=p._components.slice(),_=p._alpha,P==="gradient")for(var w=1,S=l.length;w<S;w++){var C=l[w];if(C)l[w]=C.clone()}}else if(p.constructor===o0)P="gradient",D=g;else{P="hue"in p?"lightness"in p?"hsl":"hsb":("gradient"in p)||("stops"in p)||("radial"in p)?"gradient":("gray"in p)?"gray":"rgb";var G=i[P],k=t[P];this._components=l=[];for(var w=0,S=G.length;w<S;w++){var c=p[G[w]];if(c==null&&!w&&P==="gradient"&&"stops"in p)c={stops:p.stops,radial:p.radial};if(c=k[w].call(this,c),c!=null)l[w]=c}_=p.alpha}if(d&&P)b=1}if(this._type=P||"rgb",!l){this._components=l=[];var k=t[this._type];for(var w=0,S=k.length;w<S;w++){var c=k[w].call(this,D&&D[w]);if(c!=null)l[w]=c}}if(this._components=l,this._properties=i[this._type],this._alpha=_,d)this.__read=b;return this},set:"#initialize",_serialize:function(x,p){var g=this.getComponents();return L.serialize(/^(gray|rgb)$/.test(this._type)?g:[this._type].concat(g),x,!0,p)},_changed:function(){if(this._canvasStyle=null,this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(x){var p;return this._type===x?this._components.slice():(p=s[this._type+"-"+x])?p.apply(this,this._components):s["rgb-"+x].apply(this,s[this._type+"-rgb"].apply(this,this._components))},convert:function(x){return new U(x,this._convert(x),this._alpha)},getType:function(){return this._type},setType:function(x){this._components=this._convert(x),this._properties=i[x],this._type=x},getComponents:function(){var x=this._components.slice();if(this._alpha!=null)x.push(this._alpha);return x},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(x){this._alpha=x==null?null:Math.min(Math.max(x,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(x){var p=L.isPlainValue(x,!0)?U.read(arguments):x;return p===this||p&&this._class===p._class&&this._type===p._type&&this.getAlpha()===p.getAlpha()&&L.equals(this._components,p._components)||!1},toString:function(){var x=this._properties,p=[],g=this._type==="gradient",d=y0.instance;for(var b=0,P=x.length;b<P;b++){var l=this._components[b];if(l!=null)p.push(x[b]+": "+(g?l:d.number(l)))}if(this._alpha!=null)p.push("alpha: "+d.number(this._alpha));return"{ "+p.join(", ")+" }"},toCSS:function(x){var p=this._convert("rgb"),g=x||this._alpha==null?1:this._alpha;function d(b){return Math.round((b<0?0:b>1?1:b)*255)}if(p=[d(p[0]),d(p[1]),d(p[2])],g<1)p.push(g<0?0:g);return x?"#"+((1<<24)+(p[0]<<16)+(p[1]<<8)+p[2]).toString(16).slice(1):(p.length==4?"rgba(":"rgb(")+p.join(",")+")"},toCanvasStyle:function(x,p){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var g=this._components,d=g[0],b=d._stops,P=g[1],l=g[2],_=g[3],D=p&&p.inverted(),B;if(D){if(P=D._transformPoint(P),l=D._transformPoint(l),_)_=D._transformPoint(_)}if(d._radial){var j=l.getDistance(P);if(_){var o=_.subtract(P);if(o.getLength()>j)_=P.add(o.normalize(j-0.1))}var w=_||P;B=x.createRadialGradient(w.x,w.y,0,P.x,P.y,j)}else B=x.createLinearGradient(P.x,P.y,l.x,l.y);for(var S=0,C=b.length;S<C;S++){var G=b[S],k=G._offset;B.addColorStop(k==null?S/(C-1):k,G._color.toCanvasStyle())}return this._canvasStyle=B},transform:function(x){if(this._type==="gradient"){var p=this._components;for(var g=1,d=p.length;g<d;g++){var b=p[g];x._transformPoint(b,b,!0)}this._changed()}},statics:{_types:i,random:function(){var x=Math.random;return new U(x(),x(),x())},_setOwner:function(x,p,g){if(x){if(x._owner&&p&&x._owner!==p)x=x.clone();if(!x._owner^!p)x._owner=p||null,x._setter=g||null}return x}}})},new function(){var i={add:function(t,u){return t+u},subtract:function(t,u){return t-u},multiply:function(t,u){return t*u},divide:function(t,u){return t/u}};return L.each(i,function(t,u){this[u]=function(h){h=U.read(arguments);var v=this._type,n=this._components,s=h._convert(v);for(var x=0,p=n.length;x<p;x++)s[x]=t(n[x],s[x]);return new U(v,s,this._alpha!=null?t(this._alpha,h.getAlpha()):null)}},{})}),o0=L.extend({_class:"Gradient",initialize:function i(t,u){if(this._id=r0.get(),t&&L.isPlainObject(t))this.set(t),t=u=null;if(this._stops==null)this.setStops(t||["white","black"]);if(this._radial==null)this.setRadial(typeof u==="string"&&u==="radial"||u||!1)},_serialize:function(i,t){return t.add(this,function(){return L.serialize([this._stops,this._radial],i,!0,t)})},_changed:function(){for(var i=0,t=this._owners&&this._owners.length;i<t;i++)this._owners[i]._changed()},_addOwner:function(i){if(!this._owners)this._owners=[];this._owners.push(i)},_removeOwner:function(i){var t=this._owners?this._owners.indexOf(i):-1;if(t!=-1){if(this._owners.splice(t,1),!this._owners.length)this._owners=V}},clone:function(){var i=[];for(var t=0,u=this._stops.length;t<u;t++)i[t]=this._stops[t].clone();return new o0(i,this._radial)},getStops:function(){return this._stops},setStops:function(i){if(i.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var t=this._stops;if(t)for(var u=0,h=t.length;u<h;u++)t[u]._owner=V;t=this._stops=O0.readList(i,0,{clone:!0});for(var u=0,h=t.length;u<h;u++)t[u]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(i){this._radial=i,this._changed()},equals:function(i){if(i===this)return!0;if(i&&this._class===i._class){var t=this._stops,u=i._stops,h=t.length;if(h===u.length){for(var v=0;v<h;v++)if(!t[v].equals(u[v]))return!1;return!0}}return!1}}),O0=L.extend({_class:"GradientStop",initialize:function i(t,u){var h=t,v=u;if(typeof t==="object"&&u===V){if(Array.isArray(t)&&typeof t[0]!=="number")h=t[0],v=t[1];else if("color"in t||"offset"in t||"rampPoint"in t)h=t.color,v=t.offset||t.rampPoint||0}this.setColor(h),this.setOffset(v)},clone:function(){return new O0(this._color.clone(),this._offset)},_serialize:function(i,t){var u=this._color,h=this._offset;return L.serialize(h==null?[u]:[u,h],i,!0,t)},_changed:function(){if(this._owner)this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(i){this._offset=i,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){U._setOwner(this._color,null),this._color=U._setOwner(U.read(arguments,0),this,"setColor"),this._changed()},equals:function(i){return i===this||i&&this._class===i._class&&this._color.equals(i._color)&&this._offset==i._offset||!1}}),z0=L.extend(new function(){var i={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new O,selectedColor:null},t=L.set({},i,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),u=L.set({},t,{fillColor:new U}),h={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},v={beans:!0},n={_class:"Style",beans:!0,initialize:function s(x,p,g){if(this._values={},this._owner=p,this._project=p&&p._project||g||G0.project,this._defaults=!p||p instanceof J0?t:p instanceof t6?u:i,x)this.set(x)}};return L.each(t,function(s,x){var p=/Color$/.test(x),g=x==="shadowOffset",d=L.capitalize(x),b=h[x],P="set"+d,l="get"+d;n[P]=function(_){var D=this._owner,B=D&&D._children,j=B&&B.length>0&&!(D instanceof T0);if(j)for(var o=0,w=B.length;o<w;o++)B[o]._style[P](_);if((x==="selectedColor"||!j)&&x in this._defaults){var S=this._values[x];if(S!==_){if(p){if(S)U._setOwner(S,null),S._canvasStyle=null;if(_&&_.constructor===U)_=U._setOwner(_,D,j&&P)}if(this._values[x]=_,D)D._changed(b||129)}}},n[l]=function(_){var D=this._owner,B=D&&D._children,j=B&&B.length>0&&!(D instanceof T0),o;if(j&&!_)for(var w=0,S=B.length;w<S;w++){var C=B[w]._style[l]();if(!w)o=C;else if(!L.equals(o,C))return V}else if(x in this._defaults){var o=this._values[x];if(o===V){if(o=this._defaults[x],o&&o.clone)o=o.clone()}else{var G=p?U:g?O:null;if(G&&!(o&&o.constructor===G))this._values[x]=o=G.read([o],0,{readNull:!0,clone:!0})}}if(o&&p)o=U._setOwner(o,D,j&&P);return o},v[l]=function(_){return this._style[l](_)},v[P]=function(_){this._style[P](_)}}),L.each({Font:"FontFamily",WindingRule:"FillRule"},function(s,x){var p="get"+x,g="set"+x;n[p]=v[p]="#get"+s,n[g]=v[g]="#set"+s}),l0.inject(v),n},{set:function(i){var t=i instanceof z0,u=t?i._values:i;if(u){for(var h in u)if(h in this._defaults){var v=u[h];this[h]=v&&t&&v.clone?v.clone():v}}},equals:function(i){function t(u,h,v){var n=u._values,s=h._values,x=h._defaults;for(var p in n){var g=n[p],d=s[p];if(!(v&&(p in s))&&!L.equals(g,d===V?x[p]:d))return!1}return!0}return i===this||i&&this._class===i._class&&t(this,i)&&t(i,this,!0)||!1},_dispose:function(){var i=this.getFillColor();if(i)i._canvasStyle=null;if(i=this.getStrokeColor(),i)i._canvasStyle=null;if(i=this.getShadowColor(),i)i._canvasStyle=null},hasFill:function(){var i=this.getFillColor();return!!i&&i.alpha>0},hasStroke:function(){var i=this.getStrokeColor();return!!i&&i.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var i=this.getShadowColor();return!!i&&i.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var i=this.getFontSize();return this.getFontWeight()+" "+i+(/[a-z]/i.test(i+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function i(){var t=i.base.call(this),u=this.getFontSize();if(/pt|em|%|px/.test(u))u=this.getView().getPixelSize(u);return t!=null?t:u*1.2}}),N0=new function(){function i(t,u,h,v){var n=["","webkit","moz","Moz","ms","o"],s=u[0].toUpperCase()+u.substring(1);for(var x=0;x<6;x++){var p=n[x],g=p?p+s:u;if(g in t){if(h)t[g]=v;else return t[g];break}}}return{getStyles:function(t){var u=t&&t.nodeType!==9?t.ownerDocument:t,h=u&&u.defaultView;return h&&h.getComputedStyle(t,"")},getBounds:function(t,u){var h=t.ownerDocument,v=h.body,n=h.documentElement,s;try{s=t.getBoundingClientRect()}catch(d){s={left:0,top:0,width:0,height:0}}var x=s.left-(n.clientLeft||v.clientLeft||0),p=s.top-(n.clientTop||v.clientTop||0);if(!u){var g=h.defaultView;x+=g.pageXOffset||n.scrollLeft||v.scrollLeft,p+=g.pageYOffset||n.scrollTop||v.scrollTop}return new m0(x,p,s.width,s.height)},getViewportBounds:function(t){var u=t.ownerDocument,h=u.defaultView,v=u.documentElement;return new m0(0,0,h.innerWidth||v.clientWidth,h.innerHeight||v.clientHeight)},getOffset:function(t,u){return N0.getBounds(t,u).getPoint()},getSize:function(t){return N0.getBounds(t,!0).getSize()},isInvisible:function(t){return N0.getSize(t).equals(new t0(0,0))},isInView:function(t){return!N0.isInvisible(t)&&N0.getViewportBounds(t).intersects(N0.getBounds(t,!0))},isInserted:function(t){return F.body.contains(t)},getPrefixed:function(t,u){return t&&i(t,u)},setPrefixed:function(t,u,h){if(typeof u==="object")for(var v in u)i(t,v,!0,u[v]);else i(t,u,!0,h)}}},V0={add:function(i,t){if(i)for(var u in t){var h=t[u],v=u.split(/[\s,]+/g);for(var n=0,s=v.length;n<s;n++){var x=v[n],p=i===F&&(x==="touchstart"||x==="touchmove")?{passive:!1}:!1;i.addEventListener(x,h,p)}}},remove:function(i,t){if(i)for(var u in t){var h=t[u],v=u.split(/[\s,]+/g);for(var n=0,s=v.length;n<s;n++)i.removeEventListener(v[n],h,!1)}},getPoint:function(i){var t=i.targetTouches?i.targetTouches.length?i.targetTouches[0]:i.changedTouches[0]:i;return new O(t.pageX||t.clientX+F.documentElement.scrollLeft,t.pageY||t.clientY+F.documentElement.scrollTop)},getTarget:function(i){return i.target||i.srcElement},getRelatedTarget:function(i){return i.relatedTarget||i.toElement},getOffset:function(i,t){return V0.getPoint(i).subtract(N0.getOffset(t||V0.getTarget(i)))}};V0.requestAnimationFrame=new function(){var i=N0.getPrefixed(T,"requestAnimationFrame"),t=!1,u=[],h;function v(){var n=u;u=[];for(var s=0,x=n.length;s<x;s++)n[s]();if(t=i&&u.length,t)i(v)}return function(n){if(u.push(n),i){if(!t)i(v),t=!0}else if(!h)h=setInterval(v,16.666666666666668)}};var A0=L.extend(Y,{_class:"View",initialize:function i(t,u){function h(b){return u[b]||parseInt(u.getAttribute(b),10)}function v(){var b=N0.getSize(u);return b.isNaN()||b.isZero()?new t0(h("width"),h("height")):b}var n;if(T&&u){if(this._id=u.getAttribute("id"),this._id==null)u.setAttribute("id",this._id="paper-view-"+i._id++);V0.add(u,this._viewEvents);var s="none";if(N0.setPrefixed(u.style,{userDrag:s,userSelect:s,touchCallout:s,contentZooming:s,tapHighlightColor:"rgba(0,0,0,0)"}),H.hasAttribute(u,"resize")){var x=this;V0.add(T,this._windowEvents={resize:function(){x.setViewSize(v())}})}if(n=v(),H.hasAttribute(u,"stats")&&typeof Stats!=="undefined"){this._stats=new Stats;var p=this._stats.domElement,g=p.style,d=N0.getOffset(u);g.position="absolute",g.left=d.x+"px",g.top=d.y+"px",F.body.appendChild(p)}}else n=new t0(u),u=null;if(this._project=t,this._scope=t._scope,this._element=u,!this._pixelRatio)this._pixelRatio=T&&T.devicePixelRatio||1;if(this._setElementSize(n.width,n.height),this._viewSize=n,i._views.push(this),i._viewsById[this._id]=this,(this._matrix=new B0)._owner=this,!i._focused)i._focused=this;this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!G0.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;if(A0._focused===this)A0._focused=null;A0._views.splice(A0._views.indexOf(this),1),delete A0._viewsById[this._id];var i=this._project;if(i._view===this)i._view=null;return V0.remove(this._element,this._viewEvents),V0.remove(T,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:L.each(l0._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(i){this[i]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(i){if(this._autoUpdate=i,i)this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var i=this;V0.requestAnimationFrame(function(){if(i._requested=!1,i._animate){i.requestUpdate();var t=i._element;if((!N0.getPrefixed(F,"hidden")||H.getAttribute(t,"keepalive")==="true")&&N0.isInView(t))i._handleFrame()}if(i._autoUpdate)i.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){G0=this._scope;var i=Date.now()/1000,t=this._last?i-this._last:0;if(this._last=i,this.emit("frame",new L({delta:t,time:this._time+=t,count:this._count++})),this._stats)this._stats.update()},_animateItem:function(i,t){var u=this._frameItems;if(t){if(u[i._id]={item:i,time:0,count:0},++this._frameItemCount===1)this.on("frame",this._handleFrameItems)}else if(delete u[i._id],--this._frameItemCount===0)this.off("frame",this._handleFrameItems)},_handleFrameItems:function(i){for(var t in this._frameItems){var u=this._frameItems[t];u.item.emit("frame",new L(i,{time:u.time+=i.delta,count:u.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=V},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var i=this._viewSize;return new X0(i.width,i.height,this,"setViewSize")},setViewSize:function(){var i=t0.read(arguments),t=i.subtract(this._viewSize);if(t.isZero())return;if(this._setElementSize(i.width,i.height),this._viewSize.set(i),this._changed(),this.emit("resize",{size:i,delta:t}),this._autoUpdate)this.update()},_setElementSize:function(i,t){var u=this._element;if(u){if(u.width!==i)u.width=i;if(u.height!==t)u.height=t}},getBounds:function(){if(!this._bounds)this._bounds=this._matrix.inverted()._transformBounds(new m0(new O,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return N0.isInView(this._element)},isInserted:function(){return N0.isInserted(this._element)},getPixelSize:function(i){var t=this._element,u;if(t){var h=t.parentNode,v=F.createElement("div");v.style.fontSize=i,h.appendChild(v),u=parseFloat(N0.getStyles(v).fontSize),h.removeChild(v)}else u=parseFloat(u);return u},getTextWidth:function(i,t){return 0}},L.each(["rotate","scale","shear","skew"],function(i){var t=i==="rotate";this[i]=function(){var u=arguments,h=(t?L:O).read(u),v=O.read(u,0,{readNull:!0});return this.transform(new B0()[i](h,v||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var i=new B0;return this.transform(i.translate.apply(i,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var i=O.read(arguments);this.translate(this.getCenter().subtract(i))},getZoom:function(){var i=this._decompose().scaling;return(i.x+i.y)/2},setZoom:function(i){this.transform(new B0().scale(i/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(i){var t=this.getRotation();if(t!=null&&i!=null)this.rotate(i-t)},getScaling:function(){var i=this._decompose().scaling;return new c0(i.x,i.y,this,"setScaling")},setScaling:function(){var i=this.getScaling(),t=O.read(arguments,0,{clone:!0,readNull:!0});if(i&&t)this.scale(t.x/i.x,t.y/i.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var i=this._matrix;i.set.apply(i,arguments)},transform:function(i){this._matrix.append(i)},scrollBy:function(){this.translate(O.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(O.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(O.read(arguments))},getEventPoint:function(i){return this.viewToProject(V0.getOffset(i,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(i,t){if(F&&typeof t==="string")t=F.getElementById(t);var u=T?T6:A0;return new u(i,t)}}},new function(){if(!T)return;var i,t,u=!1,h=!1;function v(z){var a=V0.getTarget(z);return a.getAttribute&&A0._viewsById[a.getAttribute("id")]}function n(){var z=A0._focused;if(!z||!z.isVisible()){for(var a=0,A=A0._views.length;a<A;a++)if((z=A0._views[a]).isVisible()){A0._focused=t=z;break}}}function s(z,a,A){z._handleMouseEvent("mousemove",a,A)}var x=T.navigator,p,g,d;if(x.pointerEnabled||x.msPointerEnabled)p="pointerdown MSPointerDown",g="pointermove MSPointerMove",d="pointerup pointercancel MSPointerUp MSPointerCancel";else if(p="touchstart",g="touchmove",d="touchend touchcancel",!(("ontouchstart"in T)&&x.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)))p+=" mousedown",g+=" mousemove",d+=" mouseup";var b={},P={mouseout:function(z){var a=A0._focused,A=V0.getRelatedTarget(z);if(a&&(!A||A.nodeName==="HTML")){var e=V0.getOffset(z,a._element),X=e.x,K=Math.abs,Q=K(X),h0=1<<25,p0=Q-h0;e.x=K(p0)<Q?p0*(X<0?-1:1):X,s(a,z,a.viewToProject(e))}},scroll:n};b[p]=function(z){var a=A0._focused=v(z);if(!u)u=!0,a._handleMouseEvent("mousedown",z)},P[g]=function(z){var a=A0._focused;if(!h){var A=v(z);if(A){if(a!==A){if(a)s(a,z);if(!i)i=a;a=A0._focused=t=A}}else if(t&&t===a){if(i&&!i.isInserted())i=null;a=A0._focused=i,i=null,n()}}if(a)s(a,z)},P[p]=function(){h=!0},P[d]=function(z){var a=A0._focused;if(a&&u)a._handleMouseEvent("mouseup",z);h=u=!1},V0.add(F,P),V0.add(T,{load:n});var l=!1,_=!1,D={doubleclick:"click",mousedrag:"mousemove"},B=!1,j,o,w,S,C,G,k,c,N;function M(z,a,A,e,X,K,Q){var h0=!1,p0;function x0(b0,v0){if(b0.responds(v0)){if(!p0)p0=new x4(v0,e,X,a||b0,K?X.subtract(K):null);if(b0.emit(v0,p0)){if(l=!0,p0.prevented)_=!0;if(p0.stopped)return h0=!0}}else{var _0=D[v0];if(_0)return x0(b0,_0)}}while(z&&z!==Q){if(x0(z,A))break;z=z._parent}return h0}function R(z,a,A,e,X,K){return z._project.removeOn(A),_=l=!1,G&&M(G,null,A,e,X,K)||a&&a!==G&&!a.isDescendant(G)&&M(a,null,A==="mousedrag"?"mousemove":A,e,X,K,G)||M(z,G||a||z,A,e,X,K)}var q={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:b,_handleMouseEvent:function(z,a,A){var e=this._itemEvents,X=e.native[z],K=z==="mousemove",Q=this._scope.tool,h0=this;function p0(j0){return e.virtual[j0]||h0.responds(j0)||Q&&Q.responds(j0)}if(K&&u&&p0("mousedrag"))z="mousedrag";if(!A)A=this.getEventPoint(a);var x0=this.getBounds().contains(A),b0=X&&x0&&h0._project.hitTest(A,{tolerance:0,fill:!0,stroke:!0}),v0=b0&&b0.item||null,_0=!1,s0={};if(s0[z.substr(5)]=!0,X&&v0!==C){if(C)M(C,null,"mouseleave",a,A);if(v0)M(v0,null,"mouseenter",a,A);C=v0}if(B^x0)M(this,null,x0?"mouseenter":"mouseleave",a,A),j=x0?this:null,_0=!0;if((x0||s0.drag)&&!A.equals(w))R(this,v0,K?z:"mousemove",a,A,w),_0=!0;if(B=x0,s0.down&&x0||s0.up&&o){if(R(this,v0,z,a,A,o),s0.down){if(N=v0===k&&Date.now()-c<300,S=k=v0,!_&&v0){var E0=v0;while(E0&&!E0.responds("mousedrag"))E0=E0._parent;if(E0)G=v0}o=A}else if(s0.up){if(!_&&v0===S)c=Date.now(),R(this,v0,N?"doubleclick":"click",a,A,o),N=!1;S=G=null}B=!1,_0=!0}if(w=A,_0&&Q)l=Q._handleMouseEvent(z,a,A,s0)||l;if(a.cancelable!==!1&&(l&&!s0.move||s0.down&&p0("mouseup")))a.preventDefault()},_handleKeyEvent:function(z,a,A,e){var X=this._scope,K=X.tool,Q;function h0(p0){if(p0.responds(z))G0=X,p0.emit(z,Q=Q||new m4(z,a,A,e))}if(this.isVisible()){if(h0(this),K&&K.responds(z))h0(K)}},_countItemEvent:function(z,a){var A=this._itemEvents,e=A.native,X=A.virtual;for(var K in q)e[K]=(e[K]||0)+(q[K][z]||0)*a;X[z]=(X[z]||0)+a},statics:{updateFocus:n,_resetState:function(){u=h=l=B=!1,i=t=j=o=w=S=C=G=k=c=N=null}}}}),T6=A0.extend({_class:"CanvasView",initialize:function i(t,u){if(!(u instanceof T.HTMLCanvasElement)){var h=t0.read(arguments,1);if(h.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+L.slice(arguments,1));u=Z0.getCanvas(h)}var v=this._context=u.getContext("2d");if(v.save(),this._pixelRatio=1,!/^off|false$/.test(H.getAttribute(u,"hidpi"))){var n=T.devicePixelRatio||1,s=N0.getPrefixed(v,"backingStorePixelRatio")||1;this._pixelRatio=n/s}A0.call(this,t,u),this._needsUpdate=!0},remove:function i(){return this._context.restore(),i.base.call(this)},_setElementSize:function i(t,u){var h=this._pixelRatio;if(i.base.call(this,t*h,u*h),h!==1){var v=this._element,n=this._context;if(!H.hasAttribute(v,"resize")){var s=v.style;s.width=t+"px",s.height=u+"px"}n.restore(),n.save(),n.scale(h,h)}},getContext:function(){return this._context},getPixelSize:function i(t){var u=G0.agent,h;if(u&&u.firefox)h=i.base.call(this,t);else{var v=this._context,n=v.font;v.font=t+" serif",h=parseFloat(v.font),v.font=n}return h},getTextWidth:function(i,t){var u=this._context,h=u.font,v=0;u.font=i;for(var n=0,s=t.length;n<s;n++)v=Math.max(v,u.measureText(t[n]).width);return u.font=h,v},update:function(){if(!this._needsUpdate)return!1;var i=this._project,t=this._context,u=this._viewSize;if(t.clearRect(0,0,u.width+1,u.height+1),i)i.draw(t,this._matrix,this._pixelRatio);return this._needsUpdate=!1,!0}}),B6=L.extend({_class:"Event",initialize:function i(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Z6.modifiers}}),m4=B6.extend({_class:"KeyEvent",initialize:function i(t,u,h,v){this.type=t,this.event=u,this.key=h,this.character=v},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Z6=new function(){var i={"\t":"tab"," ":"space","\b":"backspace","\x7F":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},t={tab:"\t",space:" ",enter:"\r"},u={},h={},v,n,s=new L({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var g=G0&&G0.agent;return g&&g.mac?this.meta:this.control}}});function x(g){var d=g.key||g.keyIdentifier;return d=/^U\+/.test(d)?String.fromCharCode(parseInt(d.substr(2),16)):/^Arrow[A-Z]/.test(d)?d.substr(5):d==="Unidentified"||d===V?String.fromCharCode(g.keyCode):d,i[d]||(d.length>1?L.hyphenate(d):d.toLowerCase())}function p(g,d,b,P){var l=g?"keydown":"keyup",_=A0._focused,D;if(u[d]=g,g)h[d]=b;else delete h[d];if(d.length>1&&(D=L.camelize(d))in s){s[D]=g;var B=G0&&G0.agent;if(D==="meta"&&B&&B.mac)if(g)v={};else{for(var j in v)if(j in h)p(!1,j,v[j],P);v=null}}else if(g&&v)v[d]=b;if(_)_._handleKeyEvent(g?"keydown":"keyup",P,d,b)}return V0.add(F,{keydown:function(g){var d=x(g),b=G0&&G0.agent;if(d.length>1||b&&(b.chrome&&(g.altKey||b.mac&&g.metaKey||!b.mac&&g.ctrlKey)))p(!0,d,t[d]||(d.length>1?"":d),g);else n=d},keypress:function(g){if(n){var d=x(g),b=g.charCode,P=b>=32?String.fromCharCode(b):d.length>1?"":d;if(d!==n)d=P.toLowerCase();p(!0,d,P,g),n=null}},keyup:function(g){var d=x(g);if(d in h)p(!1,d,h[d],g)}}),V0.add(T,{blur:function(g){for(var d in h)p(!1,d,h[d],g)}}),{modifiers:s,isDown:function(g){return!!u[g]}}},x4=B6.extend({_class:"MouseEvent",initialize:function i(t,u,h,v,n){this.type=t,this.event=u,this.point=h,this.target=v,this.delta=n},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),g8=B6.extend({_class:"ToolEvent",_item:null,initialize:function i(t,u,h){this.tool=t,this.type=u,this.event=h},_choosePoint:function(i,t){return i?i:t?t.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(i){this._point=i},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(i){this._lastPoint=i},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(i){this._downPoint=i},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint)return this.tool._point.add(this.tool._lastPoint).divide(2);return this._middlePoint},setMiddlePoint:function(i){this._middlePoint=i},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(i){this._delta=i},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(i){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=i},getItem:function(){if(!this._item){var i=this.tool._scope.project.hitTest(this.getPoint());if(i){var t=i.item,u=t._parent;while(/^(Group|CompoundPath)$/.test(u._class))t=u,u=u._parent;this._item=t}}return this._item},setItem:function(i){this._item=i},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),R7=w0.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function i(t){w0.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(i){if(this._minDistance=i,i!=null&&this._maxDistance!=null&&i>this._maxDistance)this._maxDistance=i},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(i){if(this._maxDistance=i,this._minDistance!=null&&i!=null&&i<this._minDistance)this._minDistance=i},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(i){this._minDistance=this._maxDistance=i},_handleMouseEvent:function(i,t,u,h){if(G0=this._scope,h.drag&&!this.responds(i))i="mousemove";var v=h.move||h.drag,n=this.responds(i),s=this.minDistance,x=this.maxDistance,p=!1,g=this;function d(P,l){var _=u,D=v?g._point:g._downPoint||_;if(v){if(g._moveCount>=0&&_.equals(D))return!1;if(D&&(P!=null||l!=null)){var B=_.subtract(D),j=B.getLength();if(j<(P||0))return!1;if(l)_=D.add(B.normalize(Math.min(j,l)))}g._moveCount++}if(g._point=_,g._lastPoint=D||_,h.down)g._moveCount=-1,g._downPoint=_,g._downCount++;return!0}function b(){if(n)p=g.emit(i,new g8(g,i,t))||p}if(h.down)d(),b();else if(h.up)d(null,x),b();else if(n)while(d(s,x))b();return p}}),y8=L.extend(Y,{_class:"Tween",statics:{easings:new L({linear:function(i){return i},easeInQuad:function(i){return i*i},easeOutQuad:function(i){return i*(2-i)},easeInOutQuad:function(i){return i<0.5?2*i*i:-1+2*(2-i)*i},easeInCubic:function(i){return i*i*i},easeOutCubic:function(i){return--i*i*i+1},easeInOutCubic:function(i){return i<0.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},easeInQuart:function(i){return i*i*i*i},easeOutQuart:function(i){return 1- --i*i*i*i},easeInOutQuart:function(i){return i<0.5?8*i*i*i*i:1-8*--i*i*i*i},easeInQuint:function(i){return i*i*i*i*i},easeOutQuint:function(i){return 1+--i*i*i*i*i},easeInOutQuint:function(i){return i<0.5?16*i*i*i*i*i:1+16*--i*i*i*i*i}})},initialize:function i(t,u,h,v,n,s){this.object=t;var x=typeof n,p=x==="function";this.type=p?x:x==="string"?n:"linear",this.easing=p?n:i.easings[this.type],this.duration=v,this.running=!1,this._then=null,this._startTime=null;var g=u||h;if(this._keys=g?Object.keys(g):[],this._parsedKeys=this._parseKeys(this._keys),this._from=g&&this._getState(u),this._to=g&&this._getState(h),s!==!1)this.start()},then:function(i){return this._then=i,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(i){if(this.running){if(i>=1)i=1,this.running=!1;var t=this.easing(i),u=this._keys,h=function(d){return typeof d==="function"?d(t,i):d};for(var v=0,n=u&&u.length;v<n;v++){var s=u[v],x=h(this._from[s]),p=h(this._to[s]),g=x&&p&&x.__add&&p.__add?p.__subtract(x).__multiply(t).__add(x):(p-x)*t+x;this._setProperty(this._parsedKeys[s],g)}if(this.responds("update"))this.emit("update",new L({progress:i,factor:t}));if(!this.running&&this._then)this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(i){var t=this._startTime,u=t?(i-t)/this.duration:0;if(!t)this._startTime=i;this.update(u)},_getState:function(i){var t=this._keys,u={};for(var h=0,v=t.length;h<v;h++){var n=t[h],s=this._parsedKeys[n],x=this._getProperty(s),p;if(i){var g=this._resolveValue(x,i[n]);this._setProperty(s,g),p=this._getProperty(s),p=p&&p.clone?p.clone():p,this._setProperty(s,x)}else p=x&&x.clone?x.clone():x;u[n]=p}return u},_resolveValue:function(i,t){if(t){if(Array.isArray(t)&&t.length===2){var u=t[0];return u&&u.match&&u.match(/^[+\-\*\/]=/)?this._calculate(i,u[0],t[1]):t}else if(typeof t==="string"){var h=t.match(/^[+\-*/]=(.*)/);if(h){var v=JSON.parse(h[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(i,t[0],v)}}}return t},_calculate:function(i,t,u){return G0.PaperScript.calculateBinary(i,t,u)},_parseKeys:function(i){var t={};for(var u=0,h=i.length;u<h;u++){var v=i[u],n=v.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");t[v]=n.split("/")}return t},_getProperty:function(i,t){var u=this.object;for(var h=0,v=i.length-(t||0);h<v&&u;h++)u=u[i[h]];return u},_setProperty:function(i,t){var u=this._getProperty(i,1);if(u)u[i[i.length-1]]=t}}),w8={request:function(i){var t=new E.XMLHttpRequest;if(t.open((i.method||"get").toUpperCase(),i.url,L.pick(i.async,!0)),i.mimeType)t.overrideMimeType(i.mimeType);return t.onload=function(){var u=t.status;if(u===0||u===200){if(i.onLoad)i.onLoad.call(t,t.responseText)}else t.onerror()},t.onerror=function(){var u=t.status,h='Could not load "'+i.url+'" (Status: '+u+")";if(i.onError)i.onError(h,u);else throw new Error(h)},t.send(null)}},Z0=L.exports.CanvasProvider={canvases:[],getCanvas:function(i,t,u){if(!T)return null;var h,v=!0;if(typeof i==="object")t=i.height,i=i.width;if(this.canvases.length)h=this.canvases.pop();else h=F.createElement("canvas"),v=!1;var n=h.getContext("2d",u||{});if(!n)throw new Error("Canvas "+h+" is unable to provide a 2D context.");if(h.width===i&&h.height===t){if(v)n.clearRect(0,0,i+1,t+1)}else h.width=i,h.height=t;return n.save(),h},getContext:function(i,t,u){var h=this.getCanvas(i,t,u);return h?h.getContext("2d",u||{}):null},release:function(i){var t=i&&i.canvas?i.canvas:i;if(t&&t.getContext)t.getContext("2d").restore(),this.canvases.push(t)}},j4=new function(){var{min:i,max:t,abs:u}=Math,h,v,n,s,x,p,g,d,b,P,l;function _(C,G,k){return 0.2989*C+0.587*G+0.114*k}function D(C,G,k,M){var N=M-_(C,G,k);b=C+N,P=G+N,l=k+N;var M=_(b,P,l),R=i(b,P,l),q=t(b,P,l);if(R<0){var z=M-R;b=M+(b-M)*M/z,P=M+(P-M)*M/z,l=M+(l-M)*M/z}if(q>255){var a=255-M,A=q-M;b=M+(b-M)*a/A,P=M+(P-M)*a/A,l=M+(l-M)*a/A}}function B(C,G,k){return t(C,G,k)-i(C,G,k)}function j(C,G,k,c){var N=[C,G,k],M=t(C,G,k),R=i(C,G,k),q;if(R=R===C?0:R===G?1:2,M=M===C?0:M===G?1:2,q=i(R,M)===0?t(R,M)===1?2:1:0,N[M]>N[R])N[q]=(N[q]-N[R])*c/(N[M]-N[R]),N[M]=c;else N[q]=N[M]=0;N[R]=0,b=N[0],P=N[1],l=N[2]}var o={multiply:function(){b=x*h/255,P=p*v/255,l=g*n/255},screen:function(){b=x+h-x*h/255,P=p+v-p*v/255,l=g+n-g*n/255},overlay:function(){b=x<128?2*x*h/255:255-2*(255-x)*(255-h)/255,P=p<128?2*p*v/255:255-2*(255-p)*(255-v)/255,l=g<128?2*g*n/255:255-2*(255-g)*(255-n)/255},"soft-light":function(){var C=h*x/255;b=C+x*(255-(255-x)*(255-h)/255-C)/255,C=v*p/255,P=C+p*(255-(255-p)*(255-v)/255-C)/255,C=n*g/255,l=C+g*(255-(255-g)*(255-n)/255-C)/255},"hard-light":function(){b=h<128?2*h*x/255:255-2*(255-h)*(255-x)/255,P=v<128?2*v*p/255:255-2*(255-v)*(255-p)/255,l=n<128?2*n*g/255:255-2*(255-n)*(255-g)/255},"color-dodge":function(){b=x===0?0:h===255?255:i(255,255*x/(255-h)),P=p===0?0:v===255?255:i(255,255*p/(255-v)),l=g===0?0:n===255?255:i(255,255*g/(255-n))},"color-burn":function(){b=x===255?255:h===0?0:t(0,255-(255-x)*255/h),P=p===255?255:v===0?0:t(0,255-(255-p)*255/v),l=g===255?255:n===0?0:t(0,255-(255-g)*255/n)},darken:function(){b=x<h?x:h,P=p<v?p:v,l=g<n?g:n},lighten:function(){b=x>h?x:h,P=p>v?p:v,l=g>n?g:n},difference:function(){if(b=x-h,b<0)b=-b;if(P=p-v,P<0)P=-P;if(l=g-n,l<0)l=-l},exclusion:function(){b=x+h*(255-x-x)/255,P=p+v*(255-p-p)/255,l=g+n*(255-g-g)/255},hue:function(){j(h,v,n,B(x,p,g)),D(b,P,l,_(x,p,g))},saturation:function(){j(x,p,g,B(h,v,n)),D(b,P,l,_(x,p,g))},luminosity:function(){D(x,p,g,_(h,v,n))},color:function(){D(h,v,n,_(x,p,g))},add:function(){b=i(x+h,255),P=i(p+v,255),l=i(g+n,255)},subtract:function(){b=t(x-h,0),P=t(p-v,0),l=t(g-n,0)},average:function(){b=(x+h)/2,P=(p+v)/2,l=(g+n)/2},negation:function(){b=255-u(255-h-x),P=255-u(255-v-p),l=255-u(255-n-g)}},w=this.nativeModes=L.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(C){this[C]=!0},{}),S=Z0.getContext(1,1,{willReadFrequently:!0});if(S)L.each(o,function(C,G){var k=G==="darken",c=!1;S.save();try{if(S.fillStyle=k?"#300":"#a00",S.fillRect(0,0,1,1),S.globalCompositeOperation=G,S.globalCompositeOperation===G)S.fillStyle=k?"#a00":"#300",S.fillRect(0,0,1,1),c=S.getImageData(0,0,1,1).data[0]!==k?170:51}catch(N){}S.restore(),w[G]=c}),Z0.release(S);this.process=function(C,G,k,c,N){var M=G.canvas,R=C==="normal";if(R||w[C]){if(k.save(),k.setTransform(1,0,0,1,0,0),k.globalAlpha=c,!R)k.globalCompositeOperation=C;k.drawImage(M,N.x,N.y),k.restore()}else{var q=o[C];if(!q)return;var z=k.getImageData(N.x,N.y,M.width,M.height),a=z.data,A=G.getImageData(0,0,M.width,M.height).data;for(var e=0,X=a.length;e<X;e+=4){h=A[e],x=a[e],v=A[e+1],p=a[e+1],n=A[e+2],g=a[e+2],s=A[e+3],d=a[e+3],q();var K=s*c/255,Q=1-K;a[e]=K*b+Q*x,a[e+1]=K*P+Q*p,a[e+2]=K*l+Q*g,a[e+3]=s*c+Q*d}k.putImageData(z,N.x,N.y)}}},H0=new function(){var i="http://www.w3.org/2000/svg",t="http://www.w3.org/2000/xmlns",u="http://www.w3.org/1999/xlink",h={href:u,xlink:t,xmlns:t+"/","xmlns:xlink":t+"/"};function v(x,p,g){return s(F.createElementNS(i,x),p,g)}function n(x,p){var g=h[p],d=g?x.getAttributeNS(g,p):x.getAttribute(p);return d==="null"?null:d}function s(x,p,g){for(var d in p){var b=p[d],P=h[d];if(typeof b==="number"&&g)b=g.number(b);if(P)x.setAttributeNS(P,d,b);else x.setAttribute(d,b)}return x}return{svg:i,xmlns:t,xlink:u,create:v,get:n,set:s}},H4=L.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(i,t){return!t&&(i instanceof i6||i instanceof f0||i instanceof t6)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(i,t){var u=L.capitalize(t),h=i[2];this[t]={type:i[1],property:t,attribute:i[0],toSVG:h,fromSVG:h&&L.each(h,function(v,n){this[v]=n},{}),exportFilter:i[3],get:"get"+u,set:"set"+u}},{});new function(){var i;function t(o,w,S){var C=new L,G=o.getTranslation();if(w){var k;if(o.isInvertible())o=o._shiftless(),k=o._inverseTransform(G),G=null;else k=new O;C[S?"cx":"x"]=k.x,C[S?"cy":"y"]=k.y}if(!o.isIdentity()){var c=o.decompose();if(c){var N=[],M=c.rotation,R=c.scaling,q=c.skewing;if(G&&!G.isZero())N.push("translate("+i.point(G)+")");if(M)N.push("rotate("+i.number(M)+")");if(!$.isZero(R.x-1)||!$.isZero(R.y-1))N.push("scale("+i.point(R)+")");if(q.x)N.push("skewX("+i.number(q.x)+")");if(q.y)N.push("skewY("+i.number(q.y)+")");C.transform=N.join(" ")}else C.transform="matrix("+o.getValues().join(",")+")"}return C}function u(o,w){var S=t(o._matrix),C=o._children,G=H0.create("g",S,i);for(var k=0,c=C.length;k<c;k++){var N=C[k],M=B(N,w);if(M)if(N.isClipMask()){var R=H0.create("clipPath");R.appendChild(M),_(N,R,"clip"),H0.set(G,{"clip-path":"url(#"+R.id+")"})}else G.appendChild(M)}return G}function h(o,w){var S=t(o._matrix,!0),C=o.getSize(),G=o.getImage();return S.x-=C.width/2,S.y-=C.height/2,S.width=C.width,S.height=C.height,S.href=w.embedImages==!1&&G&&G.src||o.toDataURL(),H0.create("image",S,i)}function v(o,w){var S=w.matchShapes;if(S){var C=o.toShape(!1);if(C)return n(C,w)}var G=o._segments,k=G.length,c,N=t(o._matrix);if(S&&k>=2&&!o.hasHandles())if(k>2){c=o._closed?"polygon":"polyline";var M=[];for(var R=0;R<k;R++)M.push(i.point(G[R]._point));N.points=M.join(" ")}else{c="line";var q=G[0]._point,z=G[1]._point;N.set({x1:q.x,y1:q.y,x2:z.x,y2:z.y})}else c="path",N.d=o.getPathData(null,w.precision);return H0.create(c,N,i)}function n(o){var{_type:w,_radius:S}=o,C=t(o._matrix,!0,w!=="rectangle");if(w==="rectangle"){w="rect";var G=o._size,k=G.width,c=G.height;if(C.x-=k/2,C.y-=c/2,C.width=k,C.height=c,S.isZero())S=null}if(S)if(w==="circle")C.r=S;else C.rx=S.width,C.ry=S.height;return H0.create(w,C,i)}function s(o,w){var S=t(o._matrix),C=o.getPathData(null,w.precision);if(C)S.d=C;return H0.create("path",S,i)}function x(o,w){var S=t(o._matrix,!0),C=o._definition,G=l(C,"symbol"),k=C._item,c=k.getStrokeBounds();if(!G)G=H0.create("symbol",{viewBox:i.rectangle(c)}),G.appendChild(B(k,w)),_(C,G,"symbol");return S.href="#"+G.id,S.x+=c.x,S.y+=c.y,S.width=c.width,S.height=c.height,S.overflow="visible",H0.create("use",S,i)}function p(o){var w=l(o,"color");if(!w){var S=o.getGradient(),C=S._radial,G=o.getOrigin(),k=o.getDestination(),c;if(C){c={cx:G.x,cy:G.y,r:G.getDistance(k)};var N=o.getHighlight();if(N)c.fx=N.x,c.fy=N.y}else c={x1:G.x,y1:G.y,x2:k.x,y2:k.y};c.gradientUnits="userSpaceOnUse",w=H0.create((C?"radial":"linear")+"Gradient",c,i);var M=S._stops;for(var R=0,q=M.length;R<q;R++){var z=M[R],a=z._color,A=a.getAlpha(),e=z._offset;if(c={offset:e==null?R/(q-1):e},a)c["stop-color"]=a.toCSS(!0);if(A<1)c["stop-opacity"]=A;w.appendChild(H0.create("stop",c,i))}_(o,w,"color")}return"url(#"+w.id+")"}function g(o){var w=H0.create("text",t(o._matrix,!0),i);return w.textContent=o._content,w}var d={Group:u,Layer:u,Raster:h,Path:v,Shape:n,CompoundPath:s,SymbolItem:x,PointText:g};function b(o,w,S){var C={},G=!S&&o.getParent(),k=[];if(o._name!=null)C.id=o._name;if(L.each(H4,function(c){var{get:N,type:M}=c,R=o[N]();if(c.exportFilter?c.exportFilter(o,R):!G||!L.equals(G[N](),R)){if(M==="color"&&R!=null){var q=R.getAlpha();if(q<1)C[c.attribute+"-opacity"]=q}if(M==="style")k.push(c.attribute+": "+R);else C[c.attribute]=R==null?"none":M==="color"?R.gradient?p(R,o):R.toCSS(!0):M==="array"?R.join(","):M==="lookup"?c.toSVG[R]:R}}),k.length)C.style=k.join(";");if(C.opacity===1)delete C.opacity;if(!o._visible)C.visibility="hidden";return H0.set(w,C,i)}var P;function l(o,w){if(!P)P={ids:{},svgs:{}};return o&&P.svgs[w+"-"+(o._id||o.__id||(o.__id=r0.get("svg")))]}function _(o,w,S){if(!P)l();var C=P.ids[S]=(P.ids[S]||0)+1;w.id=S+"-"+C,P.svgs[S+"-"+(o._id||o.__id)]=w}function D(o,w){var S=o,C=null;if(P){S=o.nodeName.toLowerCase()==="svg"&&o;for(var G in P.svgs){if(!C){if(!S)S=H0.create("svg"),S.appendChild(o);C=S.insertBefore(H0.create("defs"),S.firstChild)}C.appendChild(P.svgs[G])}P=null}return w.asString?new E.XMLSerializer().serializeToString(S):S}function B(o,w,S){var C=d[o._class],G=C&&C(o,w);if(G){var k=w.onExport;if(k)G=k(o,G,w)||G;var c=JSON.stringify(o._data);if(c&&c!=="{}"&&c!=="null")G.setAttribute("data-paper-data",c)}return G&&b(o,G,S)}function j(o){if(!o)o={};return i=new y0(o.precision),o}l0.inject({exportSVG:function(o){return o=j(o),D(B(this,o,!0),o)}}),r6.inject({exportSVG:function(o){o=j(o);var w=this._children,S=this.getView(),C=L.pick(o.bounds,"view"),G=o.matrix||C==="view"&&S._matrix,k=G&&B0.read([G]),c=C==="view"?new m0([0,0],S.getViewSize()):C==="content"?l0._getBounds(w,k,{stroke:!0}).rect:m0.read([C],0,{readNull:!0}),N={version:"1.1",xmlns:H0.svg,"xmlns:xlink":H0.xlink};if(c){if(N.width=c.width,N.height=c.height,c.x||c.x===0||c.y||c.y===0)N.viewBox=i.rectangle(c)}var M=H0.create("svg",N,i),R=M;if(k&&!k.isIdentity())R=M.appendChild(H0.create("g",t(k),i));for(var q=0,z=w.length;q<z;q++)R.appendChild(B(w[q],o,!0));return D(M,o)}})},new function(){var i={},t;function u(w,S,C,G,k,c){var N=H0.get(w,S)||c,M=N==null?G?null:C?"":0:C?N:parseFloat(N);return/%\s*$/.test(N)?M/100*(k?1:t[/x|^width/.test(S)?"width":"height"]):M}function h(w,S,C,G,k,c,N){return S=u(w,S||"x",!1,G,k,c),C=u(w,C||"y",!1,G,k,N),G&&(S==null||C==null)?null:new O(S,C)}function v(w,S,C,G,k){return S=u(w,S||"width",!1,G,k),C=u(w,C||"height",!1,G,k),G&&(S==null||C==null)?null:new t0(S,C)}function n(w,S,C){return w==="none"?null:S==="number"?parseFloat(w):S==="array"?w?w.split(/[\s,]+/g).map(parseFloat):[]:S==="color"?B(w)||w:S==="lookup"?C[w]:w}function s(w,S,C,G){var k=w.childNodes,c=S==="clippath",N=S==="defs",M=new J0,R=M._project,q=R._currentStyle,z=[];if(!c&&!N)M=D(M,w,G),R._currentStyle=M._style.clone();if(G){var a=w.querySelectorAll("defs");for(var A=0,e=a.length;A<e;A++)j(a[A],C,!1)}for(var A=0,e=k.length;A<e;A++){var X=k[A],K;if(X.nodeType===1&&!/^defs$/i.test(X.nodeName)&&(K=j(X,C,!1))&&!(K instanceof Z))z.push(K)}if(M.addChildren(z),c)M=D(M.reduce(),w,G);if(R._currentStyle=q,c||N)M.remove(),M=null;return M}function x(w,S){var C=w.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),G=[];for(var k=0,c=C.length;k<c;k+=2)G.push(new O(parseFloat(C[k]),parseFloat(C[k+1])));var N=new d0(G);if(S==="polygon")N.closePath();return N}function p(w){return i6.create(w.getAttribute("d"))}function g(w,S){var C=(u(w,"href",!0)||"").substring(1),G=S==="radialgradient",k;if(C){if(k=i[C].getGradient(),k._radial^G)k=k.clone(),k._radial=G}else{var c=w.childNodes,N=[];for(var M=0,R=c.length;M<R;M++){var q=c[M];if(q.nodeType===1)N.push(D(new O0,q))}k=new o0(N,G)}var z,a,A,e=u(w,"gradientUnits",!0)!=="userSpaceOnUse";if(G)z=h(w,"cx","cy",!1,e,"50%","50%"),a=z.add(u(w,"r",!1,!1,e,"50%"),0),A=h(w,"fx","fy",!0,e);else z=h(w,"x1","y1",!1,e,"0%","0%"),a=h(w,"x2","y2",!1,e,"100%","0%");var X=D(new U(k,z,a,A),w);return X._scaleToBounds=e,null}var d={"#document":function(w,S,C,G){var k=w.childNodes;for(var c=0,N=k.length;c<N;c++){var M=k[c];if(M.nodeType===1)return j(M,C,G)}},g:s,svg:s,clippath:s,polygon:x,polyline:x,path:p,lineargradient:g,radialgradient:g,image:function(w){var S=new i0(u(w,"href",!0));return S.on("load",function(){var C=v(w);this.setSize(C);var G=h(w).add(C.divide(2));this._matrix.append(new B0().translate(G))}),S},symbol:function(w,S,C,G){return new Z(s(w,S,C,G),!0)},defs:s,use:function(w){var S=(u(w,"href",!0)||"").substring(1),C=i[S],G=h(w);return C?C instanceof Z?C.place(G):C.clone().translate(G):null},circle:function(w){return new f0.Circle(h(w,"cx","cy"),u(w,"r"))},ellipse:function(w){return new f0.Ellipse({center:h(w,"cx","cy"),radius:v(w,"rx","ry")})},rect:function(w){return new f0.Rectangle(new m0(h(w),v(w)),v(w,"rx","ry"))},line:function(w){return new d0.Line(h(w,"x1","y1"),h(w,"x2","y2"))},text:function(w){var S=new K0(h(w).add(h(w,"dx","dy")));return S.setContent(w.textContent.trim()||""),S},switch:s};function b(w,S,C,G){if(w.transform){var k=(G.getAttribute(C)||"").split(/\)\s*/g),c=new B0;for(var N=0,M=k.length;N<M;N++){var R=k[N];if(!R)break;var q=R.split(/\(\s*/),z=q[0],a=q[1].split(/[\s,]+/g);for(var A=0,e=a.length;A<e;A++)a[A]=parseFloat(a[A]);switch(z){case"matrix":c.append(new B0(a[0],a[1],a[2],a[3],a[4],a[5]));break;case"rotate":c.rotate(a[0],a[1]||0,a[2]||0);break;case"translate":c.translate(a[0],a[1]||0);break;case"scale":c.scale(a);break;case"skewX":c.skew(a[0],0);break;case"skewY":c.skew(0,a[0]);break}}w.transform(c)}}function P(w,S,C){var G=C==="fill-opacity"?"getFillColor":"getStrokeColor",k=w[G]&&w[G]();if(k)k.setAlpha(parseFloat(S))}var l=L.set(L.each(H4,function(w){this[w.attribute]=function(S,C){if(S[w.set]){if(S[w.set](n(C,w.type,w.fromSVG)),w.type==="color"){var G=S[w.get]();if(G){if(G._scaleToBounds){var k=S.getBounds();G.transform(new B0().translate(k.getPoint()).scale(k.getSize()))}}}}}},{}),{id:function(w,S){if(i[S]=w,w.setName)w.setName(S)},"clip-path":function(w,S){var C=B(S);if(C)if(C=C.clone(),C.setClipMask(!0),w instanceof J0)w.insertChild(0,C);else return new J0(C,w)},gradientTransform:b,transform:b,"fill-opacity":P,"stroke-opacity":P,visibility:function(w,S){if(w.setVisible)w.setVisible(S==="visible")},display:function(w,S){if(w.setVisible)w.setVisible(S!==null)},"stop-color":function(w,S){if(w.setColor)w.setColor(S)},"stop-opacity":function(w,S){if(w._color)w._color.setAlpha(parseFloat(S))},offset:function(w,S){if(w.setOffset){var C=S.match(/(.*)%$/);w.setOffset(C?C[1]/100:parseFloat(S))}},viewBox:function(w,S,C,G,k){var c=new m0(n(S,"array")),N=v(G,null,null,!0),M,R;if(w instanceof J0){var q=N?N.divide(c.getSize()):1,R=new B0().scale(q).translate(c.getPoint().negate());M=w}else if(w instanceof Z){if(N)c.setSize(N);M=w._item}if(M){if(_(G,"overflow",k)!=="visible"){var z=new f0.Rectangle(c);z.setClipMask(!0),M.addChild(z)}if(R)M.transform(R)}}});function _(w,S,C){var G=w.attributes[S],k=G&&G.value;if(!k&&w.style){var c=L.camelize(S);if(k=w.style[c],!k&&C.node[c]!==C.parent[c])k=C.node[c]}return!k?V:k==="none"?null:k}function D(w,S,C){var G=S.parentNode,k={node:N0.getStyles(S)||{},parent:!C&&!/^defs$/i.test(G.tagName)&&N0.getStyles(G)||{}};return L.each(l,function(c,N){var M=_(S,N,k);w=M!==V&&c(w,M,N,S,k)||w}),w}function B(w){var S=w&&w.match(/\((?:["'#]*)([^"')]+)/),C=S&&S[1],G=C&&i[T?C.replace(T.location.href.split("#")[0]+"#",""):C];if(G&&G._scaleToBounds)G=G.clone(),G._scaleToBounds=!0;return G}function j(w,S,C){var G=w.nodeName.toLowerCase(),k=G!=="#document",c=F.body,N,M,R;if(C&&k)t=G0.getView().getSize(),t=v(w,null,null,!0)||t,N=H0.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),M=w.parentNode,R=w.nextSibling,N.appendChild(w),c.appendChild(N);var q=G0.settings,z=q.applyMatrix,a=q.insertItems;q.applyMatrix=!1,q.insertItems=!1;var A=d[G],e=A&&A(w,G,S,C)||null;if(q.insertItems=a,q.applyMatrix=z,e){if(k&&!(e instanceof J0))e=D(e,w,C);var X=S.onImport,K=k&&w.getAttribute("data-paper-data");if(X)e=X(w,e,S)||e;if(S.expandShapes&&e instanceof f0)e.remove(),e=e.toPath();if(K)e._data=JSON.parse(K)}if(N){if(c.removeChild(N),M)if(R)M.insertBefore(w,R);else M.appendChild(w)}if(C){if(i={},e&&L.pick(S.applyMatrix,z))e.matrix.apply(!0,!0)}return e}function o(w,S,C){if(!w)return null;S=typeof S==="function"?{onLoad:S}:S||{};var G=G0,k=null;function c(q){try{var z=typeof q==="object"?q:new E.DOMParser().parseFromString(q.trim(),"image/svg+xml");if(!z.nodeName)throw z=null,new Error("Unsupported SVG source: "+w);if(G0=G,k=j(z,S,!0),!S||S.insert!==!1)C._insertItem(V,k);var a=S.onLoad;if(a)a(k,q)}catch(A){N(A)}}function N(q,z){var a=S.onError;if(a)a(q,z);else throw new Error(q)}if(typeof w==="string"&&!/^[\s\S]*</.test(w)){var M=F.getElementById(w);if(M)c(M);else w8.request({url:w,async:!0,onLoad:c,onError:N})}else if(typeof File!=="undefined"&&w instanceof File){var R=new FileReader;return R.onload=function(){c(R.result)},R.onerror=function(){N(R.error)},R.readAsText(w)}else c(w);return k}l0.inject({importSVG:function(w,S){return o(w,S,this)}}),r6.inject({importSVG:function(w,S){return this.activate(),o(w,S,this)}})};var G0=new(H.inject(L.exports,{Base:L,Numerical:$,Key:Z6,DomEvent:V0,DomElement:N0,document:F,window:T,Symbol:Z,PlacedSymbol:u0}));if(G0.agent.node)(()=>({}))(G0);if(typeof define==="function"&&define.amd)define("paper",G0);else if(typeof m==="object"&&m)m.exports=G0;return G0}.call(f,typeof self==="object"?self:null)}),O3=N4(V4(),1),E4=N4(V4(),1),r=new y6.Generator("JavaScript");r.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","));r.ORDER_ATOMIC=0;r.ORDER_NEW=1.1;r.ORDER_MEMBER=1.2;r.ORDER_FUNCTION_CALL=2;r.ORDER_INCREMENT=3;r.ORDER_DECREMENT=3;r.ORDER_BITWISE_NOT=4.1;r.ORDER_UNARY_PLUS=4.2;r.ORDER_UNARY_NEGATION=4.3;r.ORDER_LOGICAL_NOT=4.4;r.ORDER_TYPEOF=4.5;r.ORDER_VOID=4.6;r.ORDER_DELETE=4.7;r.ORDER_DIVISION=5.1;r.ORDER_MULTIPLICATION=5.2;r.ORDER_MODULUS=5.3;r.ORDER_SUBTRACTION=6.1;r.ORDER_ADDITION=6.2;r.ORDER_BITWISE_SHIFT=7;r.ORDER_RELATIONAL=8;r.ORDER_IN=8;r.ORDER_INSTANCEOF=8;r.ORDER_EQUALITY=9;r.ORDER_BITWISE_AND=10;r.ORDER_BITWISE_XOR=11;r.ORDER_BITWISE_OR=12;r.ORDER_LOGICAL_AND=13;r.ORDER_LOGICAL_OR=14;r.ORDER_CONDITIONAL=15;r.ORDER_ASSIGNMENT=16;r.ORDER_COMMA=17;r.ORDER_NONE=99;r.ORDER_OVERRIDES=[[r.ORDER_FUNCTION_CALL,r.ORDER_MEMBER],[r.ORDER_FUNCTION_CALL,r.ORDER_FUNCTION_CALL],[r.ORDER_MEMBER,r.ORDER_MEMBER],[r.ORDER_MEMBER,r.ORDER_FUNCTION_CALL],[r.ORDER_LOGICAL_NOT,r.ORDER_LOGICAL_NOT],[r.ORDER_MULTIPLICATION,r.ORDER_MULTIPLICATION],[r.ORDER_ADDITION,r.ORDER_ADDITION],[r.ORDER_LOGICAL_AND,r.ORDER_LOGICAL_AND],[r.ORDER_LOGICAL_OR,r.ORDER_LOGICAL_OR]];r.init=function(f){if(r.definitions_=Object.create(null),r.functionNames_=Object.create(null),!r.variableDB_)r.variableDB_=new y6.Names(r.RESERVED_WORDS_);else r.variableDB_.reset();r.variableDB_.setVariableMap(f.getVariableMap());var m=[],y=f.getAllVariables();for(var E=0;E<y.length;E++){if(y[E].type===y6.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const T=r.variableDB_.getName(y[E].getId(),y6.Variables.NAME_TYPE);if(y[E].type===y6.LIST_VARIABLE_TYPE)m.push(`let ${T}${y6.LIST_VARIABLE_TYPE} = [];`);else m.push(`let ${T} = 0;`)}var V=y6.Variables.allDeveloperVariables(f);for(var E=0;E<V.length;E++){const F=r.variableDB_.getName(V[E],y6.Names.DEVELOPER_VARIABLE_TYPE);if(y[E].type===y6.LIST_VARIABLE_TYPE)m.push(`let ${F}${y6.LIST_VARIABLE_TYPE} = [];`);else m.push(`let ${F} = 0;`)}if(m.length)r.definitions_.variables=m.join("\n")};r.finish=function(f){var m=[];for(var y in r.definitions_)m.push(r.definitions_[y]);return delete r.definitions_,delete r.functionNames_,r.variableDB_.reset(),m.join("\n\n")+"\n\n\n"+f};r.scrubNakedValue=function(f){return f+";\n"};r.quote_=function(f){return f=f.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+f+"'"};r.HAT_CODE="/* HatCode */";r.scrub_=function(f,m){var y="";if(!f.outputConnection?.targetConnection){var E=f.getCommentText();if(E=y6.utils.wrap(E,r.COMMENT_WRAP-3),E)if(f.getProcedureDef)y+="/**\n"+r.prefixLines(E+"\n"," * ")+" */\n";else y+=r.prefixLines(E+"\n","// ");for(var V=0;V<f.inputList.length;V++)if(f.inputList[V].type==y6.INPUT_VALUE){var T=f.inputList[V].connection.targetBlock();if(T){var E=r.allNestedComments(T);if(E)y+=r.prefixLines(E,"// ")}}}if(f.startHat_){const F=f.nextConnection&&f.nextConnection.targetBlock();let L=r.blockToCode(F);if(L)L=r.prefixLines(L,r.INDENT),m=m.replace(r.HAT_CODE,L);return y+m}if(f.parentBlock_){const F=f.nextConnection&&f.nextConnection.targetBlock(),L=r.blockToCode(F);return y+m+L}return""};r.getAdjusted=function(f,m,y,E,V){var T=y||0,F=V||r.ORDER_NONE;if(f.workspace.options.oneBasedIndex)T--;var L=f.workspace.options.oneBasedIndex?"1":"0";if(T>0)var Y=r.valueToCode(f,m,r.ORDER_ADDITION)||L;else if(T<0)var Y=r.valueToCode(f,m,r.ORDER_SUBTRACTION)||L;else if(E)var Y=r.valueToCode(f,m,r.ORDER_UNARY_NEGATION)||L;else var Y=r.valueToCode(f,m,F)||L;if(y6.isNumber(Y)){if(Y=parseFloat(Y)+T,E)Y=-Y}else{if(T>0){Y=Y+" + "+T;var H=r.ORDER_ADDITION}else if(T<0){Y=Y+" - "+-T;var H=r.ORDER_SUBTRACTION}if(E){if(T)Y="-("+Y+")";else Y="-"+Y;var H=r.ORDER_UNARY_NEGATION}if(H=Math.floor(H),F=Math.floor(F),H&&F>=H)Y="("+Y+")"}return Y};r.colour_picker=(f)=>{return[r.quote_(f.getFieldValue("COLOUR")),r.ORDER_ATOMIC]};var F6="if (abort || !runtime.running) break;\n",i4=`  await runtime.nextFrame();\n  ${F6}`;r.control_wait=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DURATION",r.ORDER_NONE)||0;return m+=`await runtime.sleep(runtime.number(${y}));\n${F6}`,m};r.control_repeat=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);let y=r.statementToCode(f,"SUBSTACK")||"";if(r.STATEMENT_SUFFIX)y=r.prefixLines(r.injectId(r.STATEMENT_SUFFIX,f),r.INDENT)+y;const E=r.valueToCode(f,"TIMES",r.ORDER_NONE)||0;return m+=`for (let _ = 0; _ < runtime.number(${E}); _++) {\n${y}${i4}}\n${F6}`,m};r.control_forever=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);let y=r.statementToCode(f,"SUBSTACK")||"";if(r.STATEMENT_SUFFIX)y=r.prefixLines(r.injectId(r.STATEMENT_SUFFIX,f),r.INDENT)+y;return m+=`while (true) {\n${y}${i4}}\n${F6}`,m};r.control_if=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);let y=r.statementToCode(f,"SUBSTACK")||"";if(r.STATEMENT_SUFFIX)y=r.prefixLines(r.injectId(r.STATEMENT_SUFFIX,f),r.INDENT)+y;const E=r.valueToCode(f,"CONDITION",r.ORDER_NONE)||"false";if(m+=`if (${E}) {\n${y}}\n`,f.getInput("SUBSTACK2")){if(y=r.statementToCode(f,"SUBSTACK2")||"",r.STATEMENT_SUFFIX)y=r.prefixLines(r.injectId(r.STATEMENT_SUFFIX,f),r.INDENT)+y;m+=`else {\n${y}}\n`}return m};r.control_if_else=r.control_if;r.control_wait_until=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"CONDITION",r.ORDER_NONE)||"false";return m+=`while (!(${y})) {\n${i4}}\n${F6}`,m};r.control_repeat_until=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);let y=r.statementToCode(f,"SUBSTACK")||"";if(r.STATEMENT_SUFFIX)y=r.prefixLines(r.injectId(r.STATEMENT_SUFFIX,f),r.INDENT)+y;const E=r.valueToCode(f,"CONDITION",r.ORDER_NONE)||"false";return m+=`while (!(${E})) {\n${y}${i4}}\n${F6}`,m};r.control_while=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);let y=r.statementToCode(f,"SUBSTACK")||"";if(r.STATEMENT_SUFFIX)y=r.prefixLines(r.injectId(r.STATEMENT_SUFFIX,f),r.INDENT)+y;const E=r.valueToCode(f,"CONDITION",r.ORDER_NONE)||"false";return m+=`while (${E}) {\n${y}${i4}}\n${F6}`,m};r.control_stop=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);switch(f.getFieldValue("STOP_OPTION")){case"all":m+="runtime.stop();\n";break;case"this script":m+="return done();\n";break;case"other scripts in sprite":m+="abort = true;\n";break}return m};r.data_variable=(f)=>{return[r.variableDB_.getName(f.getFieldValue("VARIABLE"),F0.Variables.NAME_TYPE),r.ORDER_CONDITIONAL]};r.data_setvariableto=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("VARIABLE"),F0.Variables.NAME_TYPE),E=r.valueToCode(f,"VALUE",r.ORDER_NONE)||'""';return m+=`${y} = ${E};\n`,m};r.data_changevariableby=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("VARIABLE"),F0.Variables.NAME_TYPE),E=r.valueToCode(f,"VALUE",r.ORDER_NONE)||0;return m+=`${y} = runtime.number(${y}) + runtime.number(${E});\n`,m};r.data_listcontents=(f)=>{return[r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,r.ORDER_ATOMIC]};r.data_addtolist=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,E=r.valueToCode(f,"ITEM",r.ORDER_NONE)||'""';return m+=`${y}.push(${E});\n`,m};r.data_deleteoflist=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,E=r.valueToCode(f,"INDEX",r.ORDER_NONE)||1;return m+=`${y}.splice(runtime.index(${E}, ${y}.length), 1);\n`,m};r.data_deletealloflist=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE;return m+=`${y}.length = 0;\n`,m};r.data_insertatlist=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,E=r.valueToCode(f,"INDEX",r.ORDER_NONE)||1,V=r.valueToCode(f,"ITEM",r.ORDER_NONE)||'""';return m+=`${y}.splice(runtime.index(${E}, ${y}.length), 0, ${V});\n`,m};r.data_replaceitemoflist=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,E=r.valueToCode(f,"INDEX",r.ORDER_NONE)||1,V=r.valueToCode(f,"ITEM",r.ORDER_NONE)||'""';return m+=`${y}.splice(runtime.index(${E}, ${y}.length), 1, ${V});\n`,m};r.data_itemoflist=(f)=>{const m=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,y=r.valueToCode(f,"INDEX",r.ORDER_NONE)||1;return[`(${m}[runtime.index(${y}, ${m}.length)] || '""')`,r.ORDER_CONDITIONAL]};r.data_itemnumoflist=(f)=>{const m=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,y=r.valueToCode(f,"ITEM",r.ORDER_NONE)||'""';return[`(${m}.indexOf(${y}) + 1)`,r.ORDER_NONE]};r.data_lengthoflist=(f)=>{return[`${r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE}.length`,r.ORDER_MEMBER]};r.data_listcontainsitem=(f)=>{const m=r.variableDB_.getName(f.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,y=r.valueToCode(f,"ITEM",r.ORDER_NONE)||'""';return[`${m}.includes(${y})`,r.ORDER_FUNCTION_CALL]};var A3="if (abort || !runtime.running) break;\n",M4=`async (done) => {\ndo {\n${r.HAT_CODE}} while (false);\ndone();\n}`;r.event_whenflagclicked=()=>{return`runtime.when('start', ${M4});\n`};r.event_whengreaterthan=(f)=>{const m=f.getFieldValue("WHENGREATERTHANMENU"),y=r.valueToCode(f,"VALUE",r.ORDER_NONE)||10;return`runtime.whenGreaterThen('${m}', runtime.number(${y}), ${M4});\n`};r.event_whenbroadcastreceived=(f)=>{return`runtime.when('message:${r.variableDB_.getName(f.getFieldValue("BROADCAST_OPTION"),L5.Variables.NAME_TYPE)}', ${M4});\n`};r.event_broadcast_menu=(f)=>{return[r.variableDB_.getName(f.getFieldValue("BROADCAST_OPTION"),L5.Variables.NAME_TYPE),r.ORDER_ATOMIC]};r.event_broadcast=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"BROADCAST_INPUT",r.ORDER_NONE)||"message1";return m+=`runtime.fire('message:${y}')\n`,m};r.event_broadcastandwait=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"BROADCAST_INPUT",r.ORDER_NONE)||"message1";return m+=`await runtime.fire('message:${y}')\n${A3}`,m};r.math_number=(f)=>{let m=parseFloat(f.getFieldValue("NUM")),y;if(m===Infinity)m="Infinity",y=r.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m="-Infinity",y=r.ORDER_UNARY_SIGN;else if(Number.isNaN(m))m="NaN",y=r.ORDER_UNARY_SIGN;else y=m<0?r.ORDER_UNARY_SIGN:r.ORDER_ATOMIC;return[m,y]};r.math_integer=(f)=>{const m=parseInt(f.getFieldValue("NUM")),y=m<0?r.ORDER_UNARY_SIGN:r.ORDER_ATOMIC;return[m,y]};r.math_whole_number=(f)=>{return[Math.abs(parseInt(f.getFieldValue("NUM"))),r.ORDER_ATOMIC]};r.math_positive_number=(f)=>{let m=parseFloat(f.getFieldValue("NUM")),y;if(m===Infinity)m="Infinity",y=r.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m="-Infinity",y=r.ORDER_FUNCTION_CALL;else if(Number.isNaN(m))m="NaN",y=r.ORDER_FUNCTION_CALL;else m=m<0?0:m,y=r.ORDER_ATOMIC;return[m,y]};r.math_angle=(f)=>{let m=parseFloat(f.getFieldValue("NUM")),y;if(m==Infinity)m="Infinity",y=r.ORDER_FUNCTION_CALL;else if(m==(-Infinity))m="-Infinity",y=r.ORDER_UNARY_SIGN;else m=m%360,m=m<0?m+360:m,y=r.ORDER_ATOMIC;return[m,y]};r.operator_add=(f)=>{const m=r.valueToCode(f,"NUM1",r.ORDER_NONE)||0,y=r.valueToCode(f,"NUM2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) + runtime.number(${y}))`,r.ORDER_SUBTRACTION]};r.operator_subtract=(f)=>{const m=r.valueToCode(f,"NUM1",r.ORDER_NONE)||0,y=r.valueToCode(f,"NUM2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) - runtime.number(${y}))`,r.ORDER_ADDITION]};r.operator_multiply=(f)=>{const m=r.valueToCode(f,"NUM1",r.ORDER_NONE)||0,y=r.valueToCode(f,"NUM2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) * runtime.number(${y}))`,r.ORDER_MULTIPLICATION]};r.operator_divide=(f)=>{const m=r.valueToCode(f,"NUM1",r.ORDER_NONE)||0,y=r.valueToCode(f,"NUM2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) / runtime.number(${y}))`,r.ORDER_DIVISION]};r.operator_random=(f)=>{const m=r.valueToCode(f,"FROM",r.ORDER_NONE)||0,y=r.valueToCode(f,"TO",r.ORDER_NONE)||0;return[`runtime.random(${m}, ${y})`,r.ORDER_FUNCTION_CALL]};r.operator_gt=(f)=>{const m=r.valueToCode(f,"OPERAND1",r.ORDER_NONE)||0,y=r.valueToCode(f,"OPERAND2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) > runtime.number(${y}))`,r.ORDER_RELATIONAL]};r.operator_lt=(f)=>{const m=r.valueToCode(f,"OPERAND1",r.ORDER_NONE)||0,y=r.valueToCode(f,"OPERAND2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) < runtime.number(${y}))`,r.ORDER_RELATIONAL]};r.operator_equals=(f)=>{const m=r.valueToCode(f,"OPERAND1",r.ORDER_NONE)||0,y=r.valueToCode(f,"OPERAND2",r.ORDER_NONE)||0;return[`(${m} == ${y})`,r.ORDER_RELATIONAL]};r.operator_and=(f)=>{const m=r.valueToCode(f,"OPERAND1",r.ORDER_NONE)||0,y=r.valueToCode(f,"OPERAND2",r.ORDER_NONE)||0;return[`(${m} && ${y})`,r.ORDER_LOGICAL_AND]};r.operator_or=(f)=>{const m=r.valueToCode(f,"OPERAND1",r.ORDER_NONE)||0,y=r.valueToCode(f,"OPERAND2",r.ORDER_NONE)||0;return[`(${m} || ${y})`,r.ORDER_LOGICAL_OR]};r.operator_not=(f)=>{return[`!(${r.valueToCode(f,"OPERAND",r.ORDER_NONE)||0})`,r.ORDER_LOGICAL_NOT]};r.operator_join=(f)=>{const m=r.valueToCode(f,"STRING1",r.ORDER_NONE)||'""',y=r.valueToCode(f,"STRING2",r.ORDER_NONE)||'""';return[`(String(${m}) + String(${y}))`,r.ORDER_ATOMIC]};r.operator_letter_of=(f)=>{const m=r.valueToCode(f,"LETTER",r.ORDER_NONE)||0;return[`(String(${r.valueToCode(f,"STRING",r.ORDER_NONE)||'""'}).at(${m} - 1) || '')`,r.ORDER_ATOMIC]};r.operator_length=(f)=>{return[`String(${r.valueToCode(f,"STRING",r.ORDER_NONE)||'""'}).length`,r.ORDER_MEMBER]};r.operator_contains=(f)=>{const m=r.valueToCode(f,"STRING1",r.ORDER_NONE)||'""',y=r.valueToCode(f,"STRING2",r.ORDER_NONE)||'""';return[`String(${m}).includes(String(${y}))`,r.ORDER_FUNCTION_CALL]};r.operator_mod=(f)=>{const m=r.valueToCode(f,"NUM1",r.ORDER_NONE)||0,y=r.valueToCode(f,"NUM2",r.ORDER_NONE)||0;return[`(runtime.number(${m}) % runtime.number(${y}))`,r.ORDER_MODULUS]};r.operator_round=(f)=>{return[`Math.round(${r.valueToCode(f,"NUM",r.ORDER_NONE)||0})`,r.ORDER_FUNCTION_CALL]};r.operator_mathop=(f)=>{const m=r.valueToCode(f,"NUM",r.ORDER_NONE)||0,y=f.getFieldValue("OPERATOR");let E="";if(y==="ceiling")E+=`Math.ceil(runtime.number(${m}))`;else if(y==="sin"||y==="cos"||y==="tan")E+=`Math.${y}(Math.PI * runtime.number(${m}) / 180)`;else if(y==="asin"||y==="acos"||y==="atan")E+=`(Math.${y}(runtime.number(${m})) * 180 / Math.PI)`;else if(y==="ln")E+=`Math.log(runtime.number(${m}))`;else if(y==="log")E+=`Math.log10(runtime.number(${m}))`;else if(y==="e ^")E+=`Math.exp(runtime.number(${m}))`;else if(y==="10 ^")E+=`Math.pow(10, runtime.number(${m}))`;else E+=`Math.${y}(runtime.number(${m}))`;return[E,r.ORDER_FUNCTION_CALL]};r.procedures_definition=(f)=>{};r.procedures_call=(f)=>{};r.procedures_prototype=(f)=>{};r.procedures_declaration=(f)=>{};r.argument_reporter_boolean=(f)=>{};r.argument_reporter_string_number=(f)=>{};r.argument_editor_boolean=(f)=>{};r.argument_editor_string_number=(f)=>{};r.sensing_timer=(f)=>{return["runtime.time",r.ORDER_FUNCTION_CALL]};r.sensing_resettimer=(f)=>{return"runtime.resetTimer()\n"};r.text=(f)=>{const m=f.getFieldValue("TEXT");return[m.length===0||isNaN(m)?r.quote_(m):+m,r.ORDER_ATOMIC]};var F3=new Set([p6.Events.BLOCK_CHANGE,p6.Events.BLOCK_CREATE,p6.Events.BLOCK_DELETE,p6.Events.BLOCK_MOVE,p6.Events.COMMENT_CHANGE,p6.Events.COMMENT_CREATE,p6.Events.COMMENT_DELETE,p6.Events.COMMENT_MOVE,p6.Events.VAR_CREATE,p6.Events.VAR_DELETE,p6.Events.VAR_RENAME]),e3=function(f){console&&console.warn&&console.warn(f)},M0=function(){M0.init.call(this)},l4=function(f){if(typeof f!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof f)},c5=function(f){return f._maxListeners===void 0?M0.defaultMaxListeners:f._maxListeners},E5=function(f,m,y,E){var V,T,F;if(l4(y),T=f._events,T===void 0?(T=f._events=Object.create(null),f._eventsCount=0):(T.newListener!==void 0&&(f.emit("newListener",m,y.listener?y.listener:y),T=f._events),F=T[m]),F===void 0)F=T[m]=y,++f._eventsCount;else if(typeof F=="function"?F=T[m]=E?[y,F]:[F,y]:E?F.unshift(y):F.push(y),V=c5(f),V>0&&F.length>V&&!F.warned){F.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=f,L.type=m,L.count=F.length,e3(L)}return f},X3=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)},N5=function(f,m,y){var E={fired:!1,wrapFn:void 0,target:f,type:m,listener:y},V=X3.bind(E);return V.listener=y,E.wrapFn=V,V},V5=function(f,m,y){var E=f._events;if(E===void 0)return[];var V=E[m];return V===void 0?[]:typeof V=="function"?y?[V.listener||V]:[V]:y?W3(V):O5(V,V.length)},M5=function(f){var m=this._events;if(m!==void 0){var y=m[f];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0},O5=function(f,m){for(var y=new Array(m),E=0;E<m;++E)y[E]=f[E];return y},T3=function(f,m){for(;m+1<f.length;m++)f[m]=f[m+1];f.pop()},W3=function(f){for(var m=new Array(f.length),y=0;y<m.length;++y)m[y]=f[y].listener||f[y];return m},Y6=typeof Reflect=="object"?Reflect:null,D5=Y6&&typeof Y6.apply=="function"?Y6.apply:function(f,m,y){return Function.prototype.apply.call(f,m,y)},w4;Y6&&typeof Y6.ownKeys=="function"?w4=Y6.ownKeys:Object.getOwnPropertySymbols?w4=function(f){return Object.getOwnPropertyNames(f).concat(Object.getOwnPropertySymbols(f))}:w4=function(f){return Object.getOwnPropertyNames(f)};var R5=Number.isNaN||function(f){return f!==f};M0.EventEmitter=M0;M0.prototype._events=void 0;M0.prototype._eventsCount=0;M0.prototype._maxListeners=void 0;var G5=10;Object.defineProperty(M0,"defaultMaxListeners",{enumerable:!0,get:function(){return G5},set:function(f){if(typeof f!="number"||f<0||R5(f))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+f+".");G5=f}});M0.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};M0.prototype.setMaxListeners=function(f){if(typeof f!="number"||f<0||R5(f))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+f+".");return this._maxListeners=f,this};M0.prototype.getMaxListeners=function(){return c5(this)};M0.prototype.emit=function(f){for(var m=[],y=1;y<arguments.length;y++)m.push(arguments[y]);var E=f==="error",V=this._events;if(V!==void 0)E=E&&V.error===void 0;else if(!E)return!1;if(E){var T;if(m.length>0&&(T=m[0]),T instanceof Error)throw T;var F=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw F.context=T,F}var L=V[f];if(L===void 0)return!1;if(typeof L=="function")D5(L,this,m);else for(var Y=L.length,H=O5(L,Y),y=0;y<Y;++y)D5(H[y],this,m);return!0};M0.prototype.addListener=function(f,m){return E5(this,f,m,!1)};M0.prototype.on=M0.prototype.addListener;M0.prototype.prependListener=function(f,m){return E5(this,f,m,!0)};M0.prototype.once=function(f,m){return l4(m),this.on(f,N5(this,f,m)),this};M0.prototype.prependOnceListener=function(f,m){return l4(m),this.prependListener(f,N5(this,f,m)),this};M0.prototype.removeListener=function(f,m){var y,E,V,T,F;if(l4(m),E=this._events,E===void 0)return this;if(y=E[f],y===void 0)return this;if(y===m||y.listener===m)--this._eventsCount===0?this._events=Object.create(null):(delete E[f],E.removeListener&&this.emit("removeListener",f,y.listener||m));else if(typeof y!="function"){for(V=-1,T=y.length-1;T>=0;T--)if(y[T]===m||y[T].listener===m){F=y[T].listener,V=T;break}if(V<0)return this;V===0?y.shift():T3(y,V),y.length===1&&(E[f]=y[0]),E.removeListener!==void 0&&this.emit("removeListener",f,F||m)}return this};M0.prototype.off=M0.prototype.removeListener;M0.prototype.removeAllListeners=function(f){var m,y,E;if(y=this._events,y===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[f]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete y[f]),this;if(arguments.length===0){var V=Object.keys(y),T;for(E=0;E<V.length;++E)T=V[E],T!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(m=y[f],typeof m=="function")this.removeListener(f,m);else if(m!==void 0)for(E=m.length-1;E>=0;E--)this.removeListener(f,m[E]);return this};M0.prototype.listeners=function(f){return V5(this,f,!0)};M0.prototype.rawListeners=function(f){return V5(this,f,!1)};M0.listenerCount=function(f,m){return typeof f.listenerCount=="function"?f.listenerCount(m):M5.call(f,m)};M0.prototype.listenerCount=M5;M0.prototype.eventNames=function(){return this._eventsCount>0?w4(this._events):[]};var Vi=M0.prototype,B5=N4(V4(),1);class d4 extends M0{static DEFAULT_FPS=24;constructor(f,m=d4.DEFAULT_FPS){super();this._fps=m,this._frame_sec=1/m,this._running=!1,this._requestStop=f,this._timer=0,this._timers=[],this._data={},this._greaterThen={},this._eventsHappening={}}launch(f){new Function("runtime",f)(this)}get core(){return B5.default}get data(){return this._data}get running(){return this._running}get time(){return(Date.now()-this._timer)/1000}resetTimer(){this._timer=Date.now()}when(f,m){this._eventsHappening[f]=this._eventsHappening[f]||[],this._eventsHappening[f].push(!1);const y=this._eventsHappening[f].length-1;this.on(`${f}_${y}`,m)}whenGreaterThen(f,m,y){const E=`${f}>${m}`;this._greaterThen[E]=!1,this.when(`greaterthen:${E}`,y)}emit(...f){return new Promise((m)=>{if(this.running)super.emit(...f,m)})}fire(f,...m){if(this.emit(f,...m),this._eventsHappening[f]=this._eventsHappening[f]||[],this._eventsHappening[f].length>0)return Promise.race(this._eventsHappening[f].map(async(y,E)=>{if(!y)this._eventsHappening[f][E]=!0,await this.emit(`${f}_${E}`,...m),this._eventsHappening[f][E]=!1}));return Promise.resolve()}_handleFrameForGreaterThen(f){const m=Object.keys(this._greaterThen);for(let y of m){const[E,V]=y.split(">");if(E==="TIMER"){const T=this.time>parseFloat(V);if(T&&!this._greaterThen[y])this.fire(`greaterthen:${y}`);this._greaterThen[y]=T}}f()}async _handleStart(){while(this.running){if(!B5.default.project){this.stop();break}await this.nextFrame(),this.fire("frame")}}start(){this._running=!0,this.on("frame",this._handleFrameForGreaterThen.bind(this)),this.on("start",this._handleStart.bind(this)),this.fire("start"),this.resetTimer()}async stop(){this.emit("stop"),this._running=!1,await this.nextFrame(),this._timers.forEach(clearTimeout),this._timers.length=0,this._requestStop()}sleep(f){return new Promise((m)=>this._timers.push(setTimeout(m,f*1000)))}nextFrame(){return this.sleep(this._frame_sec)}random(f=1,m=10){const y=Math.ceil(Math.min(f,m)),E=Math.floor(Math.max(f,m));return Math.floor(Math.random()*(E-y+1))+y}number(f,m=0){return isNaN(f)?m:+f}index(f,m){let y=this.number(f)-1;return y%=m,y+=m,y%m}clamp(f,m,y){return Math.min(Math.max(f,m),y)}}var P0=O3.default;var t4="if (abort || !runtime.running) break;\n";r.motion_attack=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DIRECTION",r.ORDER_NONE)||0,E=r.valueToCode(f,"DISTANCE",r.ORDER_NONE)||100;return m+=`await tank.util.attack(${y}, ${E});\n${t4}`,m};r.motion_move=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DIRECTION",r.ORDER_NONE)||0,E=r.valueToCode(f,"SPEED",r.ORDER_NONE)||100;return m+=`await tank.util.move(${y}, ${E});\n${t4}`,m};r.motion_turnright=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DEGREES",r.ORDER_NONE)||0;return m+=`await tank.util.turnRight(${y});\n${t4}`,m};r.motion_turnleft=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DEGREES",r.ORDER_NONE)||0;return m+=`await tank.util.turnLeft(${y});\n${t4}`,m};r.motion_pointindirection=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DIRECTION",r.ORDER_NONE)||0;return m+=`await tank.util.setDirection(+${y});\n${t4}`,m};r.motion_setspeed=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"SPEED",r.ORDER_NONE)||0;return m+=`tank.util.speed = ${y};\n`,m};r.motion_stop=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);return m+="tank.util.speed = 0;\n",m};r.motion_xposition=(f)=>{return["tank.util.x",r.ORDER_ATOMIC]};r.motion_yposition=(f)=>{return["tank.util.y",r.ORDER_ATOMIC]};r.motion_speed=(f)=>{return["tank.util.currentSpeed",r.ORDER_ATOMIC]};r.motion_direction=(f)=>{return["tank.util.direction",r.ORDER_ATOMIC]};r.sensing_scanwidth=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"WIDTH",r.ORDER_NONE)||5;return m+=`tank.util.scanWidth = ${y};\n`,m};r.sensing_scan=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DIRECTION",r.ORDER_NONE)||0;return m+=`(await tank.util.scan(${y}) !== Infinity)`,[m,r.ORDER_EQUALITY]};r.sensing_scandistance=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);const y=r.valueToCode(f,"DIRECTION",r.ORDER_NONE)||0;return m+=`(await tank.util.scan(${y}))`,[m,r.ORDER_FUNCTION_CALL]};r.sensing_health=(f)=>{let m="";if(r.STATEMENT_PREFIX)m+=r.injectId(r.STATEMENT_PREFIX,f);return m+="tank.util.health",[m,r.ORDER_FUNCTION_CALL]};var H3=()=>`
  <category name="%{BKY_CATEGORY_MOTION}" id="motion" colour="#4C97FF" secondaryColour="#3373CC">
    <block type="motion_attack">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="DISTANCE">
        <shadow type="math_number">
          <field name="NUM">200</field>
        </shadow>
      </value>
    </block>
    <block type="motion_move">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="motion_turnright">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_turnleft">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_pointindirection">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="motion_setspeed">
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
    </block>
    <block type="motion_stop"/>
    ${o6}
    <block type="motion_speed"/>
    <block type="motion_direction"/>
    ${O4}
  </category>
`,Y3=()=>`
  <category name="%{BKY_CATEGORY_SENSING}" id="sensing" colour="#4CBFE6" secondaryColour="#2E8EB8">
    <block type="sensing_scanwidth">
      <value name="WIDTH">
        <shadow type="math_number">
          <field name="NUM">5</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scan">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scandistance">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="sensing_health"/>
    ${o6}
    <block id="timer" type="sensing_timer"/>
    <block type="sensing_resettimer"/>
    ${O4}
  </category>
`,U3=()=>`
  <category name="%{BKY_CATEGORY_OPERATORS}" id="operators" colour="#40BF4A" secondaryColour="#389438">
    <block type="operator_add">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_subtract">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_multiply">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_divide">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_random">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_gt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_lt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_equals">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_and"/>
    <block type="operator_or"/>
    <block type="operator_not"/>
    ${o6}
    <block type="operator_mod">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_round">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_mathop">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${O4}
  </category>
`;function R4(){return K3([{id:"motion",xml:H3()},{id:"sensing",xml:Y3()},{id:"operators",xml:U3()}])}import{jsx as Q3} from"preact/jsx-runtime";var J3=g4.Content;function a4(){const{getText:f}=Z3(),m={MOTION_ATTACK:f("tankwar.blocks.motion_attack","fire in direction %1 at %2 steps"),MOTION_MOVE:f("tankwar.blocks.motion_move","forward in direction %1 at %2 % speed"),MOTION_SETSPEED:f("tankwar.blocks.motion_setspeed","set speed to %1 %"),MOTION_STOP:f("tankwar.blocks.motion_stop","stop"),MOTION_SPEED:f("tankwar.blocks.motion_speed","speed"),SENSING_SCANWIDTH:f("tankwar.blocks.sensing_scanwidth","set scan width to %1"),SENSING_SCAN:f("tankwar.blocks.sensing_scan","scan for enemy in direction %1?"),SENSING_DISTANCE:f("tankwar.blocks.sensing_distance","measure distance of enemy in direction %1"),SENSING_HEALTH:f("tankwar.blocks.sensing_health","health")},y=R4();return Q3(J3,{disableGenerator:!0,disableExtension:!0,messages:m,toolbox:y})}import{useState as _4} from"preact/hooks";import{classNames as G7} from"@blockcode/ui";import{useState as i8} from"preact/hooks";import{useEditor as j7} from"@blockcode/core";var a5="./assets/background-81dedab007c311a5.png";function U6(f){return new Promise((m)=>{const y=new Image;y.src=f,y.addEventListener("load",()=>m(y))})}var z5="./assets/tank_1-5797dcf7b198a48d.png";var A5="./assets/turret_1-26017ccc46b87689.png";var q5="./assets/tank_2-337708f7538d8787.png";var F5="./assets/turret_2-5c4bb2c458561ace.png";var e5="./assets/tank_3-1d999a2c9dacc246.png";var X5="./assets/turret_3-956bfba650c81c57.png";var T5="./assets/tank_4-f93afcfd2c3d1734.png";var W5="./assets/turret_4-d6c2200ed4ca50b0.png";var K5="./assets/broken-2d9779d033bbcdb5.png";var H5="./assets/bullet-80854a0e7090b0fc.png";var Y5="./assets/boom1-65b37ddc26db4cbd.png";var U5="./assets/boom2-82ff355a8e0177ba.png";var Z5="./assets/boom3-703bd7bb6580e4d9.png";var w7=20,l7=4,d7=40,P4=500,P7=70,r7=400,u4=10,z4=50,A4=1000,J5=(f,m)=>Math.sqrt((f.x-m.x)**2+(f.y-m.y)**2),V6=(f)=>isNaN(f)?0:+f,h4=(f,m,y)=>Math.min(Math.max(f,m),y),v4=(f)=>f*Math.PI/180,M6=(f)=>parseInt((f%360+360)%360),Q5=(f,m)=>M6(f)===M6(m);class R0{static PLACE={LEFT:{get position(){return new P0.Point(P0.view.center.x-300,P0.view.center.y)},rotation:90},RIGHT:{get position(){return new P0.Point(P0.view.center.x+300,P0.view.center.y)},rotation:-90},LEFT_TOP:{get position(){return new P0.Point(P0.view.center.x-300,P0.view.center.y-300)},rotation:135},RIGHT_TOP:{get position(){return new P0.Point(P0.view.center.x+300,P0.view.center.y-300)},rotation:-135},LEFT_BOTTOM:{get position(){return new P0.Point(P0.view.center.x-300,P0.view.center.y+300)},rotation:45},RIGHT_BOTTOM:{get position(){return new P0.Point(P0.view.center.x+300,P0.view.center.y+300)},rotation:-45}};static STYLE={PLAYER:{tank:z5,turret:A5},ENEMY_A:{tank:q5,turret:F5},ENEMY_B:{tank:e5,turret:X5},ENEMY_C:{tank:T5,turret:W5}};constructor(f,m=R0.STYLE.PLAYER,y=R0.PLACE.LEFT){this.raster=new P0.Raster({name:f,scaling:0.2,source:m.tank,position:y.position,rotation:y.rotation,visible:m===R0.STYLE.PLAYER}),this.turretRaster=new P0.Raster({scaling:0.2,source:m.turret,position:y.position,rotation:y.rotation,visible:m===R0.STYLE.PLAYER}),this.raster.util=this,this.turretRaster.owner=this,this._hidden=!0,this._lastScanDistance=0,this._imageCache={},this._timers=[],this.reset()}sleep(f){return new Promise((m)=>this._timers.push(setTimeout(m,f)))}reset(){if(this._speed=0,this._currentSpeed=0,this._health=100,this._scanWidth=l7,this._turretReady=null,this._scanShape)this._scanShape.remove(),this._scanShape=null;if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;if(this._collideTester)this._collideTester.remove(),this._collideTester=null;clearTimeout(this._turretReady),this._timers.forEach(clearTimeout),this._timers.length=0}bringToFront(){this.raster.bringToFront(),this.turretRaster.bringToFront()}get running(){return this._running}set running(f){if(this.reset(),this._running=f,f){const m=this.raster.scaling.x*this.raster.width-5;this._collideTester=new P0.Path.Rectangle({point:[this.raster.position.x-m/2,this.raster.position.y-5],size:[m,10],applyMatrix:!1})}}get bullseye(){if(!this._bullseye)this._bullseye=Math.min(this.raster.width,this.raster.height)*this.raster.scaling.x/4;return this._bullseye}get enemies(){if(!this._enemies)this._enemies=["red","yellow","green","player"].filter((f)=>f!==this.raster.name).map((f)=>P0.project.activeLayer.children[f]);return this._enemies}set place(f){if(this.running)return;this.raster.position=this.turretRaster.position=f.position,this.raster.rotation=this.turretRaster.rotation=f.rotation,this.hidden=!1}get hidden(){return this._hidden}set hidden(f){this._hidden=f,this.raster.visible=this.turretRaster.visible=!f}async _turn(f,m){if(!Q5(f.rotation,m)){let y=M6(m)-M6(f.rotation);if(y>180)y-=360;if(y<-180)y+=360;await f.tween({rotation:f.rotation+y},A4*(Math.abs(y)/360))}}async attack(f,m){if(!this.running)return;if(this._bulletRaster||this.death)return;f=Math.round(V6(f)),m=V6(m)-z4,clearTimeout(this._turretReady),this._turretReady=null,await this._turn(this.turretRaster,f);const y=M6(f),E=v4(90-y);if(!this._imageCache.buttet)this._imageCache.buttet=await U6(H5);if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;this._bulletRaster=new P0.Raster({image:this._imageCache.buttet,position:new P0.Point(this.raster.position.x+z4*Math.cos(E),this.raster.position.y-z4*Math.sin(E)),rotation:this.raster.rotation,scaling:this.raster.scaling}),m=h4(m,P7,r7);const V=m/2,T=u4/m/2;let F=u4*Math.cos(E),L=u4*Math.sin(E);while(m>0){if(await this.sleep(15),m<u4)F=m*Math.cos(E),L=m*Math.sin(E);if(m-=u4,this._bulletRaster.position.x+=F,this._bulletRaster.position.y-=L,this._bulletRaster.scaling.x+=m>V?T:-T,this._bulletRaster.scaling.y=this._bulletRaster.scaling.x,this._bulletRaster.scaling.x<this.raster.scaling.x)this._bulletRaster.scaling=this.raster.scaling}this._boom(this._bulletRaster.position),this._collide(this._bulletRaster,(Y)=>{if(J5(Y.position,this._bulletRaster.position)<Y.util.bullseye)Y.util.hurt(10);else Y.util.hurt(5)}),this._bulletRaster.remove(),this._bulletRaster=null,this._turretReady=setTimeout(()=>{this._turn(this.turretRaster,this.raster.rotation),this._turretReady=null},1000)}async _boom(f){if(!this.running)return;if(!this._imageCache.booms)this._imageCache.booms=[await U6(Y5),await U6(U5),await U6(Z5)];if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;this._boomRaster=new P0.Raster({image:this._imageCache.booms[0],position:f}),await this.sleep(30),this._boomRaster.image=this._imageCache.booms[1],await this.sleep(50),this._boomRaster.image=this._imageCache.booms[2],await this.sleep(90),this._boomRaster.remove(),this._boomRaster=null}_intersectsOrContains(f,m){return f.intersects(m)||m.contains(f.position)}_collide(f,m){if(this.running&&!this.death)this.enemies.forEach((y)=>{if(y.util.death||y.util.hidden)return;if(this._intersectsOrContains(f,y))m(y)})}async move(f,m){if(!this.running)return;if(this.death)return;await this.setDirection(f),this.speed=V6(m)}drive(){if(!this.running)return;if(this.speed===0)return;if(this.hidden||this.death)return;let f=this.speed;const m=v4(90-this.direction),y=this.raster.scaling.y*this.raster.height;this._collideTester.rotation=this.raster.rotation,this._collideTester.position.x=this.raster.position.x+(y/2+5)*Math.cos(m),this._collideTester.position.y=this.raster.position.y-(y/2+5)*Math.sin(m),this.enemies.forEach((E)=>{if(E.util.hidden)return;if(this._intersectsOrContains(this.raster,E)&&this._intersectsOrContains(this._collideTester,E))f=0}),this._currentSpeed=f,f/=w7,this.raster.position.x+=f*Math.cos(m),this.raster.position.y-=f*Math.sin(m),this.turretRaster.position=this.raster.position}get x(){return this.raster.position.x-P0.view.center.x}get y(){return P0.view.center.y-this.raster.position.y}get currentSpeed(){return h4(this._currentSpeed,-100,100)}get speed(){return h4(this._speed,-100,100)}set speed(f){if(!this.running)return;this._speed=h4(f,-100,100)}get speedVelocity(){const f=M6(this.speed<0?180+this.direction:this.direction),m=v4(90-f),y=Math.abs(this.speed);return new P0.Point(y*Math.cos(m),y*Math.sin(m))}get direction(){let f=this.raster.rotation%360;if(f>180)f-=360;if(f<=-180)f+=360;return f}async setDirection(f){if(!this.running)return;if(f=Math.round(V6(f)),!this._turretReady)this._turn(this.turretRaster,f);await this._turn(this.raster,f)}turnRight(f){let m=this.raster.rotation;return m+=V6(f),this.setDirection(m)}turnLeft(f){return this.turnRight(-V6(f))}hurt(f){if(!this.running)return;if(this._health-=Math.abs(f),this.death)this.raster.visible=this.turretRaster.visible=!1,new P0.Raster({source:K5,scaling:this.raster.scaling,position:this.raster.position,rotation:this.raster.rotation}).insertAbove(P0.project.activeLayer.children.background)}get health(){if(this._health<0)return 0;return this._health}get death(){return this.health<=0}get scanWidth(){return this._scanWidth}set scanWidth(f){f=V6(f),this._scanWidth=h4(f,1,d7)}async scan(f){if(!this.running)return Infinity;if(this._scanShape||this.death)return Infinity;if(f=V6(f),!Q5(this._lastScanDistance,f)){let w0=M6(f)-M6(this._lastScanDistance);if(w0>180)w0-=360;if(w0<-180)w0+=360;await this.sleep(A4*(Math.abs(w0)/360)),this._lastScanDistance=f}const m=v4(90-(f-this.scanWidth/2)),y=P4*Math.cos(m),E=P4*Math.sin(m),V=new P0.Point(this.raster.position.x+y,this.raster.position.y-E),T=v4(90-(f+this.scanWidth/2)),F=P4*Math.cos(T),L=P4*Math.sin(T),Y=new P0.Point(this.raster.position.x+F,this.raster.position.y-L);if(this._scanShape)this._scanShape.remove(),this._scanShape=null;this._scanShape=new P0.Path({segments:[this.raster.position,V,Y],closed:!0,fillColor:{gradient:{stops:[["rgb(255 0 0 0.4)",0],["rgb(255 0 0 0)",0.7]],radial:!0},origin:this.raster.position,destination:V}}),await this.sleep(A4*(this.scanWidth/360));let H=Infinity;return this._collide(this._scanShape,(w0)=>{const g0=J5(this.raster.position,w0.position);if(g0<H)H=g0}),this._scanShape.remove(),this._scanShape=null,H}}class r4 extends d4{get player(){return P0.project.activeLayer.children.player}get redTank(){return P0.project.activeLayer.children.red}get yellowTank(){return P0.project.activeLayer.children.yellow}get greenTank(){return P0.project.activeLayer.children.green}start(){this.player.util.running=!0,this.redTank.util.running=!0,this.yellowTank.util.running=!0,this.greenTank.util.running=!0,super.start()}stop(){return this.player.util.running=!1,this.redTank.util.running=!1,this.yellowTank.util.running=!1,this.greenTank.util.running=!1,super.stop()}}var $5=(f="",m=[])=>`
${m.join("\n")}

((tank) => {
let abort = false;
${f||""}
})(runtime.player);

runtime.on('frame', () => {
  runtime.player.util.drive();
  runtime.redTank.util.drive();
  runtime.yellowTank.util.drive();
  runtime.greenTank.util.drive();
});

runtime.player.util.bringToFront();
runtime.start();
`;var f4={};P8(f4,{simple:()=>{{return b7}},senior:()=>{{return _7}},medium:()=>{{return S7}}});var b7=(f,m)=>`
((tank) => {
  let abort = false;

  runtime.when('start', async function (done) {
    await tank.util.turnRight(45);
    tank.util.speed = 100;
    await runtime.sleep(2.5);
    tank.util.speed = 0;
    await tank.util.turnLeft(90);
    runtime.fire('@ai_simple_${f}_${m}_message_1');
    while (true) {
      tank.util.speed = 100;
      await runtime.sleep(5.5);
      tank.util.speed = 0;
      await tank.util.turnLeft(180);
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done();
  });

  runtime.when('@ai_simple_${f}_${m}_message_1', async function anonymous(done) {
    while (true) {
      if ((await tank.util.scan(0) !== Infinity)) {
        await tank.util.attack(0, (await tank.util.scan(0)));
      }
      if ((await tank.util.scan(45) !== Infinity)) {
        await tank.util.attack(45, (await tank.util.scan(45)));
      }
      if ((await tank.util.scan(90) !== Infinity)) {
        await tank.util.attack(90, (await tank.util.scan(90)));
      }
      if ((await tank.util.scan(135) !== Infinity)) {
        await tank.util.attack(135, (await tank.util.scan(135)));
      }
      if ((await tank.util.scan(180) !== Infinity)) {
        await tank.util.attack(180, (await tank.util.scan(180)));
      }
      if ((await tank.util.scan(225) !== Infinity)) {
        await tank.util.attack(225, (await tank.util.scan(225)));
      }
      if ((await tank.util.scan(270) !== Infinity)) {
        await tank.util.attack(270, (await tank.util.scan(270)));
      }
      if ((await tank.util.scan(315) !== Infinity)) {
        await tank.util.attack(315, (await tank.util.scan(315)));
      }
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done();
  });


})(runtime.${f}Tank);
`,S7=(f,m)=>`
((tank) => {
  let abort = false;

  let _health_ = 0;
  let _angle_ = 0;

  runtime.when('start', async function anonymous() {
    _angle_ = runtime.random(1, 360);
    runtime.fire('@ai_medium_${f}_${m}_start')
  });

  runtime.when('start', async function anonymous() {
    while (true) {
      _health_ = tank.util.health;
      while (!((tank.util.health < _health_))) {
        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      abort = false;
      tank.util.move(runtime.random(1, 360), 100);
      await runtime.sleep(1);
      tank.util.speed = 0;
      runtime.fire('@ai_medium_${f}_${m}_start')
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
  });

  runtime.when('@ai_medium_${f}_${m}_start', async function anonymous(done) {
    while (true) {
      while (!((await tank.util.scan(_angle_) !== Infinity))) {
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);

        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      while (((await tank.util.scan(_angle_) !== Infinity) && ((await tank.util.scan(_angle_)) > '400'))) {
        tank.util.move(_angle_, 100);

        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);

      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done()
  });


})(runtime.${f}Tank);
`,_7=(f,m)=>`
((tank) => {
  let abort = false;

  let _angle_ = 0;
  let _health_ = 0;


  runtime.when('start', async function anonymous() {
    if (((tank.util.y < '5') && (tank.util.y > '-5'))) {
      await tank.util.turnLeft(104);
    }
    else {
      await tank.util.turnLeft(180);
    }
    tank.util.speed = 100;
    while (!(((Math.abs(tank.util.x) > '400') && (Math.abs(tank.util.y) > '400')))) {

    if (abort || !runtime.running) {
      break;
    };
      await runtime.nextFrame();
    }
    tank.util.speed = 0;
    runtime.fire('@ai_senior_${f}_${m}_start')
  });

  runtime.when('@ai_senior_${f}_${m}_start', async function anonymous(done) {
    if ((tank.util.x < '0')) {
      if ((tank.util.y < '0')) {
        _angle_ = '45';
      }
      else {
        _angle_ = '135';
      }
    }
    else {
      if ((tank.util.y < '0')) {
        _angle_ = '-45';
      }
      else {
        _angle_ = '-135';
      }
    }
    await tank.util.setDirection(_angle_);
    runtime.fire('@ai_senior_${f}_${m}_watch_health');
    _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-60);
    for (let _ = 0; _ < 78; _++) {
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);

      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    runtime.fire('@ai_senior_${f}_${m}_next_place');
    done();
  });

  runtime.when('@ai_senior_${f}_${m}_next_place', async function anonymous(done) {
    abort = false;
    if ((runtime.random(1, 3) == '1')) {
      await tank.util.turnLeft(45);
    }
    else {
      await tank.util.turnRight(45);
    }
    tank.util.speed = 100;
    await runtime.sleep(1);
    if (((tank.util.direction > '-5') && (tank.util.direction < '5'))) {
      while (!((tank.util.y > '400'))) {

      if (abort || !runtime.running) {
        break;
      };
        await runtime.nextFrame();
      }
    }
    else {
      if (((tank.util.direction > '85') && (tank.util.direction < '95'))) {
        while (!((tank.util.x > '400'))) {

        if (abort || !runtime.running) {
          break;
        };
          await runtime.nextFrame();
        }
      }
      else {
        if (((tank.util.direction > '-95') && (tank.util.direction < '-85'))) {
          while (!((tank.util.x < '-400'))) {

          if (abort || !runtime.running) {
            break;
          };
            await runtime.nextFrame();
          }
        }
        else {
          while (!((tank.util.y < '-400'))) {

          if (abort || !runtime.running) {
            break;
          };
            await runtime.nextFrame();
          }
        }
      }
    }
    tank.util.speed = 0;
    runtime.fire('@ai_senior_${f}_${m}_start')
    done()
  });

  runtime.when('@ai_senior_${f}_${m}_watch_health', async function anonymous(done) {
    _health_ = tank.util.health;
    while (!((tank.util.health < _health_))) {

    if (abort || !runtime.running) {
      break;
    };
      await runtime.nextFrame();
    }
    runtime.fire('@ai_senior_${f}_${m}_next_place')
    done()
  });


})(runtime.${f}Tank);
`;function t8({playing:f,enemies:m,enemiesAI:y,onRequestStop:E,onChangeHealth:V}){const[T,F]=i8(null),[L,Y]=i8(!1),{fileList:H,selectedIndex:w0}=j7(),g0=H[w0];if(T){const $=P0.project.activeLayer.children;if(f){if(!L){const r0=[];if(m>0)r0.push(f4[y.red]("red",Date.now().toString(36)));if(m>1)r0.push(f4[y.yellow]("yellow",Date.now().toString(36)));if(m>2)r0.push(f4[y.green]("green",Date.now().toString(36)));const O=new r4(E);O.launch($5(g0.script,r0)),O.on("frame",()=>{V({player:$.player.util.health,red:$.red.util.health,yellow:$.yellow.util.health,green:$.green.util.health})}),Y(O)}}else if(L)L.stop().then(()=>{V({player:100,red:100,yellow:100,green:100}),P0.project.activeLayer.children.forEach((r0)=>{if(r0.name==="background")return;if(r0.util instanceof R0||r0.owner instanceof R0)return;r0.remove()}),Y(!1)});else{if($.player.util.place=R0.PLACE.LEFT_TOP,m>0)$.red.util.place=R0.PLACE.RIGHT_BOTTOM;else $.red.util.hidden=!0;if(m>2)$.yellow.util.place=R0.PLACE.RIGHT_TOP,$.green.util.place=R0.PLACE.LEFT_BOTTOM;else $.yellow.util.hidden=!0,$.green.util.hidden=!0;P0.project.activeLayer.children.forEach((r0)=>{if(r0.name==="background")return;if(r0.util instanceof R0||r0.owner instanceof R0)return;r0.remove()})}}return o7(k5,{width:"480px",height:"480px",onSetup:($)=>{F($),P0.view.zoom=0.5,new P0.Raster({name:"background",source:a5,position:P0.view.center}),new R0("player",R0.STYLE.PLAYER,R0.PLACE.LEFT),new R0("red",R0.STYLE.ENEMY_A,R0.PLACE.RIGHT),new R0("yellow",R0.STYLE.ENEMY_B,R0.PLACE.RIGHT_BOTTOM),new R0("green",R0.STYLE.ENEMY_C,R0.PLACE.LEFT_BOTTOM)}})}import{jsx as o7} from"preact/jsx-runtime";import{useLocale as D7} from"@blockcode/core";import{classNames as v8} from"@blockcode/ui";function I6(f){const m=globalThis.document,y=m.createElement("style");y.appendChild(m.createTextNode(f)),m.head.append(y)}I6("._1mbyQG_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}._1mbyQG_green-flag,._1mbyQG_stop-all{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}._1mbyQG_green-flag:hover,._1mbyQG_stop-all:hover{background:var(--motion-light-transparent)}._1mbyQG_green-flag._1mbyQG_actived{background:var(--motion-transparent)}._1mbyQG_stop-all{opacity:.5}._1mbyQG_stop-all._1mbyQG_actived{opacity:1}._1mbyQG_green-flag._1mbyQG_disabled,._1mbyQG_stop-all._1mbyQG_disabled{opacity:.5}._1mbyQG_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}._1mbyQG_space{margin-left:.2rem}._1mbyQG_toolbar-buttons-group{display:flex}._1mbyQG_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}._1mbyQG_group-button{border-left:none;border-radius:0}._1mbyQG_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}");var e6={toolbarButtonsGroup:"_1mbyQG_toolbar-buttons-group",disabled:"_1mbyQG_disabled",groupButtonFirst:"_1mbyQG_group-button-first",toolbarWrapper:"_1mbyQG_toolbar-wrapper",actived:"_1mbyQG_actived",groupButton:"_1mbyQG_group-button",greenFlag:"_1mbyQG_green-flag",groupButtonLast:"_1mbyQG_group-button-last",toolbarButton:"_1mbyQG_toolbar-button",space:"_1mbyQG_space",stopAll:"_1mbyQG_stop-all"};var u8="./assets/icon-green-flag-8eb2c7e7b0a15fba.svg";var h8="./assets/icon-stop-all-21d83d10e3dd785f.svg";import{jsx as b4} from"preact/jsx-runtime";function q4({playing:f,onPlay:m,onStop:y}){const{getText:E}=D7();return b4("div",{className:e6.toolbarWrapper,children:b4("div",{className:e6.toolbarButtonsGroup,children:[b4("img",{className:v8(e6.greenFlag,{[e6.actived]:f}),src:u8,title:E("tankwar.player.greenFlag","Go"),onClick:m}),b4("img",{className:v8(e6.stopAll,{[e6.actived]:f}),src:h8,title:E("tankwar.player.stopAll","Stop"),onClick:y})]})})}I6(".b0DZEW_stage-wrapper{position:relative}.b0DZEW_stage{border:1px solid var(--ui-black-transparent);border-radius:var(--space);background:var(--ui-white);width:482px;height:482px;position:relative;overflow:hidden}");var F4={stageWrapper:"b0DZEW_stage-wrapper",stage:"b0DZEW_stage"};import{jsx as S4} from"preact/jsx-runtime";function e4({playing:f,enemies:m,enemiesAI:y,onChangePlaying:E,onChangeHealth:V}){const T=()=>E(!0),F=()=>E(!1);return S4("div",{className:F4.stageWrapper,children:[S4(q4,{playing:f,onPlay:T,onStop:F}),S4("div",{className:G7(F4.stage),children:S4(t8,{playing:f,enemies:m,enemiesAI:y,onRequestStop:F,onChangeHealth:V})})]})}import{useLocale as c7,useEditor as E7} from"@blockcode/core";import{classNames as D6,Text as n4,Button as O6,Label as X6,BufferedInput as N7,ComingSoon as V7} from"@blockcode/ui";I6('.MaJ6dq_stage-info-wrapper{margin-top:var(--space);background:var(--ui-white);color:var(--text-primary);border-radius:var(--space);border:1px solid var(--ui-black-transparent);padding:1rem}.MaJ6dq_row{justify-content:space-between;margin-top:.5rem;display:flex}.MaJ6dq_row-primary{margin-top:0}.MaJ6dq_group{flex-direction:row;align-items:center;display:inline-flex}.MaJ6dq_full-input{flex:1}.MaJ6dq_name-input{width:8rem}.MaJ6dq_button{min-width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.MaJ6dq_button-icon{margin:auto}.MaJ6dq_space{margin-left:.2rem}.MaJ6dq_toolbar-button-group{display:flex}.MaJ6dq_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.MaJ6dq_group-button{border-left:none;border-radius:0}.MaJ6dq_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.MaJ6dq_button-text{flex:auto}.MaJ6dq_group-button-toggled-on .MaJ6dq_button-text{color:#4c97ff}.MaJ6dq_tank-image{width:1.65rem}.MaJ6dq_health-progress{background:#f5f5f5;border-radius:10px;width:12rem;height:20px}.MaJ6dq_health-progress:before{counter-reset:progress var(--percent,0);content:counter(progress)"%\u2002";width:calc(12rem*var(--percent,0)/100);color:var(--ui-white);text-align:right;white-space:nowrap;background:#ff6680;border-radius:10px;height:20px;font-size:12px;line-height:20px;display:block;overflow:hidden}');var S0={fullInput:"MaJ6dq_full-input",nameInput:"MaJ6dq_name-input",group:"MaJ6dq_group",stageInfoWrapper:"MaJ6dq_stage-info-wrapper",buttonIcon:"MaJ6dq_button-icon",groupButton:"MaJ6dq_group-button",button:"MaJ6dq_button",rowPrimary:"MaJ6dq_row-primary",buttonText:"MaJ6dq_button-text",space:"MaJ6dq_space",toolbarButtonGroup:"MaJ6dq_toolbar-button-group",row:"MaJ6dq_row",groupButtonToggledOn:"MaJ6dq_group-button-toggled-on",groupButtonFirst:"MaJ6dq_group-button-first",healthProgress:"MaJ6dq_health-progress",tankImage:"MaJ6dq_tank-image",groupButtonLast:"MaJ6dq_group-button-last"};var f8="./assets/tank-2-95f1944eace1f71a.png";var n8="./assets/tank-3-fc6d9534c6d7bba5.png";var m8="./assets/tank-4-79e2f163c902d864.png";import{jsx as C0} from"preact/jsx-runtime";var M7=[f8,n8,m8];function X4({playing:f,enemies:m,enemiesAI:y,health:E,onChangeEnemies:V,onChangeEnemyAI:T}){const{getText:F}=c7(),{fileList:L,modifyFile:Y}=E7(),H=L[0],w0=(g0,y0)=>{Y({[g0]:y0})};return C0("div",{className:S0.stageInfoWrapper,children:[C0("div",{className:D6(S0.row,S0.rowPrimary),children:[C0(X6,{text:F("tankwar.stageInfo.player","Player"),children:C0(N7,{disabled:f,className:S0.nameInput,placeholder:F("tankwar.stageInfo.nickname","Nickname"),onSubmit:(g0)=>w0("name",g0),value:H.name})}),C0(X6,{secondary:!0,className:S0.health,text:F("tankwar.stageInfo.health","Health"),children:C0("div",{className:S0.healthProgress,style:`--percent:${E.player||0}`})})]}),C0("div",{className:S0.row,children:[C0(X6,{secondary:!0,text:F("tankwar.stageInfo.enemies","Enemies"),children:[C0(O6,{disabled:f,className:D6(S0.button,S0.groupButtonFirst,{[S0.groupButtonToggledOn]:m===0}),onClick:()=>V(0),children:C0("div",{className:S0.buttonText,children:"0"})}),C0(O6,{disabled:f,className:D6(S0.button,S0.groupButton,{[S0.groupButtonToggledOn]:m===1}),onClick:()=>V(1),children:C0("div",{className:S0.buttonText,children:"1"})}),C0(O6,{disabled:f,className:D6(S0.button,S0.groupButtonLast,{[S0.groupButtonToggledOn]:m===3}),onClick:()=>V(3),children:C0("div",{className:S0.buttonText,children:"3"})})]}),m>0&&C0(X6,{secondary:!0,children:[C0(O6,{disabled:f,className:D6(S0.button,S0.groupButtonFirst,{[S0.groupButtonToggledOn]:!0}),children:C0("div",{className:S0.buttonText,children:C0(n4,{id:"tankwar.stageInfo.mode.local",defaultMessage:"Local AI"})})}),C0(V7,{placement:"bottom",children:C0(O6,{disabled:f,className:D6(S0.button,S0.groupButtonLast,{[S0.groupButtonToggledOn]:!1}),children:C0("div",{className:S0.buttonText,children:C0(n4,{id:"tankwar.stageInfo.mode.remote",defaultMessage:"Remote Players"})})})})]})]}),["red","yellow","green"].slice(0,m).map((g0,y0)=>C0("div",{className:S0.row,children:[C0(X6,{secondary:!0,children:C0("img",{className:S0.tankImage,src:M7[y0],alt:F(`tankwar.stageInfo.enemy.${g0}`,g0.replace(g0[0],g0[0].toUpperCase())),title:F(`tankwar.stageInfo.enemy.${g0}`,g0.replace(g0[0],g0[0].toUpperCase()))})}),C0(X6,{secondary:!0,children:C0("div",{className:S0.healthProgress,style:`--percent:${E[g0]||0}`})}),C0(X6,{secondary:!0,text:F("tankwar.stageInfo.ai","AI"),children:[C0(O6,{disabled:f,className:D6(S0.button,S0.groupButtonFirst,{[S0.groupButtonToggledOn]:y[g0]==="simple"}),onClick:()=>T(g0,"simple"),children:C0("div",{className:S0.buttonText,children:C0(n4,{id:"tankwar.stageInfo.ai.simple",defaultMessage:"Simple"})})}),C0(O6,{disabled:f,className:D6(S0.button,S0.groupButton,{[S0.groupButtonToggledOn]:y[g0]==="medium"}),onClick:()=>T(g0,"medium"),children:C0("div",{className:S0.buttonText,children:C0(n4,{id:"tankwar.stageInfo.ai.medium",defaultMessage:"Medium"})})}),C0(O6,{disabled:f,className:D6(S0.button,S0.groupButtonLast,{[S0.groupButtonToggledOn]:y[g0]==="senior"}),onClick:()=>T(g0,"senior"),children:C0("div",{className:S0.buttonText,children:C0(n4,{id:"tankwar.stageInfo.ai.senior",defaultMessage:"Senior"})})})]})]},y0))]})}I6(".FMSzyW_sidebar-wrapper{flex-direction:column;height:100%;display:flex}.FMSzyW_stage-wrapper{display:flex}.FMSzyW_selector-wrapper{margin-top:var(--space);flex-direction:row;height:100%;display:flex}");var T4={stageWrapper:"FMSzyW_stage-wrapper",sidebarWrapper:"FMSzyW_sidebar-wrapper",selectorWrapper:"FMSzyW_selector-wrapper"};import{jsx as W4} from"preact/jsx-runtime";function K4(){const[f,m]=_4(!1),[y,E]=_4(1),[V,T]=_4({red:"simple",yellow:"medium",green:"senior"}),[F,L]=_4({player:100,red:100,yellow:100,green:100});return W4("div",{className:T4.sidebarWrapper,children:[W4(e4,{className:T4.stageWrapper,playing:f,enemies:y,enemiesAI:V,onChangePlaying:m,onChangeHealth:L}),W4(X4,{playing:f,enemies:y,enemiesAI:V,health:F,onChangeEnemies:E,onChangeEnemyAI:(Y,H)=>T({...V,[Y]:H})})]})}var x8={fileList:[{id:"player",name:"player"}]};var s8={"tankwar.player.greenFlag":"Go","tankwar.player.stopAll":"Stop","tankwar.stageInfo.player":"Player","tankwar.stageInfo.nickname":"Nickname","tankwar.stageInfo.enemies":"Enemies","tankwar.stageInfo.health":"Health","tankwar.stageInfo.enemy.red":"Red","tankwar.stageInfo.enemy.yellow":"Yellow","tankwar.stageInfo.enemy.green":"Green","tankwar.stageInfo.mode.local":"Local AI","tankwar.stageInfo.mode.remote":"Remote Players","tankwar.stageInfo.ai":"AI","tankwar.stageInfo.ai.simple":"Simple","tankwar.stageInfo.ai.medium":"Medium","tankwar.stageInfo.ai.senior":"Senior","tankwar.blocks.motion_attack":"fire in direction %1 at %2 steps","tankwar.blocks.motion_move":"forward in direction %1 at %2 % speed","tankwar.blocks.motion_setspeed":"set speed to %1 %","tankwar.blocks.motion_stop":"stop","tankwar.blocks.motion_speed":"speed","tankwar.blocks.sensing_scanwidth":"set scan width to %1","tankwar.blocks.sensing_scan":"scan for enemy in direction %1?","tankwar.blocks.sensing_distance":"measure distance of enemy in direction %1","tankwar.blocks.sensing_health":"health"};var p8={"tankwar.player.greenFlag":"\u8FD0\u884C","tankwar.player.stopAll":"\u505C\u6B62","tankwar.stageInfo.player":"\u73A9\u5BB6","tankwar.stageInfo.nickname":"\u6635\u79F0","tankwar.stageInfo.enemies":"\u654C\u65B9\u6570\u91CF","tankwar.stageInfo.health":"\u751F\u547D\u503C","tankwar.stageInfo.enemy.red":"\u7EA2","tankwar.stageInfo.enemy.yellow":"\u9EC4","tankwar.stageInfo.enemy.green":"\u7EFF","tankwar.stageInfo.mode.local":"\u672C\u673A AI","tankwar.stageInfo.mode.remote":"\u8054\u7F51\u73A9\u5BB6","tankwar.stageInfo.ai":"AI \u7B56\u7565","tankwar.stageInfo.ai.simple":"\u7B80\u5355","tankwar.stageInfo.ai.medium":"\u4E2D\u7B49","tankwar.stageInfo.ai.senior":"\u9AD8\u7EA7","tankwar.blocks.motion_attack":"\u671D\u5411 %1 \u65B9\u5411\u8DDD\u79BB %2 \u6B65\u53D1\u5C04\u70AE\u5F39","tankwar.blocks.motion_move":"\u4EE5 %2 % \u901F\u5EA6\u9762\u5411 %1 \u65B9\u5411\u524D\u8FDB","tankwar.blocks.motion_setspeed":"\u5C06\u901F\u5EA6\u8BBE\u4E3A %1 %","tankwar.blocks.motion_stop":"\u505C\u6B62\u524D\u8FDB","tankwar.blocks.motion_speed":"\u901F\u5EA6","tankwar.blocks.sensing_scanwidth":"\u5C06\u96F7\u8FBE\u626B\u63CF\u5BBD\u5EA6\u8BBE\u4E3A %1","tankwar.blocks.sensing_scan":"\u96F7\u8FBE\u626B\u63CF %1 \u65B9\u5411\u6709\u654C\u4EBA\uFF1F","tankwar.blocks.sensing_distance":"\u96F7\u8FBE\u6D4B\u91CF %1 \u65B9\u5411\u654C\u4EBA\u7684\u8DDD\u79BB","tankwar.blocks.sensing_health":"\u751F\u547D\u503C"};function O7({addLocaleData:f,createLayout:m,openProject:y,project:E}){f(C5),f({en:s8,"zh-Hans":p8});const V=(F)=>{y(Object.assign({selectedIndex:0},F||x8))};V(E),m({mainMenu:b5({createDefaultProject:V,saveCurrentProject:()=>{return{thumb:document.querySelector("#blockcode-blocks-player").toDataURL()}}}).slice(0,2),tabs:[{...g4,Content:a4}],sidebars:[{expand:"right",Content:K4}],pane:!1,tutorials:!1,canEditProjectName:!0})}export{O7 as default};
